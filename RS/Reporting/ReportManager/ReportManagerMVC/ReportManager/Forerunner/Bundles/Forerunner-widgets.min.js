var forerunner=forerunner||{},moment;forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants.widgets,i=forerunner.ssr.constants.events,r=function(n){return typeof n=="function"},s=function(n){return"[object RegExp]"===Object.prototype.toString.call(n)},h=function(n,t){if(n==null)return null;var i=n[t];return r(i)?i.call(n):i};has=function(n,t){return Object.hasOwnProperty.call(n,t)};var c=function(n){return n},l={},u=Array.prototype,rt=Object.prototype,ut=Function.prototype,f=u.some,a=function(n,t,i){t||(t=c);var r=!1;return n==null?r:f&&n.some===f?n.some(t,i):($.each(n,function(u,f){if(r||(r=t.call(i,f,u,n)))return l}),!!r)},e=u.map,v=collect=function(n,t,i){var r=[];return n==null?r:e&&n.map===e?n.map(t,i):($.each(n,function(u,f){r.push(t.call(i,f,u,n))}),r)},y=Object.keys,p=y||function(n){var t,i;if(n!==Object(n))throw new TypeError("Invalid object");t=[];for(i in n)has(n,i)&&(t[t.length]=i);return t},ft=Array.prototype.slice,et=Array.prototype.splice,w=/\((.*?)\)/g,b=/(\(\?)?:\w+/g,k=/\*\w+/g,d=/[\-{}\[\]+?.,\\\^$|#\s]/g;$.widget(t.getFullname(t.router),{options:{routes:{}},_create:function(){var n=this;n.options.routes&&(n.routes=n.options.routes);n._bindRoutes()},_init:function(){},route:function(n,t,u){var f=this;return s(n)||(n=f._routeToRegExp(n)),r(t)&&(u=t,t=""),u||(u=f.options[t]),forerunner.history.history("route",n,function(r){var e=f._extractParameters(n,r);f._execute(u,e);f._trigger(i.route,null,{name:t,args:e});forerunner.history.history("triggerRoute",{route:f,name:t,args:e})}),f},_execute:function(n,t){n&&n.apply(this,t)},navigate:function(n,t){return forerunner.history.history("navigate",n,t),this},_bindRoutes:function(){if(this.routes){this.routes=h(this,"routes");for(var n,t=p(this.routes);(n=t.pop())!=null;)this.route(n,this.routes[n])}},_routeToRegExp:function(n){return n=n.replace(d,"\\$&").replace(w,"(?:$1)?").replace(b,function(n,t){return t?n:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+n+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(n,t){var i=n.exec(t).slice(1);return v(i,function(n,t){return t===i.length-1?n||null:n?decodeURIComponent(n):null})}});var o=/^[#\/]|\s+$/g,g=/^\/+|\/+$/g,nt=/msie [\w.]+/,tt=/\/$/,it=/#.*$/,n=!1;$.widget(t.getFullname(t.history),{options:{},_create:function(){var n=this;this.handlers=[]},_init:function(){typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},isStarted:function(){return n},_interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(n){var t=(n||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(n,t){if(n==null)if(this._hasPushState||!this._wantsHashChange||t){n=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(tt,"");n.indexOf(i)||(n=n.slice(i.length))}else n=this.getHash();return n.replace(o,"")},triggerRoute:function(n){this._trigger(i.route,null,n)},start:function(t){var i=this,e,s;if(n)return!1;n=!0;$.extend(i.options,{root:"/"},t);i.root=i.options.root;i._wantsHashChange=i.options.hashChange!==!1;i._wantsPushState=!!i.options.pushState;i._hasPushState=!!(i.options.pushState&&i.history&&i.history.pushState);var r=i.getFragment(),u=document.documentMode,f=nt.exec(navigator.userAgent.toLowerCase())&&(!u||u<=7);if(i.root=("/"+i.root+"/").replace(g,"/"),f&&i._wantsHashChange&&(e=$('<iframe src="javascript:0" tabindex="-1">'),i.iframe=e.hide().appendTo("body")[0].contentWindow,i.navigate(r)),i._hasPushState)$(window).on("popstate",function(){i.checkUrl.call(i)});else if(i._wantsHashChange&&"onhashchange"in window&&!f)$(window).on("hashchange",function(){i.checkUrl.call(i)});else i._wantsHashChange&&(i._checkUrlInterval=setInterval(function(){i.checkUrl.call(i)},i.interval));if(i.fragment=r,s=i.location,i._wantsHashChange&&i._wantsPushState)if(i._hasPushState||i.atRoot())i._hasPushState&&i.atRoot()&&s.hash&&(i.fragment=i.getHash().replace(o,""),i.history.replaceState({},document.title,i.root+i.fragment));else return i.fragment=i.getFragment(null,!0),i.location.replace(i.root+"#"+i.fragment),!0;if(!i.options.silent)return i.loadUrl()},stop:function(){$(window).off("popstate").off("hashchange");clearInterval(this._checkUrlInterval);n=!1;this.handlers.length=0},route:function(n,t){this.handlers.unshift({route:n,callback:t})},checkUrl:function(){var n=this.getFragment();if(n===this.fragment&&this.iframe&&(n=this.getFragment(this.getHash(this.iframe))),n===this.fragment)return!1;this.iframe&&this.navigate(n);this.loadUrl()},loadUrl:function(n){return n=this.fragment=this.getFragment(n),n=n.replace("%2f%2F","/%2F"),a(this.handlers,function(t){if(t.route.test(n))return t.callback(n),!0})},navigate:function(t,i){if(!n)return!1;i&&i!==!0||(i={trigger:!!i});var r=this.root+(t=this.getFragment(t||""));if(t=t.replace(it,""),this.fragment!==t){if(this.fragment=t,t===""&&r!=="/"&&(r=r.slice(0,-1)),this._hasPushState)this.history[i.replace?"replaceState":"pushState"]({},document.title,r);else if(this._wantsHashChange)this._updateHash(this.location,t,i.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(i.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,i.replace));else return this.location.assign(r);if(i.trigger)return this.loadUrl(t)}},_updateHash:function(n,t,i){if(i){var r=n.href.replace(/(javascript:|#).*$/,"");n.replace(r+"#"+t)}else n.hash="#"+t}});forerunner.history=$({}).history({})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants,n=t.widgets,i=forerunner.localize;$.widget(n.getFullname(n.viewerBase),{options:{loadDelay:500},_create:function(){var n=this},_init:function(n){var t=this;t.loadLock=0;t.$loadingIndicator=t.element.find(".fr-report-loading-indicator");t.$loadingIndicator.length===0&&(t.$loadingIndicator=$("<div class='fr-report-loading-indicator' ><\/div>").text(i.getLocData().messages.loading),t.element.append(t.$loadingIndicator));t.$viewerContainer=n},showLoadingIndictator:function(){var n=this;n.loadLock===0&&(n.loadLock=1,setTimeout(function(){n._showLoadingIndictator()},n.options.loadDelay))},_showLoadingIndictator:function(){var n=this,i,t;n.loadLock===1&&(i=n.options.$appContainer.find(".fr-layout-mainviewport"),i.addClass("fr-layout-mainviewport-fullheight"),t=n.$viewerContainer.width()-212,n.$loadingIndicator.css("top",n.$viewerContainer.scrollTop()+100+"px").css("left",t>0?t/2:"0px"),n.$viewerContainer.addClass("fr-report-container-translucent"),n.$loadingIndicator.show())},removeLoadingIndicator:function(){var n=this,t;n.loadLock=0;t=n.options.$appContainer.find(".fr-layout-mainviewport");t.removeClass("fr-layout-mainviewport-fullheight");n.$viewerContainer.removeClass("fr-report-container-translucent");n.$loadingIndicator.hide()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){function r(n){this.reportObj=n;this.isRendered=!1}var i=forerunner.ssr.constants.widgets,n=forerunner.ssr.constants.events,t=forerunner.ssr.constants.navigateType;$.widget(i.getFullname(i.reportViewer),$.forerunner.viewerBase,{options:{reportViewerAPI:forerunner.config.forerunnerAPIBase()+"ReportViewer",pingInterval:3e5,toolbarHeight:0,pageNavArea:null,paramArea:null,DocMapArea:null,userSettings:null,onInputBlur:null,onInputFocus:null,$appContainer:null,parameterModel:null,savePosition:null,viewerID:null,rsInstance:null,showSubscriptionUI:!1,zoom:"100",exportCallback:undefined},_create:function(){var t=this,i,r;if(forerunner.ssr._internal.init(),t._super(),setInterval(function(){t._sessionPing()},t.options.pingInterval),t.actionHistory=[],t.curPage=0,t.pages={},t.reportPath="",t.pageNum=0,t.savedParameters=null,t.sessionID="",t.numPages=0,t.lock=0,t.$reportContainer=new $("<DIV class='fr-report-container'/>"),t.$reportAreaContainer=null,t.floatingHeaders=[],t.paramLoaded=!1,t.scrollTop=0,t.scrollLeft=0,t.finding=!1,t.findStartPage=null,t.findEndPage=null,t.findKeyword=null,t.hasDocMap=!1,t.docMapData=null,t.togglePageNum=0,t.pageNavOpen=!1,t.savedTop=0,t.savedLeft=0,t.origionalReportPath="",t._setPageCallback=null,t.renderError=!1,t.autoRefreshID=null,t.reportStates={toggleStates:new forerunner.ssr.map,sortStates:[]},t.renderTime=(new Date).getTime(),t.paramDefs=null,t.credentialDefs=null,t.datasourceCredentials=null,t.viewerID=t.options.viewerID?t.options.viewerID:Math.floor(Math.random()*100+1),t.SaveThumbnail=!1,t.RDLExtProperty=null,t.isDebug=forerunner.config.getCustomSettingsValue("Debug","off")==="on"?!0:!1,t.zoomState=!0,t.allowZoom(t.zoomState),t.locData=forerunner.localize,i=forerunner.device.isTouch(),i)$(window).on("scrollstop",function(){t._updateTableHeaders(t)});else $(window).on("scroll",function(){t._updateTableHeaders(t)});if(forerunner.device.isMSIE8()||window.addEventListener("orientationchange",function(){t._ReRender.call(t)},!1),t.element.append(t.$reportContainer),t.hideDocMap(),t.options.parameterModel)t.options.parameterModel.on(n.parameterModelSetChanged(),function(n,i){t._onModelSetChanged.call(t,n,i)});if(t.options.showSubscriptionOnOpen){r=t.options.showSubscriptionOnOpen;$(t.element).on(n.reportViewerSetPageDone(),function(){t.options.showSubscriptionOnOpen&&(delete t.options.showSubscriptionOnOpen,t.editEmailSubscription(r))})}},_init:function(){var t=this;t._super(t.$reportContainer);t.options.$appContainer.off(n.saveRDLDone);t.options.$appContainer.on(n.saveRDLDone,function(n,i){t._updateRDLExt(i)});t.options.$appContainer.off(n.renameItem);t.options.$appContainer.on(n.renameItem,function(n,i){t.reportPath=i.newPath||t.reportPath})},_checkPermission:function(n,t){var i=this;if(i.dynamicReport===!0){t&&t();return}i.permissions=forerunner.ajax.hasPermission(n,"Create Subscription,Update Properties",i.options.rsInstance,function(n){i.permissions=n;t&&t()})},getPermissions:function(){var n=this;return n.permissions},getUserSettings:function(){return this.options.userSettings},showSubscriptionUI:function(){return this.options.showSubscriptionUI},getCurPage:function(){var n=this;return parseInt(n.curPage,10)},getNumPages:function(){var n=this;return n.numPages},getReportViewerAPI:function(){var n=this;return n.options.reportViewerAPI},getReportPath:function(){var n=this;return n.reportPath},getSessionID:function(){var n=this;return n.sessionID},getHasDocMap:function(){var n=this;return n.hasDocMap},getDataSourceCredential:function(){var n=this;return n.datasourceCredentials?n.datasourceCredentials:null},triggerEvent:function(n,t){var i=this;return i._trigger(n,null,t)},_setColHeaderOffset:function(n,t){if(t){var i=n.offset(),r=$(window).scrollLeft();r>i.left&&r<i.left+n.width()?(t.css("left",Math.min(r-i.left,n.width()-t.width())+"px"),t.css("visibility","visible")):t.css("visibility","hidden")}},_setRowHeaderOffset:function(n,t){var u=this,i,r;t&&(i=n.offset(),r=$(window).scrollTop(),r>i.top&&r<i.top+n.innerHeight()?(t.css("top",Math.min(r-i.top,n.height()-t.innerHeight())+u.options.toolbarHeight+"px"),t.css("visibility","visible")):t.css("visibility","hidden"))},_ReRender:function(n){var t=this;t.options.userSettings&&t.options.userSettings.responsiveUI===!0&&($.each(t.pages,function(n,t){t&&(t.needsLayout=!0)}),t._reLayoutPage(t.curPage,n))},getScrollPosition:function(){var t=this,n={};return t._ScrollInner?(n.left=t.$reportAreaContainer.scrollLeft(),n.top=t.$reportAreaContainer.scrollTop()):(n.left=$(window).scrollLeft(),n.top=$(window).scrollTop()),n},saveScrollPosition:function(){var n=this,t=n.getScrollPosition();n.scrollLeft=t.left;n.scrollTop=t.top},windowResize:function(){var n=this;n.saveScrollPosition();n._ReRender.call(n);n.scrollReportTo()},_removeCSS:function(){for(var i,r=this,t=$("head").find("style"),n=0;n<t.length;n++)t[n].id===r.viewerID.toString()&&(i=t[n],i.parentNode.removeChild(i))},scrollReportBody:function(){var n=this;forerunner.device.isChrome()||forerunner.config.getCustomSettingsValue("AppleFixedToolbarBug","on")!=="on"?n.$reportAreaContainer&&(n.$reportAreaContainer.css("display","table-cell"),n.$reportAreaContainer.css("overflow",""),n._ScrollInner=!1):n.$reportAreaContainer&&(n.$reportAreaContainer.css("display","block"),n.$reportAreaContainer.css("height",$(window).height()-n.options.toolbarHeight),n.$reportAreaContainer.css("overflow","auto"),n._ScrollInner=!0)},scrollReportTo:function(n){var t=this;n||(n={},n.left=t.scrollLeft,n.top=t.scrollTop);t._ScrollInner?(t.$reportAreaContainer.scrollLeft(n.left),t.$reportAreaContainer.scrollTop(n.top)):($(window).scrollLeft(n.left),$(window).scrollTop(n.top))},_setPage:function(t){var i=this,r;i.pages[t].isRendered||i._renderPage(t);$(".fr-report-areacontainer",i.$reportContainer).length===0?(r=i.$reportContainer.find(".Page"),r&&r.detach(),i.$reportAreaContainer=$("<Div/>"),i.$reportAreaContainer.addClass("fr-report-areacontainer"),i.$reportContainer.append(i.$reportAreaContainer),i._touchNav(),i._removeDocMap()):i.$reportAreaContainer.find(".Page").detach();i.$reportAreaContainer.append(i._getPageContainer(t));i._removeCSS();$.isEmptyObject(i.pages[t].CSS)||i.pages[t].CSS.appendTo("head");i.renderError||(i._reLayoutPage(t),i.curPage=t,i._trigger(n.changePage,null,{newPageNum:t,paramLoaded:i.paramLoaded,numOfVisibleParameters:i.$numOfVisibleParameters,renderError:i.renderError,credentialRequired:i.credentialDefs?!0:!1}));i.scrollReportTo();i.removeLoadingIndicator();i.lock=0;typeof i._setPageCallback=="function"&&(i._setPageCallback(),i._setPageCallback=null);i._setOptionsZoom();i._trigger(n.setPageDone,null,{newPageNum:i.curPage,paramLoaded:i.paramLoaded,numOfVisibleParameters:i.$numOfVisibleParameters,renderError:i.renderError,credentialRequired:i.credentialDefs?!0:!1})},getZoomFactor:function(){var n=this;return n._zoomFactor||(n._zoomFactor=100),n._zoomFactor},zoomToPercent:function(t,i){var r=this,u,f,e;if(r.zooming!==!0){if(r.zoooming=!0,t){if(u=parseFloat(t),isNaN(u))return r._trigger(n.zoomChange,null,{zoomFactor:r._zoomFactor,$reportViewer:r.element}),r.zoooming=!1,!1}else u=r.getZoomFactor();return r._zoomFactor=u,f=r.$reportAreaContainer.find(".Page"),forerunner.device.isFirefox()===!0?(e=r._zoomFactor/100,f.css("transform","scale("+e+","+e+")"),f.css("transform-origin","left top")):f.css("zoom"," "+r._zoomFactor+"%"),r._trigger(n.zoomChange,null,{zoomFactor:r._zoomFactor,$reportViewer:r.element}),r.element.hide().show(0),i!==!0&&(r.options.zoom=t),r.zoooming=!1,!0}},toggleZoomPageWidth:function(){var n=this;n._zoomFactor||(n._zoomFactor=100);n.options.zoom==="page width"?(n.zoomToPercent(100),n.options.zoom="100"):n.zoomToPageWidth()},zoomToPageWidth:function(){var n=this,t=n._getPageSizeObject(),i=n.element.visibleSize().width/t.width()*100;n.zoomToPercent(i,!0);n.options.zoom="page width"},zoomToWholePage:function(){var n=this,t=n._getPageSizeObject(),i=n.element.visibleSize(),r=i.height/t.height(),u=i.width/t.width(),f=Math.min(u*100,r*100);n.zoomToPercent(f,!0);n.options.zoom="whole page"},_addSetPageCallback:function(n){if(typeof n=="function"){var t=this,i=t._setPageCallback;t._setPageCallback=i===null?n:function(){i();n()}}},_getPageSizeObject:function(){var n=this,t=n.$reportAreaContainer.find(".Page");return t.children("table")},_allowZoomWindowsPhone:function(){var n=this;return},showToolbar:function(t){var i=this;i._trigger(n.allowZoom,null,{isEnabled:!t})},allowZoom:function(n){var t=this;if(forerunner.device.isWindowsPhone()&&!forerunner.device.isWindowsPhone81()){t._allowZoomWindowsPhone(n);return}n===!0?(forerunner.device.allowZoom(!0),t.allowSwipe(!1)):(forerunner.device.allowZoom(!1),t.allowSwipe(!0))},onInputBlur:function(){var n=this;n.options.onInputBlur&&n.options.onInputBlur.call(n)},onInputFocus:function(){var n=this;n.options.onInputFocus&&n.options.onInputFocus()},_allowSwipe:!0,allowSwipe:function(n){var t=this;t._allowSwipe=n},_navToPage:function(n){var t=this;t._allowSwipe===!0&&t.navToPage(n)},_touchNav:function(){var n=this;$(n.element).hammer({stop_browser_behavior:{userSelect:!1},swipe_max_touches:2,drag_max_touches:2}).on("touch release",function(t){if(t.gesture)switch(t.type){case"touch":n._hideTableHeaders();break;case"release":var i=!1;if(t.gesture.touches.length>1&&(i=!0),t.gesture.velocityX===0&&t.gesture.velocityY===0&&n._updateTableHeaders(n),forerunner.device.isTouch()&&forerunner.config.getCustomSettingsValue("EnableGestures","off")==="on"){if((t.gesture.direction==="left"||t.gesture.direction==="up")&&i){t.gesture.preventDefault();n._navToPage(n.curPage+1);break}if((t.gesture.direction==="right"||t.gesture.direction==="down")&&i){t.gesture.preventDefault();n._navToPage(n.curPage-1);break}}}})},_resetExecution:function(n){var t=this;forerunner.ajax.ajax({url:t.options.reportViewerAPI+"/ResetExecution/",data:{SessionID:t.sessionID,instance:t.options.rsInstance},dataType:"json",success:function(){n()},fail:function(){}})},refreshReport:function(t){var i=this,r=null;i.lock!==1&&(t===undefined&&(t=1),i.renderTime=(new Date).getTime(),i.lock=1,i._revertUnsubmittedParameters(),i.paramLoaded===!0&&(r=i.options.paramArea.reportParameter("getParamsList")),i._resetViewer(!0),i._trigger(n.refresh),i._resetExecution(function(){i._loadPage(t,!1,null,r,!0)}))},navToPage:function(n){var t=this;(n===0&&(n=1e6),n!==t.curPage&&t.lock!==1)&&t._resetContextIfInvalid(function(){t.scrollLeft=0;t.scrollTop=0;n>t.numPages&&t.numPages!==0&&(n=1);n<1&&(n=t.numPages);n!==t.curPage&&t.lock===0&&(t.lock=1,t._loadPage(n,!1))})},_hideDocMap:function(){var t=this,i=t.options.docMapArea;t.savedTop=0;t.savedLeft=0;i.hide();t.element.unmask();t._trigger(n.hideDocMap)},_showDocMap:function(){var t=this,i=function(){var i=t.getScrollPosition();t.savedTop=i.top;t.savedLeft=i.left;t.element.mask();t.options.docMapArea.slideUpShow();t._trigger(n.showDocMap);setTimeout(function(){t.options.savePosition&&(t.savedTop=t.options.savePosition.top,t.savedLeft=t.options.savePosition.left,t.options.savePosition=null)},100)};t._resetContextIfInvalid(function(){var n=t.options.docMapArea;n.reportDocumentMap({$reportViewer:t});t.docMapData?i():forerunner.ajax.ajax({url:t.options.reportViewerAPI+"/DocMapJSON/",data:{SessionID:t.sessionID,instance:t.options.rsInstance},dataType:"json",success:function(r){t.docMapData=r;n.reportDocumentMap("write",r);i()},fail:function(){t._showMessageBox(t.locData.getLocData().messages.docmapShowFailed)}})})},_removeDocMap:function(){var n=this;$(".fr-docmap-panel").length!==0&&(n.hideDocMap(),n.docMapData=null,$(".fr-docmap-panel").remove())},hideDocMap:function(){var n=this,t=n.options.docMapArea;n.hasDocMap&&t&&t.is(":visible")&&n._hideDocMap()},showDocMap:function(){var n=this,t=n.options.docMapArea;if(n.hasDocMap&&t){if(t.is(":visible")){n._hideDocMap();return}n._showDocMap()}},_cachePages:function(n){var i=this,r,u,t;for(n=parseInt(n,10),r=n-1,u=n+1,r<1&&(r=1),u>i.numPages&&i.numPages!==0&&(u=i.numPages),t=r;t<=u;t++)i.pages[t]||t!==n&&i._loadPage(t,!0)},actionHistoryDepth:function(){return this.actionHistory.length},getActionHistory:function(){return this.actionHistory},playActionHistory:function(t){var i=this;t&&(i._clearReportViewerForDrill(),i.reportPath=t.ReportPath,i.sessionID=t.SessionID,i.curPage=t.CurrentPage,i.hideDocMap(),i.scrollLeft=t.ScrollLeft,i.scrollTop=t.ScrollTop,i.reportStates=t.reportStates,i.renderTime=t.renderTime,i.renderError=t.renderError,i.paramMetadata=t.paramMetadata,t.credentialDefs!==null&&(i.credentialDefs=t.credentialDefs,i.datasourceCredentials=t.savedCredential,i.$credentialDialog||(i.$credentialDialog=i.options.$appContainer.find(".fr-dsc-section")),i.$credentialDialog.dsCredential("resetSavedCredential",i.credentialDefs.CredentialsList,i.datasourceCredentials)),i._trigger(n.changeReport,null,{path:i.reportPath,credentialRequired:i.credentialDefs?!0:!1}),t.FlushCache&&(i._removeParameters(),i.flushCache(),i.pages=t.reportPages,i.paramDefs=t.paramDefs,i.numPages=t.reportPages[t.CurrentPage].reportObj.ReportContainer.NumPages?t.reportPages[t.CurrentPage].reportObj.ReportContainer.NumPages:0,t.paramDefs&&(i.options.paramArea.reportParameter({$reportViewer:i,$appContainer:i.options.$appContainer,RDLExt:i.getRDLExt()}),i.options.paramArea.reportParameter("setParametersAndUpdate",t.paramDefs,t.savedParams,t.CurrentPage),i.$numOfVisibleParameters=i.options.paramArea.reportParameter("getNumOfVisibleParameters"),i.$numOfVisibleParameters>0&&i._trigger(n.showParamArea,null,{reportPath:i.reportPath}),i.paramLoaded=!0,i.$paramarea=i.options.paramArea),i.options.parameterModel&&t.parameterModel&&i.options.parameterModel.parameterModel("setModel",t.parameterModel)),i._loadPage(t.CurrentPage,!1,null,null,!1,i.pages[i.curPage].Replay))},back:function(){var t=this,i=t.actionHistory.pop();i?(t.playActionHistory(i),t._trigger(n.actionHistoryPop,null,{path:t.reportPath})):(t.flushCache(),t._resetViewer(!1),forerunner.device.allowZoom(!1),t._trigger(n.back,null,{path:t.reportPath}))},showNav:function(){var t=this;t._resetContextIfInvalid(function(){t.pageNavOpen?(t.pageNavOpen=!1,window.removeEventListener?window.removeEventListener("orientationchange",t._handleOrientation,!1):window.detachEvent("orientationchange",t._handleOrientation),t.element.unmask(function(){t.showNav.call(t)})):(t.pageNavOpen=!0,window.addEventListener?window.addEventListener("orientationchange",t._handleOrientation,!1):window.attachEvent("orientationchange",t._handleOrientation),t.element.mask(function(){t.showNav.call(t)}));t.options.pageNavArea&&t.options.pageNavArea.pageNav("showNav");t._trigger(n.showNav,null,{newPageNum:t.curPage,path:t.reportPath,open:t.pageNavOpen});t._reLayoutPage(t.curPage)})},_handleOrientation:function(){var t=this,n=$(".fr-layout-pagesection");forerunner.device.isSmall(t.element)?n.is(":visible")&&n.hide():n.is(":hidden")&&n.show()},flushCache:function(){var n=this;n.pages={};n.options.pageNavArea&&n.options.pageNavArea.pageNav("reset")},_saveThumbnail:function(){var n=this,t=forerunner.config.forerunnerAPIBase()+"ReportManager/SaveThumbnail";n.getCurPage()!==1||n.SaveThumbnail||(n.SaveThumbnail=!0,forerunner.ajax.ajax({type:"GET",url:t,data:{ReportPath:n.reportPath,SessionID:n.sessionID,Instance:n.options.rsInstance},success:function(){}}))},_prepareAction:function(n){var t=this;t.togglePageNum!==t.curPage||t.togglePageNum===0?forerunner.ajax.ajax({type:"POST",url:t.options.reportViewerAPI+"/ReportJSON/",data:{ReportPath:t.reportPath,SessionID:t.sessionID,PageNumber:t.curPage,ParameterList:"",instance:t.options.rsInstance},dataType:"json",success:function(){t.togglePageNum=t.curPage},done:function(){n&&n()},fail:function(){t._showMessageBox(t.locData.getLocData().messages.prepareActionFailed)}}):n&&n()},_updateSortState:function(n,t,i){var r=this;i!==!1&&(r.reportStates.sortStates=[]);r.reportStates.sortStates.push({id:n,direction:t})},_getSortResult:function(n,t,i){var r=this;return forerunner.ajax.ajax({dataType:"json",url:r.options.reportViewerAPI+"/SortReport/",data:{SessionID:r.sessionID,SortItem:n,Direction:t,ClearExistingSort:i,instance:r.options.rsInstance}})},_replaySortStates:function(){for(var i=this,t=i.reportStates.sortStates,n=0;n<t.length;n++)i._getSortResult(t[n].id,t[n].direction,n===0)},sort:function(n,t,i){var r=this,u,f=forerunner.ssr.constants.sortDirection;r.lock!==1&&(r.lock=1,r._resetContextIfInvalid(function(){u=n===f.asc?f.desc:f.asc;r._callSort(t,u,i)}))},_callSort:function(n,t,i){var r=this;r._updateSortState(n,t);forerunner.ajax.getJSON(r.options.reportViewerAPI+"/SortReport/",{SessionID:r.sessionID,SortItem:n,Direction:t,ClearExistingSort:i,instance:r.options.rsInstance},function(n){r.saveScrollPosition();r.numPages=n.NumPages;r.renderTime=(new Date).getTime();var t=r.pages[r.curPage].Replay;r._loadPage(n.NewPage,!1,null,null,!0,t)},function(n,t,i,u){r._writeError(n,t,i,u)})},_isReportContextValid:!0,invalidateReportContext:function(){this._isReportContextValid=!1},_callGetReportJSON:function(n){var t=this,i=null,r;t.paramLoaded&&(r=t.options.paramArea,i=r.reportParameter("getParamsList",!0));forerunner.ajax.ajax({type:"POST",dataType:"json",url:t.options.reportViewerAPI+"/ReportJSON/",data:{ReportPath:t.reportPath,SessionID:t.sessionID,PageNumber:t.getCurPage(),ParameterList:i,instance:t.options.rsInstance},success:function(){t._isReportContextValid=!0},done:function(){n&&n()}})},_updateToggleState:function(n){var t=this;t.reportStates.toggleStates.has(n)?t.reportStates.toggleStates.remove(n):t.reportStates.toggleStates.add(n)},_getToggleResult:function(n){var i=this;return forerunner.ajax.ajax({dataType:"json",url:i.options.reportViewerAPI+"/NavigateTo/",data:{NavType:t.toggle,SessionID:i.sessionID,UniqueID:n,instance:i.options.rsInstance}})},_replayToggleStates:function(){for(var t=this,i=t.reportStates.toggleStates.keys(),n=0;n<i.length;n++)t._getToggleResult(i[n])},toggleItem:function(n,t){var i=this;i.lock!==1&&(i.lock=1,i.showLoadingIndictator(),i._resetContextIfInvalid(function(){i._prepareAction(function(){i._callToggle(n,t)})}))},_callToggle:function(n,i){var r=this;r._updateToggleState(n);forerunner.ajax.getJSON(r.options.reportViewerAPI+"/NavigateTo/",{NavType:t.toggle,SessionID:r.sessionID,UniqueID:n,instance:r.options.rsInstance},function(n){if(n.Result===!0){r.saveScrollPosition();var t=r.pages[r.curPage].Replay;r.pages[r.curPage]=null;r._loadPage(r.curPage,!1,undefined,undefined,undefined,t,i)}else r.lock=0},function(n,t,i,u){r.lock=0;r._writeError(n,t,i,u)})},_resetContextIfInvalid:function(n){var t=this;t._revertUnsubmittedParameters();t._isReportContextValid?n&&n():t._callGetReportJSON(function(){t._replaySortStates(function(){t._replayToggleStates(function(){n&&n()})})})},_revertUnsubmittedParameters:function(){var n=this,t;if(n.paramLoaded)return t=n.options.paramArea,t.reportParameter("revertParameters")},navigateBookmark:function(n){var i=this;i.lock!==1&&(i.lock=1,i._resetContextIfInvalid(function(){i._prepareAction(function(){forerunner.ajax.getJSON(i.options.reportViewerAPI+"/NavigateTo/",{NavType:t.bookmark,SessionID:i.sessionID,UniqueID:n,instance:i.options.rsInstance},function(t){t.NewPage===i.curPage?(i._navToLink(n),i.lock=0):t.NewPage!==undefined&&t.NewPage>0?(i.backupCurPage(),i._loadPage(t.NewPage,!1,n)):(i._showMessageBox(i.locData.getLocData().messages.bookmarkNotFound),i.lock=0)},function(n,t,r,u){i.lock=0;i._writeError(n,t,r,u)})})}))},isDrillThoughReport:function(){var n=this;return n.origionalReportPath===n.reportPath?!0:!1},navigateDrillthrough:function(i){var r=this;r.lock!==1&&(r.lock=1,r.showLoadingIndictator(),r._resetContextIfInvalid(function(){r._prepareAction(function(){r.isDebug&&console.log("DrillThough",{session:r.sessionID,drillThrough:i});forerunner.ajax.getJSON(r.options.reportViewerAPI+"/NavigateTo/",{NavType:t.drillThrough,SessionID:r.sessionID,UniqueID:i,instance:r.options.rsInstance},function(t){r.backupCurPage(!0);t.Exception?(r._renderPageError(r.$reportAreaContainer.find(".Page"),t),r.removeLoadingIndicator(),r.lock=0):(r.renderError=!1,r.sessionID=t.SessionID,r.RDLExtProperty=null,r.origionalReportPath===""&&(r.origionalReportPath=r.reportPath),r.reportPath=t.ReportPath,r.options.parameterModel&&r.options.parameterModel.parameterModel("getCurrentParameterList",r.reportPath,!0),r._trigger(n.drillThrough,null,{path:t.ReportPath}),r.isDebug&&console.log("DrillThough",{drillReport:t.ReportPath,data:t}),t.CredentialsRequired?(r.$reportAreaContainer.find(".Page").detach(),r._setScrollLocation(0,0),r._writeDSCredential(t.Credentials)):t.ParametersRequired?(r.$reportAreaContainer.find(".Page").detach(),r._setScrollLocation(0,0),r._showParameters(1,t.Parameters)):(r._setScrollLocation(0,0),r._loadPage(1,!1,null,null,!0)))},function(n,t,i,u){r.lock=0;r._writeError(n,t,i,u)})})}))},navigateDocumentMap:function(n){var i=this;i.lock!==1&&(i.lock=1,i._resetContextIfInvalid(function(){forerunner.ajax.getJSON(i.options.reportViewerAPI+"/NavigateTo/",{NavType:t.docMap,SessionID:i.sessionID,UniqueID:n,instance:i.options.rsInstance},function(t){i.backupCurPage(!1,!0);i.hideDocMap();i._loadPage(t.NewPage,!1,n)},function(n,t,r,u){i.lock=0;i._writeError(n,t,r,u)})}))},backupCurPage:function(t,i){var r=this,u,f,o,s=null,e,h;t!==!0&&(t=!1);i===!0?(u=r.savedTop,f=r.savedLeft):(e=r.getScrollPosition(),u=e.top,f=e.left);r.paramLoaded&&(h=r.options.paramArea,o=h.reportParameter("getParamsList",!0));r.options.parameterModel&&(s=r.options.parameterModel.parameterModel("getModel"));r.actionHistory.push({ReportPath:r.reportPath,SessionID:r.sessionID,CurrentPage:r.curPage,ScrollTop:u,ScrollLeft:f,FlushCache:t,paramLoaded:r.paramLoaded,savedParams:o,reportStates:r.reportStates,renderTime:r.renderTime,reportPages:r.pages,paramDefs:r.paramDefs,credentialDefs:r.credentialDefs,savedCredential:r.datasourceCredentials,renderError:r.renderError,parameterModel:s,paramMetadata:r.paramMetadata});r._clearReportViewerForDrill();r._trigger(n.actionHistoryPush,null,{path:r.reportPath})},_clearReportViewerForDrill:function(){var n=this;n.datasourceCredentials=null;n.credentialDefs=null},_setScrollLocation:function(n,t){var i=this;i.scrollLeft=t;i.scrollTop=n},find:function(t,i,r,u){var f=this;t!==""&&(forerunner.dialog.isMessageBoxVisible()||f._resetContextIfInvalid(function(){if(f.findKeyword&&f.findKeyword===t||(f.resetFind(),f.findKeyword=t),f._trigger(n.find),f.finding&&!u)f._findNext(t);else{if(i===undefined&&(i=f.getCurPage()),r===undefined&&(r=f.getNumPages()===0?2147483647:f.getNumPages()),i>r){f.resetFind();f._showMessageBox(f.locData.getLocData().messages.completeFind,undefined,f._findDone);return}f.findStartPage===null&&(f.findStartPage=i);forerunner.ajax.getJSON(f.options.reportViewerAPI+"/FindString/",{SessionID:f.sessionID,StartPage:i,EndPage:r,FindValue:t,instance:f.options.rsInstance},function(n){n.NewPage!==0?(f.finding=!0,n.NewPage!==f.getCurPage()?(f._addSetPageCallback(function(){f._setFindHighlight(t)}),f.pages[n.NewPage]=null,f._loadPage(n.NewPage,!1)):f._setFindHighlight(t)):f.findStartPage!==1?(f.findEndPage=f.findStartPage-1,f.find(t,1,f.findEndPage,!0),f.findStartPage=1):(f.finding===!0?f._showMessageBox(f.locData.getLocData().messages.completeFind,undefined,f._findDone):f._showMessageBox(f.locData.getLocData().messages.keyNotFound,undefined,f._findDone),f.resetFind())},function(n,t,i,r){f._writeError(n,t,i,r)})}}))},_findNext:function(t){var i=this,r,u;if(i.$keywords.filter(".fr-render-find-highlight").first().removeClass("fr-render-find-highlight"),r=i.$keywords.filter(":visible").filter(".Unread").first(),r.length>0)r.removeClass("Unread").addClass("fr-render-find-highlight").addClass("Read"),i._trigger(n.navToPosition,null,{top:r.offset().top-150,left:r.offset().left-250});else{if(i.getNumPages()===1){i._showMessageBox(i.locData.getLocData().messages.completeFind,undefined,i._findDone);i.resetFind();return}u=i.findEndPage?i.findEndPage:i.getNumPages()===0?2147483647:i.getNumPages();i.getCurPage()+1<=u?i.find(t,i.getCurPage()+1,u,!0):i.findStartPage>1?(i.findEndPage=i.findStartPage-1,i.getCurPage()===i.findEndPage?(i._showMessageBox(i.locData.getLocData().messages.completeFind,undefined,i._findDone),i.resetFind()):i.find(t,1,i.findEndPage,!0)):(i._showMessageBox(i.locData.getLocData().messages.completeFind,undefined,i._findDone),i.resetFind())}},_setFindHighlight:function(t){var i=this,r;i._clearHighLightWord();i._highLightWord(i.$reportContainer[0],t);i.$keywords=i.$reportContainer.find("span.fr-render-find-keyword");r=i.$keywords.filter(":visible").filter(".Unread").first();r.length>0&&(r.removeClass("Unread").addClass("fr-render-find-highlight").addClass("Read"),i._trigger(n.navToPosition,null,{top:r.offset().top-150,left:r.offset().left-250}))},_findDone:function(t){t._trigger(n.findDone)},_showMessageBox:function(n,t,i){var r=this;typeof t=="function"&&t(r);forerunner.dialog.showMessageBox(r.options.$appContainer,n);typeof i=="function"&&i(r)},resetFind:function(){var n=this;n.finding=!1;n.findKeyword=null;n.findStartPage=null;n.findEndPage=null},exportReport:function(n){var t=this;t._resetContextIfInvalid(function(){var i=t.options.reportViewerAPI+"/ExportReport/?ReportPath="+encodeURIComponent(t.getReportPath())+"&SessionID="+t.getSessionID()+"&ExportType="+n,r;t.options.rsInstance&&(i+="&instance="+t.options.rsInstance);t.options.exportCallback!==undefined?t.options.exportCallback(i):(r=window.open(i),r.location.href=i)})},showPrint:function(){var n=this;forerunner.config.getCustomSettingsValue("FastPrint","on").toLowerCase()==="on"?n.printReport(""):n.$printDialog&&n.$printDialog.reportPrint("openDialog")},editEmailSubscription:function(n){var t=this,i,r;t.showSubscriptionUI()&&(t._setEmailSubscriptionUI(),t.$emailSub&&(t.$emailSub.emailSubscription("option","reportPath",t.getReportPath()),i=null,t.paramLoaded&&(r=t.options.paramArea,i=r.reportParameter("getParamsList",!0)),t.$emailSub.emailSubscription("option","paramList",i),t.$emailSub.emailSubscription("loadSubscription",n),t.$emailSub.emailSubscription("openDialog")))},showEmailSubscription:function(){var n=this;n.showSubscriptionUI()&&(n._setEmailSubscriptionUI(),n.$emailSub&&(n.$emailSub.emailSubscription("option","reportPath",n.getReportPath()),$.when(n.$emailSub.emailSubscription("getSubscriptionList")).done(function(t){forerunner.config.getCustomSettingsValue("ManageSubscriptionUI","default")==="always"?n.manageSubscription():t.length===0?n.editEmailSubscription(null):t.length===1?n.editEmailSubscription(t[0].SubscriptionID):n.manageSubscription()}).fail(function(){n._showEmailSubscriptionDialog(null)})))},manageSubscription:function(){var n=this;n.showSubscriptionUI()&&(n._setManageSubscriptionUI(),n.$manageSub&&(n.$manageSub.manageSubscription("option","reportPath",n.getReportPath()),n.$manageSub.manageSubscription("listSubscriptions",null),n.$manageSub.manageSubscription("openDialog")))},printReport:function(n){var t=this;t._resetContextIfInvalid(function(){var r=t.options.reportViewerAPI+"/PrintReport/?ReportPath="+t.getReportPath()+"&SessionID="+t.getSessionID()+"&PrintPropertyString="+n,i;t.options.rsInstance&&(r+="&instance="+t.options.rsInstance);t.options.printCallback!==undefined?t.options.printCallback(r):forerunner.device.isFirefox()&&forerunner.config.getCustomSettingsValue("FirefoxPDFbug","on").toLowerCase()==="on"||forerunner.device.isMobile()?window.open(r):(i=t.element.find(".fr-print-iframe"),i.length===1&&i.detach(),i=$("<iframe/>"),i.addClass("fr-print-iframe"),i.attr("name",t.viewerID),i.attr("src",r),i.hide(),t.element.append(i))})},_setPrint:function(n){var t=this;t.$printDialog=t.options.$appContainer.find(".fr-print-section");i.hasWidget(t.$printDialog,i.reportPrint)&&t.$printDialog.reportPrint("setPrint",n)},_setEmailSubscriptionUI:function(){var n=this;n.$emailSub||(n.$emailSub=n.options.$appContainer.find(".fr-emailsubscription-section"))},_setManageSubscriptionUI:function(){var n=this;n.$manageSub||(n.$manageSub=n.options.$appContainer.find(".fr-managesubscription-section"))},_onModelSetChanged:function(n,t){var i=this;t&&i.refreshParameters(t,!0,1)},_getSavedParams:function(n){for(var t=0;t<n.length;t++)if(n[t])return n[t];return null},_loadParameters:function(n,t,i){var r=this,e=null,u,f;r.options.showSubscriptionOnOpen&&(e=r._loadSubscriptionParameters(r.options.showSubscriptionOnOpen));u=r._getSavedParams([e,t,r.savedParameters,r.options.parameterModel?r.options.parameterModel.parameterModel("getCurrentParameterList",r.reportPath):null]);f=null;u&&(f=forerunner.helper.JSONParse(u));i===undefined&&(i=!0);f&&f.ParamsList&&f.ParamsList.length>0?r.options.paramArea&&(r.options.paramArea.reportParameter({$reportViewer:this,$appContainer:r.options.$appContainer,RDLExt:r.getRDLExt()}),i===!1?(r._loadPage(n,!1,null,null,!1),r.options.paramArea.reportParameter("setsubmittedParamsList",u)):r.refreshParameters(u,i,n,!1)):r._loadDefaultParameters(n,r._showParameterCallback)},_paramsToString:function(n){return JSON.stringify(n)},_loadSubscriptionParameters:function(n){var i=this,t;if(i._setEmailSubscriptionUI(),i.$emailSub){var f=i.$emailSub.emailSubscription("getSubscriptionInfo",n),r=f.Parameters,u=[];for(t=0;t<r.length;t++)u.push({Parameter:r[t].Name,Value:r[t].Value,IsMultiple:"false",Type:""});return JSON.stringify({ParamsList:u})}return null},_loadDefaultParameters:function(n,t){var i=this;forerunner.ajax.ajax({type:"POST",url:i.options.reportViewerAPI+"/ParameterJSON/",data:{ReportPath:i.reportPath,SessionID:i.getSessionID(),ParameterList:null,DSCredentials:i.getDataSourceCredential(),instance:i.options.rsInstance},dataType:"json",done:function(r){r.Debug&&(r.ReportPath=i.reportPath,r.SessionID=i.getSessionID());typeof t=="function"&&t.call(i,r,n)},fail:function(n,t,r,u){i._writeError(n,t,r,u)}})},_showParameterCallback:function(n,t){var i=this;n.Exception?(i._renderPageError(i.$reportContainer,n),i.removeLoadingIndicator()):(n.SessionID&&(i.sessionID=n.SessionID),i.showLoadingIndictator(),i._showParameters(t,n))},_getParameterMetadata:function(n){var t=this;t.paramMetadata=n.Exception?null:n},_showParameters:function(t,i){var r=this,u;r.isDebug&&console.log("showParameters",{loadPage:t,data:i});i.Type==="Parameters"?(r._removeParameters(),r.$reportContainer.find(".Page").detach(),u=r.options.paramArea,r.isDebug&&console.log("showParameters",{paramArea:u}),u&&(r.paramDefs=i,u.reportParameter({$reportViewer:this,$appContainer:r.options.$appContainer,RDLExt:r.getRDLExt()}),u.reportParameter("writeParameterPanel",i,t),r.$numOfVisibleParameters=u.reportParameter("getNumOfVisibleParameters"),r.isDebug&&console.log("showParameters",{numOfVisibleParameters:r.$numOfVisibleParameters}),r.$numOfVisibleParameters>0&&r._trigger(n.showParamArea,null,{reportPath:r.reportPath}),r.paramLoaded=!0,r.$paramarea=r.options.paramArea)):i.Exception?(r._renderPageError(r.$reportContainer,i),r.removeLoadingIndicator()):r._loadPage(t,!1,null,null,!0)},getParamDefs:function(n){var t=this,i=null,r=!1;n&&(r=!0);forerunner.ajax.ajax({type:"POST",url:t.options.reportViewerAPI+"/ParameterJSON",data:{ReportPath:t.reportPath,SessionID:t.getSessionID(),ParameterList:null,DSCredentials:t.getDataSourceCredential(),instance:t.options.rsInstance},dataType:"json",async:r,success:function(t){t.Exception?(console.log("getParamsDef - failed:"),console.log(t)):i=t;n&&n(i)}})},extendParameters:function(n,t){for(var i,f,e=this,o=typeof n=="string"?JSON.parse(n):n,r,s={},u=0;u<o.ParamsList.length;u++)r=o.ParamsList[u],s[r.Parameter]=r;for(i=JSON.parse(e.options.paramArea.reportParameter("getParamsList")),(i===null||i.ParamsList===null)&&(i={ParamsList:[]}),f={},u=0;u<i.ParamsList.length;u++)r=i.ParamsList[u],f[r.Parameter]=r;$.extend(!0,f,s);i.ParamsList=[];for(r in f)i.ParamsList.push(f[r]);e.refreshParameters(i,t)},refreshParameters:function(n,t,i,r,u){var f=this;i===-1&&(i=f.getCurPage());f.paramMetadata||f._loadDefaultParameters(i,f._getParameterMetadata);n&&forerunner.ajax.ajax({type:"POST",url:f.options.reportViewerAPI+"/ParameterJSON",data:{ReportPath:f.reportPath,SessionID:f.getSessionID(),ParameterList:typeof n=="string"?n:JSON.stringify(n),DSCredentials:f.getDataSourceCredential(),instance:f.options.rsInstance},dataType:"json",success:function(e){e.Exception?(f._renderPageError(f.$reportContainer,e),f.removeLoadingIndicator()):(f.isDebug&&console.log("refreshParameters",{ReportPath:f.reportPath,SessionID:f.getSessionID(),ParameterList:n,DSCredentials:f.getDataSourceCredential(),instance:f.options.rsInstance,data:e}),e.SessionID&&(f.sessionID=e.SessionID),f._updateParameterData(e,t,i,r,u,n))}})},_updateParameterData:function(t,i,r,u,f,e){var o=this;t&&(o.paramDefs=t,o.options.paramArea.reportParameter("updateParameterPanel",t,i,r,u,f,e,o.paramMetadata),o.$numOfVisibleParameters=o.options.paramArea.reportParameter("getNumOfVisibleParameters"),o.$numOfVisibleParameters>0&&o._trigger(n.showParamArea,null,{reportPath:o.reportPath}),o.paramLoaded=!0,o.$paramarea=o.options.paramArea)},_removeParameters:function(){var n=this,t=n.options.paramArea;t&&(t.reportParameter("removeParameter"),n.paramLoaded=!1,n.$numOfVisibleParameters=0)},_resetViewer:function(n){var t=this;t.numPages=0;t.floatingHeaders=[];n||(t.paramLoaded=!1,t._removeAutoRefreshTimeout(),t.SaveThumbnail=!1,t.paramMetadata=null);t.scrollTop=0;t.scrollLeft=0;t.finding=!1;t.findStartPage=null;t.hasDocMap=!1;t.docMapData=null;t.togglePageNum=0;t.findKeyword=null;t.origionalReportPath="";t.renderError=!1;t.reportStates={toggleStates:new forerunner.ssr.map,sortStates:[]};n||t._removeParameters()},_reloadFromSessionStorage:function(){var t=this,i,n;return sessionStorage.forerunner_zoomReload_actionHistory&&(i=sessionStorage.forerunner_zoomReload_actionHistory,delete sessionStorage.forerunner_zoomReload_actionHistory,n=JSON.parse(i),n.actionHistory&&n.actionHistory[0].ReportPath!=="")?(t.actionHistory=n.actionHistory,t.back(),!0):!1},loadDynamicReport:function(n,t,i,r,u){var f=this;f.dynamicReport=!0;u&&(f.RDLExtProperty=forerunner.helper.JSONParse(u));f._loadReport(n,i,r,t)},loadReport:function(n,t,i,r){var u=this;u.dynamicReport=!1;u._loadReport(n,t,i,r)},_loadReport:function(t,i,r,u){var f=this;f._zoomFactor=100;f._checkPermission(t,function(){if(f._trigger(n.preLoadReport,null,{viewer:f,oldPath:f.reportPath,newPath:t,pageNum:i}),f._reloadFromSessionStorage()){f._trigger(n.afterLoadReport,null,{viewer:f,reportPath:f.getReportPath(),sessionID:f.getSessionID()});return}(f.reportPath&&f.reportPath!==""&&f.reportPath!==t||f.dynamicReport===!0)&&(f.backupCurPage(!0),f.sessionID="",f.flushCache(),f.hideDocMap(),f.element.unmask());u&&(f.sessionID=u);f._resetViewer();f.reportPath=t?t:"/";f.pageNum=i?i:1;f.savedParameters=r?r:null;f._getRDLExtProp(function(){f.RDLExtProperty.DefaultZoom&&(f.options.zoom=f.RDLExtProperty.DefaultZoom);f.options.jsonPath?(f._renderJson(),f._addSetPageCallback(function(){f._trigger(n.afterLoadReport,null,{viewer:f,reportPath:f.getReportPath(),sessionID:f.getSessionID(),RDLExtProperty:f.RDLExtProperty});f._setOptionsZoom()})):f.options.parameterModel&&f.dynamicReport!==!0?f.options.parameterModel.parameterModel("getCurrentParameterList",f.reportPath,undefined,function(){f._loadParameters(f.pageNum);f._addSetPageCallback(function(){f._trigger(n.afterLoadReport,null,{viewer:f,reportPath:f.getReportPath(),sessionID:f.getSessionID(),RDLExtProperty:f.RDLExtProperty});f._setOptionsZoom()})}):(f._loadParameters(f.pageNum),f._addSetPageCallback(function(){f._trigger(n.afterLoadReport,null,{viewer:f,reportPath:f.getReportPath(),sessionID:f.getSessionID(),RDLExtProperty:f.RDLExtProperty});f._setOptionsZoom()}))})})},_setOptionsZoom:function(){var n=this,t;if(n.options.zoom)if(n.options.zoom==="page width")n.zoomToPageWidth();else if(n.options.zoom==="whole page")n.zoomToWholePage();else try{t=parseFloat(n.options.zoom);n.zoomToPercent(t)}catch(i){}},_getRDLExtProp:function(n){var t=this;if(t.dynamicReport===!0){t.RDLExtProperty||(t.RDLExtProperty={});n&&n();return}if(t.property=forerunner.cache.itemProperty[t.reportPath],t.property){t.RDLExtProperty=forerunner.helper.JSONParse(t.property.ForerunnerRDLExt)||{};n&&n();return}forerunner.ajax.ajax({type:"GET",dataType:"json",url:forerunner.config.forerunnerAPIBase()+"ReportManager/ReportProperty/",data:{path:t.reportPath,propertyName:"ForerunnerRDLExt",instance:t.options.rsInstance},success:function(i){forerunner.cache.itemProperty[t.reportPath]||(forerunner.cache.itemProperty[t.reportPath]={});forerunner.cache.itemProperty[t.reportPath].ForerunnerRDLExt=i&&JSON.stringify(i)!=="{}"?forerunner.helper.JSONParse(i):{};t.RDLExtProperty=forerunner.cache.itemProperty[t.reportPath].ForerunnerRDLExt;n&&n()}})},getRDLExt:function(){var n=this;return n.RDLExtProperty},_updateRDLExt:function(n){var t=this;if(t.isDestroy!==!0)try{t.RDLExtProperty=$.trim(n.newRDL)!==""?jQuery.parseJSON(n.newRDL):{};t._ReRender(!0)}catch(i){return forerunner.dialog.showMessageBox(t.options.$appContainer,i.message,"Error Saving"),!1}},loadReportWithNewParameters:function(n,t,i){var r=this;r.isDebug&&console.log("loadReportWithNewParameters",{paramList:n});i&&(r.sessionID="");r._resetViewer(!0);r.renderTime=(new Date).getTime();t&&parseInt(t,10)===t||(t=1);n&&typeof n=="object"&&(n=JSON.stringify(n));r._loadPage(t,!1,null,n,!0)},loadReportWithCustomDSCredential:function(n){var t=this,i;t.getDataSourceCredential()&&t._resetDSCredential();t.datasourceCredentials=n;t.paramLoaded?(i=t.options.paramArea.reportParameter("getParamsList"),t._loadPage(1,!1,null,i,!0)):t.loadReport(t.getReportPath(),1)},_resetDSCredential:function(){var t=this,i;t.flushCache();t.sessionID=null;i=t.$reportContainer.find(".Page");i&&i.detach();t._trigger(n.resetCredential,null,{paramLoaded:t.paramLoaded})},_renderJson:function(){var n=this,i=1,t=!1;n.element.is(":visible")||t||n.element.show();n.showLoadingIndictator();n.togglePageNum=i;forerunner.ajax.ajax({type:"GET",dataType:"json",url:n.options.jsonPath,done:function(r){n._writePage(r,i,t);t||(r.ReportContainer&&n._setPrint(r.ReportContainer.Report.PageContent.PageLayoutStart),n.element.is(":visible")||n.element.show(),n._updateTableHeaders(n))},fail:function(t,i,r,u){n._writeError(t,i,r,u)}})},_loadPage:function(t,i,r,u,f,e,o){var s=this,h,l,c;if(f===!0&&s.flushCache(),s.pages[t]&&s._getPageContainer(t)){i||(s._setPage(t),s.element.is(":visible")||i||s.element.show(0),r&&s._navToLink(r),s.pages[t].reportObj.ReportContainer&&s.pages[t].reportObj.ReportContainer.Report.AutoRefresh&&s._setAutoRefresh(s.pages[t].reportObj.ReportContainer.Report.AutoRefresh),f!==!0&&s._cachePages(t),o&&(h=s.element.find('div[data-uniqName="'+o+'"]'),h.length===1&&$("html, body").animate({scrollTop:h.offset().top},500)));return}u||(u="");i||s.showLoadingIndictator();s.togglePageNum=t;l=s.getDataSourceCredential();c={ReportPath:s.reportPath,SessionID:s.sessionID,PageNumber:t,ParameterList:u,DSCredentials:l,instance:s.options.rsInstance};s.isDebug&&console.log("LoadPage",{ReportPath:s.reportPath,SessionID:s.sessionID,PageNumber:t,ParameterList:u,DSCredentials:s.getDataSourceCredential(),instance:s.options.rsInstance});s._trigger(n.preLoadPage,null,{viewer:s,reportJSONData:c});s._getRDLExtProp(function(){forerunner.ajax.ajax({type:"POST",dataType:"json",url:s.options.reportViewerAPI+"/ReportJSON/",data:c,done:function(n){s._writePage(n,t,i);i||(n.ReportContainer&&s._setPrint(n.ReportContainer.Report.PageContent.PageLayoutStart),s.element.is(":visible")||s.element.show(),r&&s._navToLink(r),f!==!0&&s._cachePages(t),e&&s._getPageContainer(t).reportRender("replayRespTablix",e),o&&(h=s.element.find('div[data-uniqName="'+o+'"]'),h.length===1&&$("html, body").animate({scrollTop:h.offset().top-50},500)),s._updateTableHeaders(s),s._saveThumbnail())},fail:function(n,t,i,r){s._writeError(n,t,i,r)}})})},_writeError:function(n,t,i,r){var u=this,f={Exception:{DetailMessage:i,Type:"Error",TargetSite:r.url,Source:"",Message:t,StackTrace:JSON.stringify(r)}};u._renderPageError(u.$reportContainer,f)},_getPageContainer:function(n){var t=this,i;return t.pages[n].$container||(t.pages[n].$container=$("<div class='Page'/>"),i=!1,t.options.userSettings&&t.options.userSettings.responsiveUI===!0&&(i=!0),t.pages[n].$container.reportRender({reportViewer:t,responsive:i,renderTime:t.renderTime})),t.pages[n].$container},_writePage:function(n,t,i){var u=this;if(u.isDebug&&console.log("writePage",{data:n}),n&&(!n.Exception||!i)){if(n.CredentialsRequired){u._writeDSCredential(n);return}!i&&n.ReportContainer&&n.ReportContainer.Report.AutoRefresh&&u._addSetPageCallback(function(){u._setAutoRefresh(n.ReportContainer.Report.AutoRefresh)});u.sessionID=n.SessionID?n.SessionID:"";try{u.numPages=n.ReportContainer.NumPages===undefined?0:n.ReportContainer.NumPages}catch(f){u.numPages=0}u.numPages!==0&&t>u.numPages&&(t=u.numPages);u.pages[t]?u.pages[t].reportObj=n:u.pages[t]=new r(n);i||(u.isDebug&&console.log("WritePage",{renderPage:t}),u._renderPage(t),u.isDebug&&console.log("WritePage",{setPage:t,pages:u.pages}),u._setPage(t),n.Exception&&(u.pages[t]=null))}},_reLayoutPage:function(n,t){var i=this;i.pages[n]&&i.pages[n].needsLayout&&(i.pages[n].needsLayout=i.pages[n].$container.reportRender("layoutReport",!0,t,i.getRDLExt()))},_renderPage:function(n){var t=this,i;(t.isDebug&&console.log("RenderPage",{page:t.pages[n]}),t.pages[n]&&t.pages[n].isRendered===!0)||(t.pages[n].reportObj.Exception?t._renderPageError(t._getPageContainer(n),t.pages[n].reportObj):(t.renderError=!1,t.hasDocMap=t.pages[n].reportObj.HasDocMap,i=!1,t.options.userSettings&&t.options.userSettings.responsiveUI===!0&&(i=!0),t._getPageContainer(n).reportRender("render",t.pages[n],!1,t.RDLExtProperty),t.pages[n].needsLayout=!0),t.pages[n].isRendered=!0,t.isDebug&&console.log("RenderPagePost",{page:t.pages[n]}))},_renderPageError:function(t,i){var r=this,u=r.getCurPage();r.renderError=!0;r.pages[u]&&(r.pages[u].isRendered=!1);t.reportRender({reportViewer:r});t.reportRender("writeError",i);r.removeLoadingIndicator();r._trigger(n.renderError,null,i)},_writeDSCredential:function(t){var i=this;i.flushCache();i._resetViewer(!1);i.datasourceCredentials=null;i.credentialDefs=t;i.sessionID=t.SessionID;i.numPages=t.NumPages;i.curPage=1;i.$credentialDialog=i.options.$appContainer.find(".fr-dsc-section");i.$credentialDialog.dsCredential("writeDialog",t.CredentialsList);i.showDSCredential();i._trigger(n.showCredential);i.removeLoadingIndicator()},showDSCredential:function(){var n=this;n.$credentialDialog.dsCredential("openDialog")},_sessionPing:function(){var n=this;n._sessionPingPost(n.sessionID)===!1&&(n.sessionID="");$.each(n.actionHistory,function(t,i){n._sessionPingPost(i.SessionID)})},_sessionPingPost:function(n){var t=this;n&&n!==""&&forerunner.ajax.getJSON(t.options.reportViewerAPI+"/PingSession",{PingSessionID:n,instance:t.options.rsInstance},function(n){return n.Status==="Fail"?!1:!0},function(){console.log("ping error")})},_updateTableHeaders:function(n){$.each(n.floatingHeaders,function(t,i){n._setRowHeaderOffset(i.$tablix,i.$rowHeader);n._setColHeaderOffset(i.$tablix,i.$colHeader)})},_hideTableHeaders:function(){var n=this;$.each(n.floatingHeaders,function(n,t){t.$rowHeader&&t.$rowHeader.css("visibility","hidden");t.$colHeader&&t.$colHeader.css("visibility","hidden")});n.$floatingToolbar&&n.$floatingToolbar.hide()},_navToLink:function(t){var r=this,i=r.element.find("[data-uniqName='"+t+"']")[0],u;i!==undefined&&(u={top:$(i).offset().top-100,left:$(i).offset().left},r._trigger(n.navToPosition,null,u))},_stopDefaultEvent:function(n){window.ActiveXObject?window.event.returnValue=!1:(n.preventDefault(),n.stopPropagation())},_getHeight:function(n){var i,t=n.clone().css({visibility:"hidden"});return t.find("img").remove(),$("body").append(t),i=t.height()+"px",t.remove(),this._convertToMM(i)},_convertToMM:function(n){if(!n)return 0;var i=n.match(/\D+$/),t=n.match(/\d+/);i.length===1&&(i=i[0]);t.length===1&&(t=t[0]);switch(i){case"px":return t/3.78;case"pt":return t*.352777777778;case"in":return t*25.4;case"mm":return t;case"cm":return t*10;case"em":return t*4.2175176}return t},_highLightWord:function(n,t){var i=this;if(t&&t!=="")$.each(n.childNodes,function(n,r){var u,f,e,o,s;if(r.nodeType===3){u=r;try{for(f=u.data.toUpperCase().indexOf(t.toUpperCase());f<u.data.length;){if(f>=0)e=document.createElement("span"),e.className="fr-render-find-keyword Unread",o=u.splitText(f),u=o.splitText(t.length),s=o.cloneNode(!0),e.appendChild(s),r.parentNode.replaceChild(e,o);else break;f=u.data.toUpperCase().indexOf(t.toUpperCase())}}catch(h){}}else i._highLightWord(r,t)});else return},_clearHighLightWord:function(){var n=this;n.$keywords&&(n.$keywords.each(function(t,i){var r=i.parentNode,u=document.createTextNode(i.firstChild.nodeValue);r.replaceChild(u,i);forerunner.device.isMSIE()?n._frSearchNormalize(r):r.normalize()}),n.$keywords=null)},_joinAdjacentTextnodes:function(n){while(n.nextSibling){var t=n.nextSibling;if(t.nodeType===3||t.nodeType===4)n.nodeValue+=t.nodeValue,n.parentNode.removeChild(t);else return}},_frSearchNormalize:function(n){for(var i=this,t=n.firstChild;t&&t.nextSibling;)t.nodeType===1?i._frSearchNormalize(t):t.nodeType===3&&i._joinAdjacentTextnodes(t),t=t.nextSibling},_setAutoRefresh:function(n){var t=this;t.autoRefreshID!==undefined&&(t.autoRefreshID!==null&&t._removeAutoRefreshTimeout(),t.autoRefreshID=setTimeout(function(){if(t.lock===1){t._setAutoRefresh(n);return}var i=t.getScrollPosition();t._addSetPageCallback(function(){t.scrollReportTo(i)});forerunner.dialog.closeAllModalDialogs(t.options.$appContainer);t.refreshReport(t.getCurPage());t.autoRefreshID=null},n*1e3))},_removeAutoRefreshTimeout:function(){var n=this;n.autoRefreshID!==null&&clearTimeout(n.autoRefreshID);n.autoRefreshID=null},destroy:function(){var t=this;t.isDestroy=!0;t._removeAutoRefreshTimeout();t.autoRefreshID=undefined;t.$credentialDialog&&t.$credentialDialog.dsCredential("destroy");t.$printDialog&&t.$printDialog.reportPrint("destroy");t.$emailSub&&t.$emailSub.emailSubscription("destroy");t.$paramarea&&t.$paramarea.reportParameter("destroy");t.options.$appContainer.off(n.saveRDLDone);this._destroy()}})});forerunner=forerunner||{};forerunner.ajax=forerunner.ajax||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.constants=forerunner.ssr.constants||{};forerunner.ssr.constants.events=forerunner.ssr.constants.events||{};$(function(){var r=forerunner.ssr,n=r.constants.events,i=forerunner.ssr.constants.widgets,t=forerunner.localize;$.widget(i.getFullname(i.parameterModel),{options:{rsInstance:null,userName:null},_create:function(){var n=this;n.currentSetId=null;n.serverData=null;n.selectSetId=forerunner.helper.guidGen()},getNewSet:function(n){return{isAllUser:!1,name:null,id:forerunner.helper.guidGen(),data:n}},isCurrentSetAllUser:function(){var n=this,t;return n.serverData&&n.serverData.parameterSets&&n.currentSetId?(t=n.serverData.parameterSets[n.currentSetId],t.isAllUser):!1},canEditAllUsersSet:function(){var n=this;return n.serverData?n.serverData.canEditAllUsersSet:!1},canUserSaveCurrentSet:function(){var n=this;return n.serverData&&n.serverData.canEditAllUsersSet?!0:!n.isCurrentSetAllUser()},addSet:function(n,t,i,r){var f=this,u=f.getNewSet(n);u.name=t;i===!0&&(f.serverData.defaultSetId=u.id);r===!0&&(u.isAllUser=!0);f.serverData.parameterSets[u.id]=u;f._saveModel()},removeSet:function(n){var t=this;delete t.serverData.parameterSets[n];t.serverData.defaultSetId===n&&(t.serverData.defaultSetId=null);t._saveModel()},_addNewSet:function(n){var i=this,r=i.getNewSet(n);return r.name=t.getLocData().parameterModel.defaultName,(i.serverData===undefined||i.serverData===null)&&(i.serverData={canEditAllUsersSet:!1,defaultSetId:r.id,parameterSets:{}}),i.serverData.parameterSets[r.id]=r,i.serverData.defaultSetId=r.id,i.currentSetId=r.id,r},getModel:function(){var n=this;return{serverData:n.cloneServerData(),reportPath:n.reportPath,currentSetId:n.currentSetId}},setModel:function(n){var t=this;t.serverData=n.serverData;t.reportPath=n.reportPath;t.currentSetId=n.currentSetId||null;t._triggerModelChange()},cloneServerData:function(){var n=this;return n.serverData?$.extend(!0,{},n.serverData):null},applyServerData:function(n,t){var i=this,r=null,u,f,e,o;i.serverData.defaultSetId=n.defaultSetId;for(r in n.parameterSets)u=i.serverData.parameterSets[r],f=n.parameterSets[r],u?(u.isAllUser=f.isAllUser,u.name=f.name):i.serverData.parameterSets[r]=f;e=[];for(r in i.serverData.parameterSets)n.parameterSets.hasOwnProperty(r)||e.push(r);while(e.length>0)r=e.pop(),delete i.serverData.parameterSets[r];i._saveModel();t&&t!==i.currentSetId&&(i.currentSetId=t);o=i.getSetCount(i.serverData);o===0&&(i.currentSetId=null,i.serverData.defaultSetId=null);i._triggerModelChange()},getOptionArray:function(n){var f=this,i=[],u,r;for(u in n)r=n[u],i.push({id:r.id,name:r.name});return i.sort(function(n,t){return n.name>t.name?1:t.name>n.name?-1:0}),i.unshift({id:f.selectSetId,name:t.getLocData().parameterModel.selectSet}),i},_modelChangeData:function(){var n=this,t={selectedId:n.currentSetId};return t.optionArray=n.getOptionArray(n.serverData.parameterSets),t},_triggerModelChange:function(){var t=this;t._trigger(n.modelChanged,null,t._modelChangeData())},_isLoaded:function(n){var t=this;return t.serverData!==null&&t.reportPath===n},areSetsEmpty:function(n){if(!n||!n.parameterSets)return!0;for(var t in n.parameterSets)return!1;return!0},getSetCount:function(n){var t=0,i;if(!n||!n.parameterSets)return t;for(i in n.parameterSets)t++;return t},_load:function(n,i){var r=this,u=forerunner.config.forerunnerAPIBase()+"ReportManager/GetUserParameters";if(r._isLoaded(n)){i&&i();return}forerunner.ajax.ajax({url:u,data:{reportPath:n,instance:r.options.rsInstance,userName:r.options.userName},dataType:"json",success:function(u){if(u.ParamsList!==undefined){var f=r._addNewSet(u.ParamsList instanceof Array?u:u.ParamsList);f.name=t.getLocData().parameterModel.defaultName}else u&&(r.serverData=u,r.currentSetId=r.areSetsEmpty(r.serverData)?null:r.serverData.defaultSetId);r.reportPath=n;r._triggerModelChange();i&&i()},error:function(n){console.log("ParameterModel._load() - error: "+n.status);r.currentSetId=null;r.serverData=null;i&&i()}})},_saveModel:function(n,t){var i=this,r=forerunner.config.forerunnerAPIBase()+"ReportManager/SaveUserParameters";forerunner.ajax.post(r,{reportPath:i.reportPath,parameters:JSON.stringify(i.serverData),Instance:i.options.rsInstance,userName:i.options.userName},function(t){n&&typeof n=="function"&&n(t)},function(){t&&typeof t=="function"&&t()})},save:function(n,t,i){var r=this;n&&(r.serverData===null||r.currentSetId===null?(r._addNewSet(JSON.parse(n)),r._triggerModelChange()):r.serverData.parameterSets[r.currentSetId].data=JSON.parse(n),r._saveModel(t,i))},setCurrentSet:function(t){var i=this,r;t&&i.serverData&&i.serverData.parameterSets.hasOwnProperty(t)&&(i.currentSetId=t,r=i.serverData.parameterSets[t],r.data?i._trigger(n.modelSetChanged,null,JSON.stringify(r.data)):i._trigger(n.modelSetChanged,null,null))},getAllParameterSets:function(n,t){var i=this;i._load(n,function(){t(i.serverData.parameterSets)})},getCurrentParameterList:function(n,t,i){var r=this,u=null;return r._load(n,function(){if(t===!0)r.currentSetId=null,r._triggerModelChange();else if(r.serverData){var n=null;r.currentSetId?n=r.serverData.parameterSets[r.currentSetId]:r.serverData.defaultSetId&&(r.currentSetId=r.serverData.defaultSetId,n=r.serverData.parameterSets[r.serverData.defaultSetId],r._triggerModelChange());n&&n.data&&(u=JSON.stringify(n.data))}i&&i(u)}),u},getCurrentSet:function(){var n=this;return n.serverData&&n.currentSetId?n.serverData.parameterSets[n.currentSetId]:null}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var r=forerunner.ssr.constants,i=r.widgets,n=r.toolTypes,f=r.events,u="fr-toolbase-dropdown-container",t=function(n,t){var i=t;return typeof n!="undefined"&&(i="",n!==!1&&n!==null&&(i=n)),i};$.widget(i.getFullname(i.toolBase),{options:{toolClass:null},addTools:function(n,t,i){var r=this,u;i.length!==0&&(u=r.element.find("."+r.options.toolClass),r._addChildTools(u,n,t,i),t?r.enableTools(i):r.disableTools(i))},removeAllTools:function(){var n=this;n.allTools=n.allTools||{};n.allTools.length=0},configure:function(n){var t=this;t.toolbarConfigOption=n;$.each(t.allTools,function(n,i){var r=t.element.find("."+i.selectorClass);r.length>0&&!t._isButtonInConfig(r)&&r.hide()})},_configurations:function(){return[{name:r.toolbarConfigOption.minimal,selectorClass:"fr-toolbase-config-minimal"},{name:r.toolbarConfigOption.dashboardEdit,selectorClass:"fr-toolbase-config-edit"}]},isDashboard:function(){var t=this,n=!1;return t.element.parents().each(function(t,r){i.hasWidget($(r),i.dashboardEditor)&&(n=!0)}),n},_isButtonInConfig:function(n){var t=this,i;return t.toolbarConfigOption?(i=!1,$.each(t._configurations(),function(r,u){t.toolbarConfigOption===u.name&&n.hasClass(u.selectorClass)&&(i=!0)}),i):!0},_addChildTools:function(n,t,i,r){var u=this,e,h,c,f,o,s;for(u.allTools=u.allTools||{},e=$(u._getToolHtml(r[0])),t<=1?n.prepend(e):t>n.children().length?n.append(e):(h=":nth-child("+t+")",c=n.children(h),c.before(e)),f=e,u._addChildTool(f,r[0],i),o=1;o<r.length;o++)if(s=r[o],s)f.after(u._getToolHtml(s)),f=f.next(),u._addChildTool(f,s,i);else throw new Error("Toolbase - addTools() Undefined tool, index: "+o+", toolClass: "+u.options.toolClass);},_addChildTool:function(t,i,r){var u=this;u.allTools[i.selectorClass]=i;i.toolType===n.toolGroup&&i.tools&&u._addChildTools(t,1,r,i.tools);i.sharedClass&&t.addClass(i.sharedClass);i.tooltip&&t.attr("title",i.tooltip());i.dropdown&&u._createDropdown(t,i);i.toolType===n.select&&t.selectTool($.extend(u.options,{toolInfo:i,toolClass:"fr-toolbase-selectinner"}));i.alwaysChange&&t.alwaysChange({handler:i.alwaysChange,toolBase:u});i.visible===!1&&t.hide()},_createDropdown:function(n,t){var r=this;t.$dropdown=$("<div class='"+u+"'/>");t.$dropdown.toolDropdown({$reportViewer:r.options.$reportViewer});t.$dropdown.toolDropdown("addTools",1,!0,t.tools);n.append(t.$dropdown);var i=n.find("."+u),f=t.selectorClass,e=t.imageClass;n.on("click",{toolInfo:t,$tool:n},function(t){if(!n.hasClass("fr-toolbase-disabled")){var r=t.data.$tool.filter(":visible").offset().left-t.data.$tool.filter(":visible").offsetParent().offset().left,u=t.data.$tool.height()+t.data.$tool.filter(":visible").offset().top-t.data.$tool.filter(":visible").offsetParent().offset().top;i.css("left",r);i.css("top",u);i.toggle()}});$(document).on("click",function(n){!i.is(":visible")||$(n.target).hasClass(f)||$(n.target).hasClass(e)||i.toggle()})},getTool:function(n){var t=this;return t.allTools[n]},showTool:function(n){var t=this,i;t.allTools[n]&&(i=t.element.find("."+n),t._isButtonInConfig(i)&&i.css({display:""}))},showTools:function(n){var t=this;n&&$.isArray(n)&&$.each(n,function(n,i){i.selectorClass&&t.showTool(i.selectorClass)})},showAllTools:function(){var n=this;$.each(n.allTools,function(t,i){i.selectorClass&&n.showTool(i.selectorClass)})},hideTool:function(n){var t=this,i;t.allTools[n]?(i=t.element.find("."+n),i.hide()):forerunner.config.getCustomSettingsValue("Debug","off")==="on"&&console.log("hideTool called with an invalid selector class: "+n)},hideTools:function(t){var i=this;t&&$.isArray(t)&&$.each(t,function(t,r){r.selectorClass&&r.toolType!==n.toolGroup&&i.hideTool(r.selectorClass)})},hideAllTools:function(){var t=this;$.each(t.allTools,function(i,r){if(r.selectorClass&&r.toolType!==n.toolGroup){var u=t.element.find("."+r.selectorClass);u.hasClass("fr-toolbase-no-hide-id")||t.hideTool(r.selectorClass)}})},freezeEnableDisable:function(n){var t=this;t.frozen=n},enableTools:function(t){var i=this;i.frozen!==!0&&$.each(t,function(t,r){if(r){var u=i.element.find("."+r.selectorClass);u.removeClass("fr-toolbase-disabled");r.events&&(u.addClass("fr-core-cursorpointer"),i._removeEvent(u,r),i._addEvents(u,r));r.toolType===n.toolGroup&&r.tools&&i.enableTools(r.tools);i.hideDisabledTool&&u.hasClass("fr-hide-if-disable")&&i.showTool(r.selectorClass)}else throw new Error("Toolbase - enableTools() Undefined tool, index: "+t+", toolClass: "+i.options.toolClass);})},disableTools:function(t){var i=this;i.frozen!==!0&&$.each(t,function(t,r){if(r){var u=i.element.find("."+r.selectorClass);u.addClass("fr-toolbase-disabled");r.events&&(u.removeClass("fr-core-cursorpointer"),i._removeEvent(u,r));r.toolType===n.toolGroup&&r.tools&&i.disableTools(r.tools);i.hideDisabledTool&&u.hasClass("fr-hide-if-disable")&&i.hideTool(r.selectorClass)}else throw new Error("Toolbase - disableTools() Undefined tool, index: "+t+", toolClass: "+i.options.toolClass);})},enableAllTools:function(){var n=this;$.each(n.allTools,function(t,i){i.selectorClass&&n.allTools[i.selectorClass].isEnable&&n.enableTools([i])})},disableAllTools:function(){var n=this;$.each(n.allTools,function(t,i){if(i.selectorClass){var r=n.element.find("."+i.selectorClass);r.hasClass("fr-toolbase-no-disable-id")||(n.allTools[i.selectorClass].isEnable=!r.hasClass("fr-toolbase-disabled"),n.disableTools([i]))}})},_orderedList:[],_getOrderedList:function(){var n=this;return forerunner.helper.objectSize(n.allTools)===n._orderedList.length?n._orderedList:(n._orderedList=[],$.each(n.allTools,function(t,i){var u=n.element.find("."+i.selectorClass),r=u.outerWidth();i.visibilityNoWidth&&(r=0);n._orderedList.push({toolInfo:i,width:r})}),n._orderedList.sort(function(n,t){return n.toolInfo.visibilityOrder===undefined&&(n.toolInfo.visibilityOrder=0),t.toolInfo.visibilityOrder===undefined&&(t.toolInfo.visibilityOrder=0),n.toolInfo.visibilityOrder-t.toolInfo.visibilityOrder}),n._orderedList)},windowResize:function(){var i=this,e=i.element.width(),r=i._getOrderedList(),u=0,n=null,t,f;if($.each(r,function(t,r){var f=i.element.find("."+r.toolInfo.selectorClass);f.removeClass("fr-core-hidden");f.is(":visible")&&(u+=r.width,u>e&&(n===null&&(n={index:t,visibilityOrder:r.toolInfo.visibilityOrder}),f.addClass("fr-core-hidden")))}),n!==null)for(t=n.index-1;t>0&&r[t].toolInfo.visibilityOrder===n.visibilityOrder;)f=i.element.find("."+r[t].toolInfo.selectorClass),f.addClass("fr-core-hidden"),t--},_getToolHtml:function(i){var r=this,u=t(i.toolStateClass,"fr-toolbase-state "),s=t(i.iconClass,"fr-icons24x24"),h=t(i.toolContainerClass,"fr-toolbase-toolcontainer"),l=t(i.groupContainerClass,"fr-toolbase-groupcontainer"),a=t(i.itemContainerClass,"fr-toolbase-itemcontainer"),v=t(i.itemTextContainerClass,"fr-toolbase-item-text-container"),y=t(i.itemTextClass,"fr-toolbase-item-text"),f,e,c,o;return i.toolType===n.button?"<div class='"+h+" "+u+i.selectorClass+"'><div class='"+s+" "+i.imageClass+"' /><\/div>":i.toolType===n.input?(f="",i.inputType&&(f=" type='"+i.inputType+"'"),"<input class='"+i.selectorClass+"'"+f+" />"):i.toolType===n.select?"<div class='fr-toolbase-selectcontainer' />":i.toolType===n.textButton?"<div class='"+h+" "+u+i.selectorClass+"'>"+r._getText(i)+"<\/div>":i.toolType===n.plainText?"<span class='"+i.selectorClass+"'> "+r._getText(i)+"<\/span>":i.toolType===n.containerItem?(e="",i.text&&(e=r._getText(i)),c=t(i.imageClass,""),o="",i.rightImageClass&&(o="<div class='fr-toolbase-rightimage "+i.rightImageClass+"'><\/div>"),"<div class='"+a+" "+u+i.selectorClass+"'><div class='"+s+" "+c+"'><\/div><div class='"+v+"'><div class='"+y+"'>"+e+"<\/div><\/div>"+o+"<\/div>"):i.toolType===n.toolGroup?"<div class='"+l+" "+i.selectorClass+"'><\/div>":void 0},_getText:function(n){var t=this;return typeof n.text=="function"?n.text({$reportViewer:t.options.$reportViewer}):n.text},_removeEvent:function(n,t){var r=this;for(var i in t.events)typeof t.events[i]=="function"&&n.off(i,t.events[i])},_addEvents:function(n,t){var i=this;for(var r in t.events)if(typeof t.events[r]=="function")n.on(r,null,{me:i,$appContainer:i.options.$appContainer,$reportViewer:i.options.$reportViewer,$reportExplorer:i.options.$reportExplorer},t.events[r])},removeHideDisable:function(n){var t=this;t.hideDisabledTool&&$.each(n,function(n,i){t.element.find("."+i.selectorClass).removeClass("fr-hide-if-disable")})},_create:function(){},_init:function(){var n=this;n.frozen=!1;forerunner.config.getCustomSettings(function(){n.hideDisabledTool=forerunner.config.getCustomSettingsValue("HideDisabledTool","on")==="on"})}});$.widget(i.getFullname("alwaysChange"),$.forerunner.toolBase,{options:{toolBase:null,handler:null},_create:function(){var i=this,n=i.element.find("select"),t=-1;n.on("change",function(n){t=-1;typeof i.options.handler=="function"&&(n.data={me:i.options.toolBase},i.options.handler(n))});n.on("focus",function(){if(n.prop("selectedIndex")!==0&&t===-1){t=n.prop("selectedIndex");n.prop("selectedIndex",0);var i=function(r){n.is(r.target)||(n.prop("selectedIndex")===0&&n.prop("selectedIndex",t),t=-1,$("body").off("keyup mouseup",i))};$("body").off("keyup mouseup",i);$("body").on("keyup mouseup",i)}})}});$.widget(i.getFullname("toolDropdown"),$.forerunner.toolBase,{options:{$reportViewer:null,toolClass:"fr-toolbase-dropdown"},_init:function(){var n=this;n._super();n.element.html("<div class='"+n.options.toolClass+" fr-core-widget'/>")}});$.widget(i.getFullname("selectTool"),{options:{toolClass:"fr-toolbase-selectinner"},_init:function(){var n=this,r=t(n.options.toolInfo.optionClass,"fr-toolbase-option"),i;n.element.html("");i=$("<div class='"+n.options.toolClass+" fr-core-widget'><select class='"+n.options.toolInfo.selectorClass+"' readonly='true' ismultiple='false'><\/select><\/div>");n.element.append(i)},_create:function(){var n=this;if(n.options.toolInfo.model&&(n.model=n.options.toolInfo.model.call(n),n.options.toolInfo.modelChange))n.model.on(n.options.toolInfo.modelChange,function(t,i){n._onModelChange.call(n,t,i)})},_onModelChange:function(n,t){var r=this,i=r.element.find("."+r.options.toolInfo.selectorClass);i.html("");$.each(t.optionArray,function(n,t){var r=forerunner.helper.htmlEncode(t.name),u=$("<option value="+t.id+">"+r+"<\/option>");i.append(u)});i.children("option").each(function(n,r){$(r).val()===t.selectedId&&i.prop("selectedIndex",n)})}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants.widgets,n=forerunner.ssr.constants.events;$.widget(t.getFullname(t.messageBox),{options:{$appContainer:null},_create:function(){},_init:function(){var t=this,i,r;t.element.off(n.modalDialogGenericSubmit);t.element.off(n.modalDialogGenericCancel);i=forerunner.localize;r=new $("<div class='fr-core-dialog-innerPage fr-core-center'><div class='fr-messagebox-innerpage'><div class='fr-core-dialog-header'><div class='fr-messagebox-title'>"+i.getLocData().dialog.title+"<\/div><\/div><div class='fr-messagebox-content'><span class='fr-messagebox-msg'/><\/div><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input name='close' type='button' class='fr-messagebox-close-id fr-messagebox-submit fr-core-dialog-button' value='"+i.getLocData().dialog.close+"' /><\/div><\/div><\/div><\/div>");t.element.append(r);t.element.find(".fr-messagebox-close-id").on("click",function(){t.closeDialog()});t.element.on(n.modalDialogGenericSubmit,function(){t.closeDialog()});t.element.on(n.modalDialogGenericCancel,function(){t.closeDialog()})},openDialog:function(n,t){var i=this;i.element.find(".fr-messagebox-msg").html(n);t&&i.element.find(".fr-messagebox-title").html(t);forerunner.dialog.showModalDialog(i.options.$appContainer,i)},closeDialog:function(){var n=this;$(".fr-messagebox-msg").html("");forerunner.dialog.closeModalDialog(n.options.$appContainer,n)}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants,t=n.events,i=n.widgets,r=forerunner.localize;$.widget(i.getFullname(i.catalogTree),{options:{rootPath:null,type:null,allowFolderSelection:!0,containerClass:null,catalogTreeClass:null,$appContainer:null,reportManagerAPI:null,rsInstance:null},_create:function(){var n=this,t=r.getLocData().common;n.$catalogTree=new $("<div class='fr-catalog fr-popup-container fr-core-hidden'><div class='fr-tree-container'><\/div><\/div>");n.$tree=n.$catalogTree.find(".fr-tree-container");n.options.containerClass&&n.$catalogTree.addClass(n.options.containerClass);n.options.catalogTreeClass&&n.$tree.addClass(n.options.catalogTreeClass);n.element.siblings(".fr-catalog").remove();n.$catalogTree.insertAfter(n.element)},_init:function(){var n=this;n.options.rootPath&&n._getCatalogTreeData(n.options.rootPath)},_buildTree:function(){var n=this;n.$tree.is(":jstree")&&n.$tree.jstree().destroy();n.options.type==="fullCatalog"?n.$tree.jstree({core:{data:n.fullTreeData}}):n.$tree.jstree({core:{data:n.catalogTreeData}});n.$tree.jstree("deselect_all",!0);n.$catalogTree.addClass("fr-core-hidden");n.$tree.off("changed.jstree");n.$tree.on("changed.jstree",function(){n._onChangedjsTree.apply(n,arguments)})},toggleCatalog:function(n){var t=this;return t.$catalogTree.is(":visible")||t.$catalogTree.css({width:n}),t.$catalogTree.toggleClass("fr-core-hidden"),!t.$catalogTree.hasClass("fr-core-hidden")},_getCatalogTreeData:function(t){var i=this;i.fullTreeData={text:t,state:{opened:!0},li_attr:{dataCatalogItem:{Path:i.options.rootPath,Name:i.options.rootPath,Type:n.itemType.folder}},children:[]};i._getCatalog(t,function(n){i._catalogDataPrefix.call(i,i.fullTreeData,n.children);i.catalogTreeData=i._createSimpleTreeData.call(i,$.extend(!0,{},i.fullTreeData));i._buildTree()})},_catalogDataPrefix:function(t,i){var r=this;$.each(i,function(i,u){var f={text:u.Name,li_attr:{dataCatalogItem:{Path:u.Path,Name:u.Name,Type:u.Type}},children:[]};r._isContainerType(u.Type)?(t.children.push(f),r._catalogDataPrefix(f,u.children)):u.Type===n.itemType.report&&(t.children.push(f),f.icon="jstree-file")})},_createSimpleTreeData:function(n){for(var r=this,t=0,i;t<n.children.length;t++)i=n.children[t],i.children.length!==0?r._createSimpleTreeData(i):i.li_attr.dataCatalogItem.Type!==1&&(n.children.splice(t,1),t=t-1);return n},_getCatalog:function(n,i){var r=this;forerunner.ajax.ajax({dataType:"json",url:r.options.reportManagerAPI+"/GetCatalog",async:!0,data:{rootPath:n,showLinkedReport:!1},success:function(n){typeof i=="function"&&i.call(r,n);r._trigger(t.getCatalogComplete,null,{success:!0})},error:function(n){console.log(n);r._trigger(t.getCatalogComplete,null,{success:!0})}})},_isContainerType:function(t){return t===n.itemType.folder||t===n.itemType.site?!0:!1},_onChangedjsTree:function(n,i){var r=this,u;if(!r.options.allowFolderSelection&&r._isContainerType(i.node.li_attr.dataCatalogItem.Type)){i.node.children.length>0&&r.$tree.jstree("toggle_node",i.node.id);return}if(r.options.type==="fullCatalog"&&r._isContainerType(i.node.li_attr.dataCatalogItem.Type)&&i.node.children.length!==0){r.$tree.jstree("toggle_node",i.node.id);return}u=i.node.text===r.options.rootPath?r.options.rootPath:i.node.li_attr.dataCatalogItem.Path;r._trigger(t.catalogSelected,null,{path:u,item:i.node.li_attr.dataCatalogItem});r.$catalogTree.addClass("fr-core-hidden")}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr,r=t.constants.toolTypes,i=forerunner.ssr.constants.events,n=forerunner.ssr.constants.widgets;t.DefaultAppTemplate=function(n){var t=this;t.options={$container:null,isFullScreen:!0};n&&$.extend(this.options,n)};t.DefaultAppTemplate.prototype={render:function(){var n=this,i=n.options.$container,r,e,o,s,t,f,h,c,l,a,v,y,u,p,w,b,k,d,g,nt;return i.addClass("fr-layout-container"),n.$container=i,r=new $("<div />"),r.addClass("fr-layout-leftpane"),n.$leftpane=r,e=new $("<div />"),e.addClass("fr-layout-leftheader"),n.$leftheader=e,o=new $("<div />"),o.addClass("fr-layout-leftheaderspacer"),n.$leftheaderspacer=o,s=new $("<div />"),s.addClass("fr-layout-leftpanecontent"),n.$leftpanecontent=s,r.append(e),r.append(o),r.append(s),i.append(r),t=new $("<div />"),t.addClass("fr-layout-mainviewport"),n.$mainviewport=t,i.append(t),f=new $("<div />"),f.addClass("fr-layout-topdiv fr-core-block"),n.$topdiv=f,n.options.isFullScreen&&n.$topdiv.css("width",$(window).width()),t.append(f),h=new $("<div />"),h.addClass("fr-layout-linksection"),n.$linksection=h,f.append(h),c=new $("<div />"),c.addClass("fr-layout-mainheadersection"),n.$mainheadersection=c,f.append(c),l=new $("<div />"),l.addClass("fr-layout-topdivspacer  fr-core-block"),n.$topdivspacer=l,t.append(l),a=new $("<div />"),a.addClass("fr-layout-pagesection"),n.$pagesection=a,t.append(a),n.$mainsection=new $("<div />"),n.$mainsection.addClass("fr-layout-mainsection"),n.$pagesection.append(n.$mainsection),n.$docmapsection=new $("<div />"),n.$docmapsection.addClass("fr-layout-docmapsection"),n.$pagesection.append(n.$docmapsection),v=new $("<div />"),v.addClass("fr-layout-bottomdiv"),n.$bottomdiv=v,t.append(v),y=new $("<div />"),y.addClass("fr-layout-bottomdivspacer"),n.$bottomdivspacer=y,t.append(y),u=new $("<div />"),u.addClass("fr-layout-rightpane"),n.$rightpane=u,p=new $("<div />"),p.addClass("fr-layout-rightheader"),n.$rightheader=p,w=new $("<div />"),w.addClass("fr-layout-rightheaderspacer"),n.$rightheaderspacer=w,b=new $("<div />"),b.addClass("fr-layout-rightpanecontent"),n.$rightpanecontent=b,u.append(p),u.append(w),u.append(b),i.append(u),k=new $("<div />"),k.addClass("fr-properties-section"),n.$propertySection=k,i.append(k),d=new $("<div />"),d.addClass("fr-security-section"),n.$securitySection=d,i.append(d),g=new $("<div />"),g.addClass("fr-upf-section"),n.$uploadFileSection=g,i.append(g),nt=new $("<div class=fr-layout-unzoomsection />"),n.$unzoomsection=nt,t.append(n.$unzoomsection),n._initPropertiesDialog(),n._initSecurityDialog(),n._initUploadFileDialog(),n.isDashboard=n.$container.hasClass("fr-dashboard-report-id"),n.outerToolbarHeight=n.isDashboard?$("body").children(".fr-layout-mainviewport").children(".fr-layout-topdiv").height():0,n.options.isFullScreen||n._makePositionAbsolute(),n.bindEvents(),this},_makePositionAbsolute:function(){var n=this;n.$topdiv.addClass("fr-layout-position-absolute");n.$leftheader.addClass("fr-layout-position-absolute");n.$rightheader.addClass("fr-layout-position-absolute");n.$leftpane.addClass("fr-layout-position-absolute");n.$rightpane.addClass("fr-layout-position-absolute");n.$leftpanecontent.addClass("fr-layout-position-absolute");n.$rightpanecontent.addClass("fr-layout-position-absolute")},_makePositionFixed:function(){var n=this;n.$topdiv.removeClass("fr-layout-position-absolute");n.$leftheader.removeClass("fr-layout-position-absolute");n.$rightheader.removeClass("fr-layout-position-absolute");n.$leftpane.removeClass("fr-layout-position-absolute");n.$rightpane.removeClass("fr-layout-position-absolute");n.$leftpanecontent.removeClass("fr-layout-position-absolute");n.$rightpanecontent.removeClass("fr-layout-position-absolute")},_initPropertiesDialog:function(){var n=this;n.$propertySection.addClass("fr-dialog-id fr-core-dialog-layout fr-core-widget");n.$propertySection.forerunnerProperties({$appContainer:n.$container,$reportViewer:n.$mainviewport,$reportExplorer:n.$mainsection})},_initSecurityDialog:function(){var n=this;n.$securitySection.addClass("fr-dialog-id fr-core-dialog-layout fr-core-widget");n.$securitySection.forerunnerSecurity({$appContainer:n.$container,$reportExplorer:n.$mainsection})},_initUploadFileDialog:function(){var n=this;n.$uploadFileSection.addClass("fr-dialog-id fr-core-dialog-layout fr-core-widget");n.$uploadFileSection.uploadFile({$appContainer:n.$container})},bindEvents:function(){var t=this,i=forerunner.ssr.constants.events,r,u,f;if(forerunner.device.isMobile())t.$container.hammer({stop_browser_behavior:{userSelect:!1}}).on("doubletap",function(i){i.preventDefault();i.gesture.preventDefault();t.showSlideoutPane(n.toolbar,!0)});forerunner.history.on(i.historyRoute(),function(n,t){t.name==="transitionToReportManager"||t.name==="transitionToOpenResource"||t.name==="transitionToSearch"?(forerunner.device.allowZoom(!1),$("html").addClass("fr-Explorer-background")):(t.name==="transitionToReportViewer"||t.name==="transitionToReportViewerWithRSURLAccess")&&$("html").removeClass("fr-Explorer-background")});r=$(".fr-layout-mainheadersection",t.$container);r.on(i.toolbarMenuClick(),function(){t.showSlideoutPane(n.toolbar,!0)});r.on(i.toolbarParamAreaClick(),function(){t.showSlideoutPane(n.toolbar,!1)});r.on(i.reportExplorerToolbarMenuClick(),function(){t.showSlideoutPane(n.reportExplorerToolbar,!0)});r.on(i.dashboardToolbarMenuClick(),function(){t.showSlideoutPane(n.dashboardToolbar,!0)});$(".fr-layout-rightpanecontent",t.$container).on(i.reportParameterRender(),function(){t.showSlideoutPane(n.toolbar,!1)});$(".fr-layout-leftheader",t.$container).on(i.leftToolbarMenuClick(),function(){t.hideSlideoutPane(!0)});$(".fr-layout-rightheader",t.$container).on(i.rightToolbarParamAreaClick(),function(){t.hideSlideoutPane(!1)});u=$(".fr-layout-leftpanecontent",t.$container);u.on(i.toolPaneActionStarted(),function(){t.hideSlideoutPane(!0)});u.on(i.dashboardToolPaneActionStarted(),function(){t.hideSlideoutPane(!0)});u.on(i.reportExplorerToolPaneActionStarted(),function(){t.hideSlideoutPane(!0)});$(".fr-layout-rightpanecontent",t.$container).on(i.reportParameterSubmit(),function(){t.hideSlideoutPane(!1)});$(".fr-layout-rightpanecontent",t.$container).on(i.reportParameterCancel(),function(){t.hideSlideoutPane(!1)});t.$container.on(i.showModalDialog,function(){t.$container.addClass("fr-layout-container-noscroll");t.$pagesection.addClass("fr-layout-pagesection-noscroll");t.showModal=!0});t.$container.on(i.closeModalDialog,function(){t.showModal=!1;t.$leftpane.is(":visible")||t.$rightpane.is(":visible")||(t.$container.removeClass("fr-layout-container-noscroll"),t.$pagesection.removeClass("fr-layout-pagesection-noscroll"))});if(f=forerunner.device.isTouch(),!t.options.isFullScreen)if(f&&forerunner.device.isMobile()&&!forerunner.device.isiOS()){t.$container.hammer({stop_browser_behavior:{userSelect:!1},swipe_max_touches:22,drag_max_touches:2}).on("touch release",function(n){if(n.gesture)switch(n.type){case"touch":if(forerunner.helper.containElement(n.target,["fr-layout-topdiv"])||t.$container.hasClass("fr-layout-container-noscroll"))return;t._showTopDiv(!0);break;case"release":n.gesture.velocityX===0&&n.gesture.velocityY===0&&t._updateTopDiv(t)}});t.$container.on("scrollstop",function(){t._updateTopDiv(t)});$(window).on("scrollstop",function(){t._updateTopDiv(t)})}else{$(window).on("scroll",function(){t._updateTopDiv(t)});t.$container.on("scroll",function(){t._updateTopDiv(t)})}$(t.$container).on("touchmove",function(n){if(t.$container.hasClass("fr-layout-container-noscroll")){var i=forerunner.helper.containElement(n.target,["fr-layout-leftpane","fr-layout-rightpane","fr-core-dialog-form","fr-nav-container","ui-autocomplete","fr-property-input","fr-security-container"]);i||n.preventDefault()}});if(forerunner.device.isiOS())$(window).on("orientationchange",function(){$(document.documentElement).height(window.innerHeight);t.hideSlideoutPane(!0);t.hideSlideoutPane(!1)})},windowResize:function(){var n=this;n.ResetSize();n._updateTopDiv(n);n.setBackgroundLayout()},_updateTopDiv:function(n){var r,u;if(n.options.isFullScreen){n.$topdiv.css("width",$(window).width());return}var f=$(window).scrollTop()-n.$container.offset().top+n.outerToolbarHeight,e=n.$container.height()-n.$topdiv.outerHeight(),t=f,i=n.$linksection.is(":visible")?n.$linksection.outerHeight():0;n.isDashboard===!1&&(n.$leftpane.is(":visible")?n.$leftpane.css("top",t>0?t:n.$container.scrollTop()+i):n.$rightpane.is(":visible")&&n.$rightpane.css("top",t>0?t:n.$container.scrollTop()+i));r=t>0?t:n.$container.scrollTop();u=n.$container.scrollLeft();n.$topdiv.css({top:r,left:u})},toggleZoom:function(){var n=this;forerunner.device.isMobile()&&(n.isZoomed()&&n.$viewer&&n.$viewer.data("forerunner-reportViewer")?n.$viewer.reportViewer("showToolbar",!1):n.$viewer&&n.$viewer.data("forerunner-reportViewer")&&n.$viewer.reportViewer("showToolbar",!0))},_allowZoom:function(n){var t=this;t.$viewer!==undefined&&t.$viewer.is(":visible")?t.$viewer.reportViewer("allowZoom",n):forerunner.device.allowZoom(n)},showUnZoomPane:function(){var n=this;n._showTopDiv(!0);n.$unzoomsection.show()},wasZoomed:!1,isZoomed:function(){var n=forerunner.device.zoomLevel();return n>1.25||n<.975?!0:!1},_firstTime:!0,_lastHeight:0,getHeightValues:function(){var t=this,n={},i=t.$linksection.is(":visible")?t.$linksection.outerHeight():0;return n.windowHeight=$(window).height(),n.containerHeight=t.$container.height(),forerunner.device.isiOS()?(n.windowHeight=document.documentElement.clientHeight,!0||!forerunner.device.isiPhone()||forerunner.device.isiPhoneFullscreen()||forerunner.device.isStandalone()||(n.windowHeight+=60,t._firstTime&&(n.containerHeight+=60,t._firstTime=!1))):forerunner.device.isAndroid()&&(n.windowHeight=window.innerHeight),n.windowHeight-=i,n.containerHeight-=i,n.max=Math.max(n.windowHeight,n.containerHeight),n.paneHeight=t.options.isFullScreen?n.windowHeight-38:n.containerHeight-38,window.navigator.standalone&&forerunner.device.isiOS()&&(n.paneHeight=n.max),n},ResetSize:function(){var n=this,t=n.getHeightValues();forerunner.device.isiPhone()&&($("html").css({minHeight:t.max}),$("body").css({minHeight:t.max}));n.$leftpanecontent.css({height:t.paneHeight});n.$rightpanecontent.css({height:t.paneHeight});n.options.isFullScreen?(n.$leftpane.css({height:t.max}),n.$rightpane.css({height:t.max}),n.$topdiv.css("width",$(window).width())):(n.$leftpane.css({height:t.containerHeight}),n.$rightpane.css({height:t.containerHeight}));$(".fr-param-container",n.$container).css({height:"100%"});$(".fr-toolpane",n.$container).css({height:"100%"});var r=n.$container.width(),u=forerunner.config.getCustomSettingsValue("ParameterPaneWidth",280),i=u<r?u:r;n.$rightpane.width(i);n.$rightheader.width(i);n.$rightpanecontent.width(i)},removeTopDiv:function(n){var t=this;t.topDivRemoved=n;t._showTopDiv(n)},_showTopDiv:function(n){var t=this,i=n?0:t.$topdiv.outerHeight();t.isDashboard&&(i+=t.outerToolbarHeight);t.$viewer.reportViewer("option","toolbarHeight",i);t.topDivRemoved&&t.topDivRemoved===!0||n===!0?(t.$topdiv.addClass("fr-core-hidden").removeClass("fr-core-block"),t.$topdivspacer.addClass("fr-core-hidden").removeClass("fr-core-block")):(t.$topdiv.addClass("fr-core-block").removeClass("fr-core-hidden"),t.$topdivspacer.addClass("fr-core-block").removeClass("fr-core-hidden"))},bindExplorerEvents:function(){var n=this;n.$container.on(i.reportExplorerAfterFetch(),function(){n.ResetSize()})},bindViewerEvents:function(){var n=this,i=forerunner.ssr.constants.events,t=$(".fr-layout-reportviewer",n.$container),r;n.$viewer=t;t.on(i.reportViewerActionHistoryPop(),function(){n.hideSlideoutPane(!1)});t.on(i.reportViewerDrillThrough(),function(){n.hideSlideoutPane(!0);n.hideSlideoutPane(!1)});t.on(i.reportViewerShowNav(),function(t,i){var r=n.$bottomdivspacer;i.open?(r.show(),n.$container.addClass("fr-layout-container-noscroll"),n.$pagesection.addClass("fr-layout-pagesection-noscroll")):(r.hide(),n.$container.removeClass("fr-layout-container-noscroll"),n.$pagesection.removeClass("fr-layout-pagesection-noscroll"))});t.on(i.reportViewerShowDocMap(),function(){n.scrollLock=!0;n.savePosition&&n.$viewer.reportViewer("option","savePosition",n.savePosition);n.scrollToPosition(n.getOriginalPosition())});t.on(i.reportViewerHideDocMap(),function(){n.scrollLock=!1;n.restoreScrollPosition()});t.on(i.reportViewerallowZoom(),function(t,i){n._showTopDiv.call(n,i.isEnabled)});t.on(i.reportViewerSetPageDone(),function(){n.setBackgroundLayout.apply(n,arguments);n.isDashboard&&n.$viewer.reportViewer("option","toolbarHeight",n.outerToolbarHeight+n.$topdiv.outerHeight())});t.on(i.reportViewerChangePage(),function(){n.$pagesection.show()});t.on(i.reportViewerSetPageDone(),function(){n.ResetSize()});t.on(i.reportViewerNavToPosition(),function(t,i){var r=0;forerunner.device.isWindowsPhone()&&(r=200);setTimeout(function(){n.scrollToPosition(i);n.savePosition=null},r)});t.on(i.reportViewerPreLoadReport(),function(){n.cleanUp()});t.on(i.reportViewerFind(),function(){n.$leftpane.is(":visible")&&n.hideSlideoutPane(!0)});if(r=forerunner.device.isTouch(),r&&!n.options.isFullScreen)n.$pagesection.on("scrollstop",function(){n._updateTopDiv(n)});t.reportViewer("option","onInputFocus",n.onInputFocus());t.reportViewer("option","onInputBlur",n.onInputBlur())},onInputFocus:function(){var n=this;return forerunner.device.isiOS()?function(){setTimeout(function(){n.options.isFullScreen&&n._makePositionAbsolute();n.$pagesection.addClass("fr-layout-pagesection-noscroll");n.$container.addClass("fr-layout-container-noscroll");$(window).scrollTop(0);$(window).scrollLeft(0);n.ResetSize()},50)}:null},onInputBlur:function(){var n=this;return forerunner.device.isiOS()?function(){setTimeout(function(){n.options.isFullScreen&&n._makePositionFixed();!n.$leftpane||n.$leftpane.is(":visible")||n.$rightpane.is(":visible")||n.showModal===!0||(n.$pagesection.removeClass("fr-layout-pagesection-noscroll"),n.$container.removeClass("fr-layout-container-noscroll"));$(window).scrollTop(0);$(window).scrollLeft(0);n.ResetSize&&n.ResetSize()},50)}:null},getScrollPosition:function(){var t=this,n={};return t.$viewer!==undefined&&t.$viewer.is(":visible")?n=t.$viewer.reportViewer("getScrollPosition"):(n.left=$(window).scrollLeft(),n.top=$(window).scrollTop(),n.innerLeft=t.$container.scrollLeft(),n.innerTop=t.$container.scrollTop()),n},getOriginalPosition:function(){var n=this;return{left:n.$container.offset().left>100?n.$container.offset().left:0,top:0,innerLeft:0,innerTop:0}},scrollToPosition:function(n){var t=this;t.savePosition||(t.savePosition=t.getScrollPosition());t.$viewer!==undefined&&t.$viewer.is(":visible")?t.$viewer.reportViewer("scrollReportTo",n):(n.left&&$(window).scrollLeft(n.left),n.top&&$(window).scrollTop(n.top),n.innerLeft&&t.$container.scrollLeft(n.innerLeft),n.innerTop&&t.$container.scrollTop(n.innerTop))},restoreScrollPosition:function(){var n=this;n.savePosition&&!n.scrollLock&&(n.$viewer!==undefined&&n.$viewer.is(":visible")?n.$viewer.reportViewer("scrollReportTo",n.savePosition):(n.$container.scrollLeft(n.savePosition.innerLeft),n.$container.scrollTop(n.savePosition.innerTop),$(window).scrollLeft(n.savePosition.left),$(window).scrollTop(n.savePosition.top)),n.savePosition=null)},hideAddressBar:function(n,t){var i=this,r=i.getOriginalPosition(),u=document.height<=window.outerHeight+10?50:0;n||(r.left=null);setTimeout(function(){i.scrollToPosition(r);typeof t=="function"&&t()},u)},restoreScroll:function(){var n=this;document.height<=window.outerHeight+10?setTimeout(function(){n.restoreScrollPosition()},50):setTimeout(function(){n.restoreScrollPosition()},0)},hideSlideoutPane:function(n){var t=this,o=n?"fr-layout-mainViewPortShiftedRight":"fr-layout-mainViewPortShiftedLeft",h=t.$mainviewport,r=n?t.$leftpane:t.$rightpane,s=t.$topdiv,u=Number(200),e,f;if(t._allowZoom(!0),r.is(":visible")){n?r.slideLeftHide(u*.5):r.slideRightHide(u*.5);s.removeClass(o,u);for(e in t.$mainheadersection.data())f=t.$mainheadersection.data()[e],f.widgetName&&t.$mainheadersection[f.widgetName]("showAllTools")}t.showModal!==!0&&(t.$pagesection.removeClass("fr-layout-pagesection-noscroll"),t.$container.removeClass("fr-layout-container-noscroll"));forerunner.device.isAndroid()&&!forerunner.device.isChrome()&&t.$pagesection.addClass("fr-layout-android");t.restoreScroll();t.$container.resize();t.$viewer!==undefined&&t.$viewer.is(":visible")&&(forerunner.device.isAllowZoom()||t.$viewer.reportViewer("allowSwipe",!0),t.$viewer.reportViewer("triggerEvent",i.hidePane,{isLeftPane:n}))},showSlideoutPane:function(n,t){var r=this,f,s,o;r._allowZoom(!1);r.$viewer!==undefined&&r.$viewer.is(":visible")&&r.$viewer.reportViewer("allowSwipe",!1);var h=t?"fr-layout-mainViewPortShiftedRight":"fr-layout-mainViewPortShiftedLeft",c=r.$mainviewport,u=t?r.$leftpane:r.$rightpane,l=r.$topdiv,e=Number(200);if(!u.is(":visible")){f=r.$linksection.is(":visible")?r.$linksection.outerHeight():0;u.css({height:Math.max($(window).height()-f,c.height())-f});t?(u.css({top:f}),u.slideLeftShow(e)):(u.css({top:f}),u.slideRightShow(e));l.addClass(h,e);for(s in r.$mainheadersection.data())o=r.$mainheadersection.data()[s],o.widgetName&&r.$mainheadersection[o.widgetName]("hideAllTools");r.$viewer!==undefined&&r.$viewer.is(":visible")&&r.$viewer.reportViewer("allowSwipe",!1)}r.hideAddressBar(t,function(){r.$container.addClass("fr-layout-container-noscroll");r.$pagesection.addClass("fr-layout-pagesection-noscroll");r.$container.resize()});r.$viewer!==undefined&&r.$viewer.is(":visible")&&r.$viewer.reportViewer("triggerEvent",i.showPane,{isLeftPane:t})},_isReportViewer:function(){var t=this,i;return n.hasWidget(t.$container,n.reportViewerEZ)&&(i=t.$container.find(".fr-report-areacontainer"),i.length===1)?!0:!1},setBackgroundLayout:function(){var n=this;if(n._isReportViewer()){var t=$(".fr-report-areacontainer",n.$container),i=n.$container.height(),r=n.$container.width(),u=n.$topdiv.outerHeight();t.height()>i-u||t.width()>r?$(".fr-render-bglayer",n.$container).css("position","absolute").css("height",Math.max(t.height(),i-u)).css("width",Math.max(t.width(),r)):$(".fr-render-bglayer",n.$container).css("position","absolute").css("height",i-u).css("width",r)}},cleanUp:function(){var n=this;n.hideSlideoutPane(!0);n.hideSlideoutPane(!1);n.$bottomdiv.hide();n.$bottomdivspacer.hide();n.$pagesection.show();n.$pagesection.removeClass("fr-layout-pagesection-noscroll");n.$container.removeClass("fr-layout-container-noscroll")},_selectedItemPath:null}});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr,i=forerunner.localize,t;n.DashboardModel=function(n){var t=this;t.options={$appContainer:null,reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager/",rsInstance:null};t.messages=i.getLocData().messages;n&&$.extend(this.options,n);t.clearState()};n.DashboardModel.prototype={clearState:function(){var n=this;n.dashboardDef={templateName:null,template:null,reports:{}}},fetch:function(n){var i=this,r=!1,u=i.options.reportManagerAPI+"/Resource";return forerunner.ajax.ajax({dataType:"json",url:u,data:{path:n,instance:i.options.rsInstance},async:!1,success:function(n){i.dashboardDef=n;r=!0},fail:function(n){console.log("_loadResource() - "+n.statusText);console.log(n);forerunner.dialog.showMessageBox(i.options.$appContainer,t.loadDashboardFailed,t.loadDashboard)}}),r},save:function(n,t,i){var u=this,r={status:!1,resourceName:null},f,e;return(n===null||n===undefined)&&(n=!1),f=JSON.stringify(u.dashboardDef),e=forerunner.config.forerunnerAPIBase()+"ReportManager/SaveResource",forerunner.ajax.ajax({type:"POST",url:e,data:{resourceName:i,parentFolder:t,overwrite:n,contents:f,mimetype:"json/forerunner-dashboard",rsInstance:u.options.rsInstance},dataType:"json",async:!1,success:function(n){n&&n.Exception?r=n:n&&n.ResourceName&&(r.resourceName=n.ResourceName,r.status=!0)},fail:function(n){r.responseJSON=n.responseJSON;console.log("ssr.DashboardModel.save() - "+n.statusText);console.log(n)}}),r},loadTemplate:function(n){var t=this,i=forerunner.localize;t.dashboardDef.template=forerunner.localize._getLocData(forerunner.config.forerunnerFolder()+"Dashboard/dashboards/"+n,"text")}}});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants.widgets,i=forerunner.ssr.constants.events,r=forerunner.helper,t=forerunner.localize;$.widget(n.getFullname(n.favoriteModel),{options:{$appContainer:null,isExplorer:null,$toolbar:null,$toolpane:null,rsInstance:null},_constant:{isFavoriteApi:forerunner.config.forerunnerAPIBase()+"ReportManager/isFavorite",updateFavStateApi:forerunner.config.forerunnerAPIBase()+"ReportManager/UpdateView",plusIcon:"fr-icons24x24-favorite-plus",minusIcon:"fr-icons24x24-favorite-minus"},_create:function(){},_init:function(){var n=this;n.options.isExplorer||n._getFavBtnAndItem();n._bindFavClick()},setFavoriteState:function(n){var t=this;t.path=n;t._getFavBtnAndItem();forerunner.ajax.ajax({url:t._constant.isFavoriteApi,data:{path:n,instance:t.options.rsInstance},dataType:"json",async:!0,success:function(n){t._switchFavIcon(n.IsFavorite)},fail:function(){t.$btnFav.hide();t.$itemFavorite.hide()}})},_getFavBtnAndItem:function(){var n=this;n.options.$toolbar&&(n.$btnFav=n.options.$toolbar.find(".fr-button-update-fav").find("div").first());n.options.$toolpane&&(n.$itemFav=n.options.$toolpane.find(".fr-item-update-fav").find("div").first())},_bindFavClick:function(){var n=this;n.options.$appContainer.off("toolbar-fav-click",n._updateFavState).off("toolpane-fav-click",n._updateFavState);n.options.$appContainer.on("toolbar-fav-click",{me:n},n._updateFavState);n.options.$appContainer.on("toolpane-fav-click",{me:n},n._updateFavState)},_updateFavState:function(n){var i=n.data.me,r="add",u=n.data.isToolpane?i.$itemFav:i.$btnFav;u.hasClass(i._constant.minusIcon)&&(r="delete");forerunner.ajax.getJSON(i._constant.updateFavStateApi,{view:"favorites",action:r,path:i.path,instance:i.options.rsInstance},function(){i._switchFavIcon(r==="add")},function(){forerunner.dialog.showMessageBox(i.options.$appContainer,t.getLocData().messages.favoriteFailed)})},_switchFavIcon:function(n){var t=this;n?(t.$btnFav.addClass(t._constant.minusIcon).removeClass(t._constant.plusIcon),t.$itemFav.addClass(t._constant.minusIcon).removeClass(t._constant.plusIcon)):(t.$btnFav.addClass(t._constant.plusIcon).removeClass(t._constant.minusIcon),t.$itemFav.addClass(t._constant.plusIcon).removeClass(t._constant.minusIcon))}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};forerunner.cache=forerunner.cache||{};$(function(){var r=forerunner.ssr.constants.widgets,i=forerunner.ssr.constants.events,t=forerunner.ssr.constants.properties,n=forerunner.localize;$.widget(r.getFullname(r.forerunnerProperties),{options:{$appContainer:null,$reportViewer:null,$reportExplorer:null,rsInstance:null},_init:function(){var t=this,r,u;t.guid=forerunner.helper.guidGen();t.element.html("");t.element.off(i.modalDialogGenericSubmit);t.element.off(i.modalDialogGenericCancel);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-tags",n.getLocData().properties.title,"fr-properties-cancel",n.getLocData().common.cancel);u=new $("<div class='fr-core-dialog-innerPage fr-core-center'>"+r+"<div class='fr-properties-container'><ul class='fr-properties-tabs'><\/ul><\/div><div class='fr-core-dialog-submit-container fr-properties-submit-container'><div class='fr-core-center'><input type='button' class='fr-properties-submit fr-core-dialog-submit fr-core-dialog-button' value='"+n.getLocData().properties.submit+"' /><\/div><\/div><\/div>");t.element.append(u);t.$tabs=t.element.find(".fr-properties-container");t.$tabsUL=t.$tabs.find(".fr-properties-tabs");t.element.find(".fr-properties-submit").on("click",function(){t._generalSubmit()});t.element.find(".fr-properties-cancel").on("click",function(){t.closeDialog()});t.element.on(i.modalDialogGenericSubmit,function(){t._generalSubmit()});t.element.on(i.modalDialogGenericCancel,function(){t.closeDialog()})},_create:function(){},openDialog:function(){var n=this;n.userUpdate=!1;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;n._trigger(i.close,null,{$forerunnerProperties:n.element,path:n.curPath,isUpdate:n.userUpdate});forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},getProperties:function(){var n=this;return{view:n.view,path:n.curPath,propertyList:n._propertyList}},setProperties:function(n,i,r){var u=this,o,e,f;if(u.view=n,u.property=forerunner.cache.itemProperty[i],u.$tabs.find("div").remove(),u.$tabsUL.find("li").remove(),u._preprocess=null,i){u.curPath=i;u._propertyList=r;for(o in u.$tabs.data())e=u.$tabs.data()[o],e.widgetName&&u.$tabs[e.widgetName]("destroy");for(f=0;f<u._propertyList.length;f++)switch(u._propertyList[f]){case t.description:u._createDescription();u._addPreprocess(function(){u._propertiesPreloading()});break;case t.rdlExtension:u._createRDLExtension();u._addPreprocess(function(){u._RDLExtensionPreloading()});break;case t.tags:u._createTags();u._addPreprocess(function(){u._tagsPreloading()});break;case t.searchFolder:u._createSearchFolder();u._addPreprocess(function(){u._searchFolderPreloading()})}u.element.find(".fr-properties-form").on("submit",function(){return!1});u.element.find(".fr-property-input").on("keyup",function(n){n.keyCode===13&&n.stopImmediatePropagation()});u.$tabs.tabs();typeof u._preprocess=="function"&&(u._preprocess.call(u),u._preprocess=null)}},_createDescription:function(){var i=this,u=new $("<li name='"+t.description+"'><a href='#"+i.guid+"_description'>"+n.getLocData().properties.title+"<\/a><\/li>"),r=new $("<div id='"+i.guid+"_description' class='fr-property-container fr-description-container'><form class='fr-properties-form fr-property-form'><div class='fr-name-div'><label class='fr-name-label'>"+n.getLocData().common.name+"<\/label><span class='fr-readonly-span'>"+n.getLocData().properties.readonly+"<\/span><input type='text' class='fr-core-input fr-property-input fr-name-text fr-property-name' name='Name' required='true'><span class='fr-error-span' /><\/div><div><label class='fr-description-label'>"+n.getLocData().properties.description+"<\/label><textarea class='fr-core-input fr-property-input fr-description-id fr-description-text' rows='5' name='Description' /><div><div class='fr-visibility-container'><label class='fr-visibility-label'><input type='checkbox' name='visibility' class='fr-property-visibility'>"+n.getLocData().visibility.label+"<\/label><\/div><\/form><\/div>");i.$desInput=r.find(".fr-description-text");i.$isHidden=r.find(".fr-property-visibility");i.$itemName=r.find(".fr-name-text");i.$propertyForm=r.find(".fr-property-form");i.view!=="contextmenu"&&(i.$itemName.addClass("fr-name-readonly").attr("disabled",!0),r.find(".fr-readonly-span").show());i.$propertyForm.validate({errorPlacement:function(n,t){n.appendTo(t.siblings("span"))},highlight:function(n){$(n).addClass("fr-error")},unhighlight:function(n){$(n).removeClass("fr-error")}});i.$tabsUL.append(u);i.$tabs.append(r)},_createRDLExtension:function(){var i=this,u=new $("<li name='"+t.rdlExtension+"'><a href='#"+i.guid+"_RDL'>"+n.getLocData().RDLExt.title+"<\/a><\/li>"),r=new $("<div id='"+i.guid+"_RDL'  class='fr-property-container fr-rdl-container'><label class='fr-rdl-label'>"+n.getLocData().RDLExt.dialogTitle+"<\/label><textarea rows='5' class='fr-core-input fr-property-input fr-rdl-id fr-rdl-text' name='RDL' /><\/div>");i.$rdlInput=r.find(".fr-rdl-text");i.$tabsUL.append(u);i.$tabs.append(r)},_createTags:function(){var i=this,u=new $("<li name='"+t.tags+"'><a href='#"+i.guid+"_tags'>"+n.getLocData().tags.tags+"<\/a><\/li>"),r=new $("<div id='"+i.guid+"_tags'  class='fr-property-container fr-tag-container'><div class='fr-tag-input-div'><label class='fr-tag-label'>"+n.getLocData().tags.tags+"<\/label><textarea class='fr-core-input fr-property-input fr-tag-text' rows='5' name='tags' /><\/div><div class='fr-tag-prompt-div'><label class='fr-tag-label-prompt'>"+n.getLocData().tags.prompt+"<\/label><\/div><\/div>");i.$tagInput=r.find(".fr-tag-text");i.$tabsUL.append(u);i.$tabs.append(r)},_createSearchFolder:function(){var i=this,u=new $("<li name='"+t.searchFolder+"'><a href='#"+i.guid+"_searchfolder'>"+n.getLocData().searchFolder.title+"<\/a><\/li>"),r=new $("<div id='"+i.guid+"_searchfolder' class='fr-property-container fr-sf-container'><form class='fr-properties-form fr-sf-form'><table class='fr-sf-table'><tr><td><label class='fr-sf-label'>"+n.getLocData().searchFolder.tags+":<\/label><\/td><td><input type='text' class='fr-core-input fr-property-input fr-sf-text fr-sf-foldertags' name='tags' required='true' /><span class='fr-error-span' /><\/td><\/tr><tr class='fr-sf-prompt'><td><\/td><td><label class='fr-sf-label-prompt'>"+n.getLocData().searchFolder.prompt+"<\/label><\/td><tr><\/table><\/form><\/div>");i.$sfForm=r.find(".fr-sf-form");i.$sfForm.validate({errorPlacement:function(n,t){n.appendTo(t.siblings("span"))},highlight:function(n){$(n).addClass("fr-error")},unhighlight:function(n){$(n).removeClass("fr-error")}});i.$tabsUL.append(u);i.$tabs.append(r)},_generalSubmit:function(){var n=this,r=n.$tabsUL.find(".ui-state-active").attr("name"),i=!0;switch(r){case t.description:i=n._setProperties();break;case t.rdlExtension:n._setRDLExtension();break;case t.tags:n._saveTags();break;case t.searchFolder:i=n._setSearchFolder()}i===!0&&n.closeDialog()},_preprocess:null,_addPreprocess:function(n){if(typeof n=="function"){var t=this,i=t._preprocess;t._preprocess=i===null?n:function(){i();n()}}},_tagsPreloading:function(){var n=this;n._getTags(n.curPath)},_getTags:function(n){var t=this;t.path!==n&&(t._tags="",t.path=null,forerunner.ajax.ajax({type:"GET",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/GetReportTags",async:!0,data:{path:n,instance:t.options.rsInstance},success:function(i){t.path=n;i.Tags&&i.Tags!=="NotFound"&&(t._tags=i.Tags.join(","),t._tags=t._tags.replace(/"/g,""),t.$tagInput.val(t._tags))},fail:function(){}}))},_saveTags:function(){var t=this,i=$.trim(t.$tagInput.val()),r,u;if(i!==""&&i!==t._tags){for(r=i.split(","),u=0;u<r.length;u++)r[u]='"'+$.trim(r[u])+'"';i=r.join(",");t._tags=i;forerunner.ajax.ajax({type:"POST",dataType:"text",async:!0,url:forerunner.config.forerunnerAPIBase()+"ReportManager/SaveReportTags/",data:{reportTags:i,path:t.path,instance:t.options.rsInstance},success:function(){},fail:function(){t._tags=null;forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().messages.addTagsFailed,n.getLocData().toolPane.tags)}})}},_propertiesPreloading:function(){var n=this;n._description="";n._isHidden="False";n._getProperties(n.curPath,function(n){var t=this;typeof n=="string"&&n.toLowerCase()==="true"&&(t._isHidden="True",t.$isHidden.attr("checked",!0));typeof n=="object"&&n.Hidden&&n.Hidden.toLowerCase()==="true"&&(t._isHidden="True",t.$isHidden.attr("checked",!0));typeof n=="object"&&(t._description=n.Description||"",t.$desInput.val(t._description),t._itemName=n.Name,t.$itemName.val(t._itemName))},n)},_setProperties:function(){var t=this;if(t.$propertyForm.valid()===!1)return!1;try{var e=$.trim(t.$desInput.val()),o=t.$isHidden[0].checked?"True":"False",s=$.trim(t.$itemName.val()),r=t.curPath,f=null,u=[];e!==t._description&&u.push({name:"Description",value:e});o!==t._isHidden&&u.push({name:"Hidden",value:o});s!==t._itemName&&(f=forerunner.helper.getParentPath(r)+"/"+s,u.push({name:"Name",value:f}));u.length&&(t.userUpdate=!0,forerunner.ajax.ajax({type:"POST",dataType:"text",url:forerunner.config.forerunnerAPIBase()+"ReportManager/SaveReportProperty/",data:{path:t.curPath,properties:JSON.stringify(u),instance:t.options.rsInstance},success:function(u){if(u=JSON.parse(u),u.Exception){t._description="";t._isHidden="False";t._itemName="";forerunner.dialog.showMessageBox(t.options.$appContainer,u.Exception.Message,n.getLocData().properties.title);return}f?(t.curPath=f,t.options.$appContainer.trigger(i.renameItem,{newPath:t.curPath}),delete forerunner.cache.itemProperty[r]):(forerunner.cache.itemProperty[r].Hidden=o,forerunner.cache.itemProperty[r].Name=s,forerunner.cache.itemProperty[r].Description=e);t.closeDialog()},fail:function(){t._description="";t._isHidden="False";t._itemName="";forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().messages.addTagsFailed,n.getLocData().properties.title)}}))}catch(h){return forerunner.dialog.showMessageBox(t.options.$appContainer,h.message,"Error Saving"),!1}return!0},_RDLExtensionPreloading:function(){var n=this;n._rdl="";n._getProperties(n.curPath,function(n){var t=this;typeof n=="object"&&n.ForerunnerRDLExt&&(t._rdl=JSON.stringify(n.ForerunnerRDLExt),t.$rdlInput.val(t._rdl))},n)},_setRDLExtension:function(){var n=this,t=n.$rdlInput.val(),r=n.curPath,u;t!==n._rdl&&(u=[{name:"ForerunnerRDLExt",value:t}],forerunner.ajax.ajax({type:"POST",dataType:"text",async:!0,url:forerunner.config.forerunnerAPIBase()+"ReportManager/SaveReportProperty/",data:{path:n.curPath,properties:JSON.stringify(u),instance:n.options.rsInstance},success:function(){n._rdl=t;forerunner.cache.itemProperty[r].ForerunnerRDLExt=forerunner.helper.JSONParse(t);n.property=forerunner.cache.itemProperty[r];n.options.$appContainer.trigger(i.saveRDLDone,{newRDL:t})},fail:function(){n._rdl=""}}))},_searchFolder:null,_searchFolderPreloading:function(){var n=this,t=n._getSearchFolder()},_getSearchFolder:function(){var n=this,t=forerunner.config.forerunnerAPIBase()+"ReportManager/Resource";return forerunner.ajax.ajax({url:t,type:"GET",dataType:"text",data:{path:n.curPath,instance:n.options.rsInstance},success:function(t){n._searchFolder=t;n._searchFolder?(n._searchFolder=JSON.parse(n._searchFolder),n.$sfForm.find(".fr-sf-foldertags").val(n._searchFolder.tags.replace(/"/g,""))):n.$sfForm.find(".fr-sf-foldertags").val("")},error:function(){}}),n._searchFolder},_setSearchFolder:function(){var n=this,t,i,u;if(n.$sfForm.valid()){var f=$.trim(n._itemName),r=$.trim(n.$sfForm.find(".fr-sf-foldertags").val()),e=forerunner.helper.JSONParse(n._searchFolder);if(r!==e.tags){for(t=r.split(","),i=0;i<t.length;i++)t[i]='"'+$.trim(t[i])+'"';u={searchFolderName:f,overwrite:!0,content:{tags:t.join(",")}};n.options.$reportExplorer.reportExplorer("setSearchFolder",u)}return!0}return!1},_getProperties:function(n,t,i){var r=this,u;if(r.property){typeof t=="function"&&t.call(i||r,r.property);return}u=function(){r._locked?setTimeout(u,5):t.call(i||r,r.property)};r._locked?u():(r._locked=!0,forerunner.ajax.ajax({type:"GET",dataType:"text",url:forerunner.config.forerunnerAPIBase()+"ReportManager/ReportProperty",data:{path:n,propertyName:"Hidden,Description,ForerunnerRDLExt,Name",instance:r.options.rsInstance},success:function(u){try{r.property=forerunner.cache.itemProperty[n]=JSON.parse(u)}catch(f){r.property=forerunner.cache.itemProperty[n]=u}r._locked=!1;typeof t=="function"&&t.call(i||r,r.property);return},fail:function(){r._locked=!1}}))}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,r=forerunner.ssr.constants.properties,n=forerunner.localize;$.widget(i.getFullname(i.forerunnerSecurity),{options:{$appContainer:null,$reportExplorer:null,rsInstance:null},_create:function(){},_init:function(){var i=this,r,u;i.guid=forerunner.helper.guidGen();i.curPath=null;i.element.html("");i.element.off(t.modalDialogGenericCancel);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-security",n.getLocData().security.title,"fr-security-cancel",n.getLocData().common.cancel);u=new $("<div class='fr-core-dialog-innerPage fr-core-center'>"+r+"<div class='fr-security-path'><span class='fr-security-curPath'><\/span><\/div><div class='fr-security-container'><div class='fr-security-layer layer-1'><ul class='fr-security-list'><\/ul><\/div><div class='fr-security-layer layer-2'><div class='header'><span class='fr-security-label'>"+n.getLocData().security.groupuser+"<\/span><input type='text' class='fr-core-input fr-security-input fr-security-groupuser'><\/div><div class='prompt'>"+n.getLocData().security.prompt+"<\/div><ul class='fr-security-list'><\/ul><\/div><\/div><div class='fr-core-dialog-submit-container fr-security-submit-container'><div class='fr-core-center'><div class='operate-0'><input type='button' class='fr-security-edit fr-core-dialog-button' value='"+n.getLocData().security.editSecurity+"' /><\/div><div class='operate-1'><input type='button' class='fr-security-new fr-security-btn fr-core-dialog-button' value='"+n.getLocData().security.newPolicy+"' /><input type='button' class='fr-security-revert fr-security-btn fr-core-dialog-button' value='"+n.getLocData().security.revert+"' /><\/div><div class='operate-2'><input type='button' class='fr-security-submit fr-security-btn fr-core-dialog-button' value='"+n.getLocData().common.submit+"' /><input type='button' class='fr-security-cancel fr-security-btn fr-core-dialog-button' value='"+n.getLocData().common.cancel+"' /><\/div><\/div><\/div><\/div>");i.element.append(u);i.$layer1=i.element.find(".layer-1");i.$layer2=i.element.find(".layer-2");i.$groupuser=i.$layer2.find(".fr-security-groupuser");i.$operate0=i.element.find(".operate-0");i.$operate1=i.element.find(".operate-1");i.$operate2=i.element.find(".operate-2");i.$revert=i.$operate1.find(".fr-security-revert");i.$curPath=i.element.find(".fr-security-curPath");i.element.on(t.modalDialogGenericCancel,function(){i._clickCancel()});i._bindEvents()},_bindEvents:function(){var t=this;t.curLayer=1;t.element.find(".fr-security-new").on("click",function(){t._switchToLayer2("new")});t.$revert.on("click",function(){if(t.isInheritParent||t.isRoot)t.closeDialog();else{if(!confirm(n.getLocData().security.revertConfirm.format(t.parentName)))return;t._inheritParentPolicy()}});t.$operate0.on("click",function(){confirm(n.getLocData().security.editConfirm.format(t.parentName))&&t._breakInherit()});t.element.find(".fr-security-submit").on("click",function(){t._submit(function(){t._clickCancel()})});t.element.find(".fr-security-cancel").on("click",function(){if($(this).hasClass("fr-core-dialog-cancel")){if(t.isInheritParent){t.closeDialog();return}t.$layer2.hide();t.$operate2.hide();t.$layer1.show();t.$operate1.show();t.closeDialog();return}t._clickCancel()});t.$layer1.delegate(".tip","click",function(){$(this).closest("li").find(".role").toggle()});t.$layer1.delegate(".edit","click",function(){var n=$(this).siblings("span").text();t._switchToLayer2("edit",n)});t.$layer1.delegate(".delete","click",function(){if(confirm(n.getLocData().security.deleteConfirm)){var i=$(this).siblings("span").text();t._deletePolicy(i)}});t.$layer2.delegate(".tip","click",function(){$(this).closest("li").find(".desp").toggle()});t.$layer2.delegate(".acc-name","click",function(){$(this).closest("li").find(".acc-chk").trigger("click")})},setData:function(n,t){var i=this;i.curPath!==n&&(i.curPath=n,i.curType=t,i.parentName=i._getParentName(n),i.cachedRoles=null,i.cachedPolicy=null,i.$curPath.text(i._getItemName(n)),i.isRoot=i.curPath==="/"?!0:!1)},openDialog:function(){var n=this;n.cachedPolicy&&n.cachedRoles||n._refreshUI();forerunner.dialog.dialogLock=!0;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.dialogLock=!1;n._trigger(t.close,null,{$forerunnerSecurity:n.element,path:n.curPath});forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},getCurPolicy:function(){var n=this;return{path:n.curPath,policy:n.cachedPolicy,roles:n.cachedRoles,isInheritParent:n.isInheritParent}},setCurPolicy:function(n){var t=this;t.curPath=n.path;t.cachedRoles=n.roles;t.cachedPolicy=n.policy;t.isInheritParent=n.isInheritParent;t.isRoot=t.curPath==="/"?!0:!1;t._refreshUI()},_switchToLayer2:function(n,t){var i=this,o=n==="new"?!0:!1,f,s,r,u,e;if(i.curLayer=2,!o){for(f={},s=i.$layer2.find(".acc-chk"),r=0;r<i.cachedPolicy.length;r++)if(i.cachedPolicy[r].GroupUserName===t){for(u=0;u<i.cachedPolicy[r].Roles.length;u++)f[i.cachedPolicy[r].Roles[u].Name]=!0;break}for(r=0;r<i.cachedRoles.length;r++)e=i.cachedRoles[r].Name,f[e]&&s.filter("[data-acc='"+e+"']").trigger("click")}i.$layer1.hide(function(){i.$operate1.hide();o||i.$groupuser.val(t).attr("title",t).attr("readonly",!0);i.$layer2.show().scrollTop(0);i.$operate2.show()})},_clickCancel:function(){var n=this;n.curLayer===2?(n.curLayer=1,n.$layer2.hide(function(){for(var i=n.$layer2.find(".acc-chk"),t=0;t<i.length;t++)i[t].checked&&(i[t].checked=!1);n.$operate2.hide();n.$groupuser.val("").removeAttr("title").removeAttr("readonly");n.$layer1.show();n.$operate1.show()})):n.closeDialog()},_refreshUI:function(){var n=this,t;n.cachedPolicy||n._getPolicy();t=n._drawPolicyUI(n.cachedPolicy);n.$layer1.children("ul").html("").append(t);n.isInheritParent?(n.$operate0.show(),n.$operate1.hide(),n.$operate2.hide()):(n.$operate0.hide(),n.$operate1.show(),n.$operate2.hide(),n.$layer1.find(".funcBtn").show(),n.isRoot?n.$revert.hide():n.$revert.show());setTimeout(function(){n.cachedRoles||n._getRoles();var t=n._drawRoleUI(n.cachedRoles);n.$layer2.children("ul").html("").append(t)},0)},_submit:function(n){var t=this,i=t._generatePostData();i&&t._setPolicy(i,n)},_generatePostData:function(){var t=this,i,r=[],u=t.$groupuser.val();if($.trim(u)==="")return forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().security.accountMsg),null;if($.each(t.$layer2.find(".acc-chk"),function(n,t){t.checked&&r.push({Name:t.getAttribute("data-acc")})}),r.length===0)return forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().security.roleEmptyMsg),null;for(t.tempCachedPolicy=t.cachedPolicy.slice(0),i=0;i<t.tempCachedPolicy.length;i++)if(t.tempCachedPolicy[i].GroupUserName===u){t.tempCachedPolicy[i].Roles=r;break}return i===t.tempCachedPolicy.length&&t.tempCachedPolicy.push({GroupUserName:u,Roles:r}),JSON.stringify(t.tempCachedPolicy)},_getRoles:function(){var n=this;forerunner.ajax.ajax({type:"GET",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/ListRoles",async:!1,data:{type:n.curType,itemPath:n.curPath,instance:n.options.rsInstance},success:function(t){if(t.Exception){n.cachedRoles=null;return}n.cachedRoles=t},fail:function(){n.curPath=null}})},_getPolicy:function(){var n=this;forerunner.ajax.ajax({type:"GET",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/GetItemPolicies",async:!1,data:{itemPath:n.curPath,instance:n.options.rsInstance},success:function(t){if(t.Exception){n.cachedPolicy=null;return}n.isInheritParent=t.isInheritParent;n.cachedPolicy=t.policyArr},fail:function(){n.curPath=null}})},_setPolicy:function(n,t){var i=this;forerunner.ajax.ajax({type:"POST",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/SetItemPolicies",async:!0,data:{itemPath:i.curPath,policies:n,instance:i.options.rsInstance},success:function(n){if(n.Exception){forerunner.dialog.showMessageBox(i.options.$appContainer,n.Exception.Message);console.log("update item policy wrong",n.Exception);return}i.cachedPolicy=i.tempCachedPolicy||i.cachedPolicy;i.tempCachedPolicy=null;i.isInheritParent=!1;i._refreshUI();t&&typeof t=="function"&&t()},fail:function(){i.tempCachedPolicy=null}})},_inheritParentPolicy:function(){var n=this;forerunner.ajax.ajax({type:"POST",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/InheritParentSecurity",async:!0,data:{itemPath:n.curPath,instance:n.options.rsInstance},success:function(t){if(t.Exception){forerunner.dialog.showMessageBox(n.options.$appContainer,t.Exception.Message);console.log("inherit parent policy wrong",t.Exception);return}n.cachedPolicy=null;n.isInheritParent=!0;n._refreshUI()},fail:function(){}})},_breakInherit:function(){var n=this,t=n.cachedPolicy;n.cachedPolicy=null;n._setPolicy(JSON.stringify(t))},_deletePolicy:function(n){for(var t=this,r=0,i=0;i<t.cachedPolicy.length;i++)if(t.cachedPolicy[i].GroupUserName===n){r=i;break}t.cachedPolicy.splice(r,1);t._setPolicy(JSON.stringify(t.cachedPolicy))},_drawPolicyUI:function(t){for(var u,r,f=[],e,i=0,o=t.length;i<o;i++){for(u=[],r=0;r<t[i].Roles.length;r++)u.push(t[i].Roles[r].Name);e="<li><div class='acc'><span>"+t[i].GroupUserName+"<\/span><a href='javascript:void(0);' class='tip' title='"+n.getLocData().security.detail+"'>...<\/a><a href='javascript:void(0);' class='funcBtn delete'>"+n.getLocData().common.deleteBtn+"<\/a><a href='javascript:void(0);' class='funcBtn edit'>"+n.getLocData().common.edit+"<\/a><\/div><div class='role'><span class='tit'>"+n.getLocData().security.roles+":&nbsp;<\/span><span class='txt'>"+u.join(", ")+"<\/span><\/div><\/li>";f.push(e)}return f.join("")},_drawRoleUI:function(t){for(var r=[],u,i=0,f=t.length;i<f;i++)u="<li><div class='role-name'><span class='chk'><input class='acc-chk' type='checkbox' data-acc='"+t[i].Name+"' /><\/span><span class='acc-name'>"+t[i].Name+"<\/span><a href='javascript:void(0);' class='tip' title="+n.getLocData().security.desp+">...<\/a><\/div><div class='desp'><span class='tit'>"+n.getLocData().security.desp+":&nbsp;<\/span><span class='txt'>"+t[i].Description+"<\/span><\/div><\/li>",r.push(u);return r.join("")},_getParentName:function(n){var t=forerunner.helper.getParentPath(n);return t===null?"/":t},_getItemName:function(t){return forerunner.helper.getCurrentItemName(t,n.getLocData().security.home)}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants.widgets,r=forerunner.ssr.constants.events,u=forerunner.helper,i=forerunner.localize,n=forerunner.ssr.constants.properties,f={1:[n.description,n.tags,n.visibility],2:[n.description,n.tags,n.rdlExtension,n.visibility],3:[n.description,n.tags,n.visibility],4:[n.description,n.tags,n.rdlExtension],searchFolder:[n.searchFolder,n.description,n.visibility]};$.widget(t.getFullname(t.contextMenuBase),{options:{$reportExplorer:null,$appContainer:null,reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager/",rsInstance:null,catalogItem:null},setPermissionsList:function(n){var t=this;t.permissionList=n},_getPermissionsList:function(){var n=this;return n.permissionList?n.permissionList:["Delete","Update Properties","Update Security Policies","Create Link","Create Resource"]},fetchPermissions:function(){var n=this,t=n._getPermissionsList();n.permissions=forerunner.ajax.hasPermission(n.options.catalogItem.Path,t.join(","))},setTitle:function(n){var t=this;t._title=n},_init:function(){var n=this,t;n.contextMenu=i.getLocData().contextMenu;n._title&&n._$title.text(n._title);t=500;setTimeout(function(){var i,r;if(forerunner.device.isTouch()){i=function(){setTimeout(function(){n.closeMenu()},t)};$(document).off("touchend",i);$(document).one("touchend",i)}else{r=function(){n.closeMenu()};$(document).off("mouseup",r);$(document).one("mouseup",r)}},t)},addHeader:function(n){var t=this,i;return n&&(t._title=n),i=$("<tr><td class='fr-ctx-header'><div class='fr-ctx-title'><\/div><\/td><\/tr>"),t._$table.append(i),t._$title=t.element.find(".fr-ctx-title"),i},addMenuItem:function(n,t){var r=this,i=$("<tr><td class='"+n+" fr-ctx-delete-id fr-ctx-container'><div class='fr-ctx-state fr-core-cursorpointer'><div class='fr-ctx-delete-id fr-ctx-item-text'>"+t+"<\/div><\/div><\/td><\/tr>");return r._$table.append(i),i},_create:function(){var n=this;n.element.html("");n._$table=$("<table class='fr-ctx-table'><\/table>");n.element.append(n._$table)},openMenu:function(n,t){var i=this,r=+n,u=+t;i.element.css({left:r+"px",top:u+"px",position:"absolute"});i.element.show()},closeMenu:function(){var n=this;n.element.hide()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,r=forerunner.helper,n=forerunner.localize;$.widget(i.getFullname(i.dialogBase),{options:{iconClass:"fr-icons24x24-setup",$appContainer:null,reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager/",loadDelay:500,rsInstance:null},_init:function(){var i=this;i.options.title||(i.options.title=n.getLocData().dialogBase.title);i.options.actionWord||(i.options.actionWord=n.getLocData().dialogBase.submit);i.options.cancelWord||(i.options.cancelWord=n.getLocData().dialogBase.cancel);i._render();i.$loadingIndicator=i.element.find(".fr-dlb-loading-indicator");i.$loadingIndicator.length===0&&(i.$loadingIndicator=$("<div class='fr-dlb-loading-indicator' ><\/div>").text(n.getLocData().messages.loading),i.element.append(i.$loadingIndicator));i._hideSubmitError();i.element.off(t.modalDialogGenericSubmit);i.element.off(t.modalDialogGenericCancel)},_create:function(){},_render:function(){var n=this,i,r;n.loadLock=0;n.element.html("");i=forerunner.dialog.getModalDialogHeaderHtml(n.options.iconClass,n.options.title,"fr-dlb-cancel-id",n.options.cancelWord);r=$("<div class='fr-core-dialog-innerPage fr-core-center'>"+i+"<form class='fr-dlb-form fr-core-dialog-form'><div class=fr-dlb-form-main-id><\/div><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input type='button' class='fr-dlb-submit-id fr-core-dialog-submit fr-core-dialog-button' value='"+n.options.actionWord+"' /><\/div><div class='fr-dlb-submit-error fr-dlb-error fr-dlb-error-span error' /><\/div><\/form><\/div>");n.element.append(r);n.$form=n.element.find(".fr-dlb-form");n.$formMain=n.element.find(".fr-dlb-form-main-id");n.$cancel=n.element.find(".fr-dlb-cancel-id");n.$cancel.on("click",function(){n.closeDialog()});n.$submitError=n.element.find(".fr-dlb-submit-error");n.$submit=n.element.find(".fr-dlb-submit-id");n.$submit.on("click",function(){n._submit()});n.element.on(t.modalDialogGenericSubmit,function(){n._submit()});n.element.on(t.modalDialogGenericCancel,function(){n.closeDialog()})},_showSubmitError:function(n){var t=this;t.$submitError.show();t.$submitError.html(n)},_hideSubmitError:function(){var n=this;n.$submitError.hide()},_showExceptionError:function(t){var r=this,u=n.getLocData().errorTag,i;if(r.$submitError.html(""),t.Exception.Type==="LicenseException")r.$submitError.append($("<div class='Page' ><div class='fr-render-error-license Page'><div class='fr-render-error-license-container'><p class='fr-render-error-license-title'><\/p><br/><p class='fr-render-error-license-content'><\/p><\/div><\/div>")),i=r.$submitError.find(".fr-render-error-license-title"),i.html(u.licenseErrorTitle),i=r.$submitError.find(".fr-render-error-license-content"),i.html(u.licenseErrorContent);else{r.$submitError.append($("<div class='Page' ><div class='fr-render-error-message'><\/div><\/br><div class='fr-render-error-details'>"+u.moreDetail+"<\/div><div class='fr-render-error'><h3>"+u.serverError+"<\/h3><div class='fr-render-error fr-render-error-DetailMessage'><\/div><div class='fr-render-error fr-render-error-type'><\/div><div class='fr-render-error fr-render-error-targetsite'><\/div><div class='fr-render-error fr-render-error-source'><\/div><div class='fr-render-error fr-render-error-stacktrace'><\/div><\/div><\/div>"));i=r.$submitError.find(".fr-render-error");i.hide();i=r.$submitError.find(".fr-render-error-details");i.on("click",{$Detail:r.$submitError.find(".fr-render-error")},function(n){n.data.$Detail.toggle()});i=r.$submitError.find(".fr-render-error-DetailMessage");i.append("<h4>"+u.message+":<\/h4>"+t.Exception.DetailMessage);i=r.$submitError.find(".fr-render-error-type");i.append("<h4>"+u.type+":<\/h4>"+t.Exception.Type);i=r.$submitError.find(".fr-render-error-targetsite");i.html("<h4>"+u.targetSite+":<\/h4>"+t.Exception.TargetSite);i=r.$submitError.find(".fr-render-error-source");i.html("<h4>"+u.source+":<\/h4>"+t.Exception.Source);i=r.$submitError.find(".fr-render-error-message");i.html(t.Exception.Message);i=r.$submitError.find(".fr-render-error-stacktrace");i.html("<h4>"+u.stackTrace+":<\/h4>"+t.Exception.StackTrace)}r.$submitError.show()},showLoadingIndictator:function(){var n=this;n.loadLock===0&&(n.loadLock=1,setTimeout(function(){n._showLoadingIndictator()},n.options.loadDelay))},_showLoadingIndictator:function(){var n=this,t;n.loadLock===1&&(t=n.element.width()-212,n.$loadingIndicator.css({top:n.element.scrollTop()+100+"px",left:(t>0?t/2:0)+"px"}),n.element.mask(),n.$loadingIndicator.show())},removeLoadingIndicator:function(){var n=this;n.loadLock=0;n.element.unmask();n.$loadingIndicator.hide()},_submit:function(){var n=this;n.$form.valid()&&n.closeDialog()},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n);n._visibleCheck()},_visibleCheck:function(){var n=this;n.$formMain.is(":visible")?n.onDialogVisible():setTimeout(function(){n._visibleCheck.call(n)},50)},onDialogVisible:function(){var n=this;n.$submitError.width(n.$formMain.width())},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},_validateForm:function(n){n.validate({errorPlacement:function(n,t){n.appendTo($(t).parent().find("span"))},highlight:function(n){$(n).parent().find("span").addClass("fr-dlb-error-position");$(n).addClass("fr-dlb-error")},unhighlight:function(n){$(n).parent().find("span").removeClass("fr-dlb-error-position");$(n).removeClass("fr-dlb-error")}})},_resetValidateMessage:function(){var i=this,t=n.getLocData().validateError;jQuery.extend(jQuery.validator.messages,{required:t.required,number:t.number,digits:t.digits})}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.tools=forerunner.ssr.tools||{};forerunner.ssr.tools.toolbar=forerunner.ssr.tools.toolbar||{};forerunner.ssr.tools.groups=forerunner.ssr.tools.groups||{};$(function(){var r=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,n=forerunner.ssr.tools.toolbar,i=forerunner.ssr.tools.groups,u=forerunner.localize;$.widget(r.getFullname(r.toolbar),$.forerunner.toolBase,{options:{$reportViewer:null,dbConfig:{},toolClass:"fr-toolbar"},_initCallbacks:function(){var i=this;i.options.$reportViewer.on(t.reportViewerSetPageDone(),function(t,r){if(r.renderError===!0)i.enableTools([n.btnMenu,n.btnRefresh]),i._clearBtnStates();else{i.windowResize();$("input.fr-toolbar-reportpage-textbox",i.element).val(r.newPageNum);var f=i.options.$reportViewer.reportViewer("getNumPages");i.enableTools(i._viewerButtons(!1));i._updateBtnStates(r.newPageNum,f);r.paramLoaded&&r.numOfVisibleParameters===0&&i.disableTools([n.btnParamarea]);r.credentialRequired===!1&&i.disableTools([n.btnCredential]);i.element.find(".fr-toolbar-keyword-textbox").watermark(u.getLocData().toolbar.search,forerunner.config.getWatermarkConfig())}});i.options.$reportViewer.on(t.reportViewerShowParamArea(),function(){i.enableTools([n.btnParamarea]);i.removeHideDisable([n.btnParamarea])});i.options.$reportViewer.on(t.reportViewerShowDocMap(),function(){i.disableAllTools();i.enableTools([n.btnDocumentMap,n.btnMenu,n.btnReportBack])});i.options.$reportViewer.on(t.reportViewerHideDocMap(),function(){i.enableAllTools()});i.options.$reportViewer.on(t.reportViewerShowNav(),function(t,r){if(r.open)i.disableAllTools(),i.enableTools([n.btnNav,n.btnMenu]),i.freezeEnableDisable(!0);else{i.freezeEnableDisable(!1);i.enableAllTools();var u=i.options.$reportViewer.reportViewer("getNumPages");i._updateBtnStates(r.newPageNum,u)}});i.options.$reportViewer.on(t.reportViewerDrillThrough(),function(){i._leaveCurReport();i._checkSubscription()});i.options.$reportViewer.on(t.reportViewerPreLoadReport(),function(){i._leaveCurReport()});i.options.$reportViewer.on(t.reportViewerAfterLoadReport(),function(){i._checkSubscription()});i.options.$reportViewer.on(t.reportViewerChangeReport(),function(t,r){i._leaveCurReport();r.credentialRequired===!0&&i.enableTools([n.btnCredential]);i._checkSubscription()});i.options.$reportViewer.on(t.reportViewerFindDone(),function(){forerunner.device.isTouch()&&i.element.find(".fr-toolbar-keyword-textbox").trigger("blur")});i.options.$reportViewer.on(t.reportViewerShowCredential(),function(){i.enableTools([n.btnMenu,n.btnCredential]);i.removeHideDisable([n.btnCredential])});i.options.$reportViewer.on(t.reportViewerResetCredential(),function(t,r){i._clearBtnStates();i.disableTools(i._viewerButtons());r.paramLoaded===!1&&i.disableTools([n.btnParamarea]);i.enableTools([n.btnMenu,n.btnReportBack,n.btnCredential])});i.options.$reportViewer.on(t.reportViewerRefresh(),function(){i._clearBtnStates()})},_init:function(){var t=this;t._super();t.element.html("<div class='"+t.options.toolClass+" fr-core-toolbar fr-core-widget'/>");t.addTools(1,!1,t._viewerButtons());t.options.dbConfig&&t.options.dbConfig.UseMobilizerDB===!0&&!t.options.$reportViewer.reportViewer("showSubscriptionUI")&&t.hideTool(n.btnEmailSubscription.selectorClass);t.addTools(1,!1,[n.btnParamarea]);t.enableTools([n.btnMenu]);t.options.$reportViewer&&t._initCallbacks();t.windowResize()},_viewerButtons:function(t){var u=this,r=[n.btnMenu];return(t===!0||t===undefined)&&r.push(n.btnReportBack),r.push(n.btnCredential,n.btnNav,n.btnRefresh,n.btnDocumentMap,i.btnExportDropdown,i.btnVCRGroup,i.btnFindGroup),r.push(n.btnPrint),u.options.dbConfig&&u.options.dbConfig.UseMobilizerDB===!0&&r.push(n.btnEmailSubscription),r},_updateBtnStates:function(t,i){var r=this;i!==0?(r.element.find(".fr-toolbar-numPages-button").html(i),r.element.find(".fr-toolbar-reportpage-textbox").attr({max:i,min:1})):r.element.find(".fr-toolbar-numPages-button").html("?");r.options.$reportViewer.reportViewer("getHasDocMap")?(r.enableTools([n.btnDocumentMap]),r.removeHideDisable([n.btnDocumentMap])):r.disableTools([n.btnDocumentMap]);t<=1?r.disableTools([n.btnPrev,n.btnFirstPage]):r.enableTools([n.btnPrev,n.btnFirstPage]);t>=i&&i!==0&&r.disableTools([n.btnNext,n.btnLastPage]);i===1?r.disableTools([n.btnNav]):(r.enableTools([n.btnNav]),r.removeHideDisable([n.btnNav]))},_clearBtnStates:function(){var n=this;n.element.find(".fr-toolbar-keyword-textbox").val("");n.element.find(".fr-toolbar-reportpage-textbox").val("");n.element.find(".fr-toolbar-numPages-button").html(0)},_leaveCurReport:function(){var t=this;t._clearBtnStates();t.disableTools(t._viewerButtons(!1));t.disableTools([n.btnCredential,n.btnParamarea])},_checkSubscription:function(){var t=this,i;(!t.options.dbConfig||t.options.dbConfig.UseMobilizerDB!==!1)&&t.options.$reportViewer.reportViewer("showSubscriptionUI")&&(i=t.options.$reportViewer.reportViewer("getPermissions"),i["Create Subscription"]===!0?t.showTool(n.btnEmailSubscription.selectorClass):t.hideTool(n.btnEmailSubscription.selectorClass))},_create:function(){}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var u=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,n=forerunner.ssr.tools.toolpane,i=forerunner.ssr.tools.groups,r=forerunner.ssr.tools.mergedItems,f=forerunner.localize;$.widget(u.getFullname(u.toolPane),$.forerunner.toolBase,{options:{dbConfig:{},$reportViewer:null,toolClass:"fr-toolpane"},_initCallbacks:function(){var u=this;u.options.$reportViewer.on(t.reportViewerSetPageDone(),function(t,e){if(e.renderError===!0)u.enableTools([n.itemRefresh,r.itemFolders,i.itemFolderGroup]);else{$("input.fr-item-textbox-reportpage",u.element).val(e.newPageNum);var o=u.options.$reportViewer.reportViewer("getNumPages");u.enableTools(u._viewerItems(!1));u._updateItemStates(e.newPageNum,o);e.credentialRequired===!1&&u.disableTools([n.itemCredential]);u.element.find(".fr-item-keyword-textbox").watermark(f.getLocData().toolbar.search,forerunner.config.getWatermarkConfig())}});u.options.$reportViewer.on(t.reportViewerAfterLoadReport(),function(){u.disableTools([r.itemProperty]);var n=u.options.$reportViewer.reportViewer("getPermissions");n["Update Properties"]===!0&&u.enableTools([r.itemProperty]);u._checkSubscription()});u.options.$reportViewer.on(t.reportViewerShowDocMap(),function(){u.disableAllTools();u.enableTools([n.itemDocumentMap])});u.options.$reportViewer.on(t.reportViewerHideDocMap(),function(){u.enableAllTools()});u.options.$reportViewer.on(t.reportViewerShowNav(),function(t,i){if(i.open)u.disableAllTools(),u.enableTools([n.itemNav]),u.freezeEnableDisable(!0);else{u.freezeEnableDisable(!1);u.enableAllTools();var r=u.options.$reportViewer.reportViewer("getNumPages");u._updateItemStates(i.newPageNum,r)}});u.options.$reportViewer.on(t.reportViewerDrillThrough(),function(){u._leaveCurReport();u._checkSubscription()});u.options.$reportViewer.on(t.reportViewerPreLoadReport(),function(){u._leaveCurReport()});u.options.$reportViewer.on(t.reportViewerChangeReport(),function(t,i){u._leaveCurReport();i.credentialRequired===!0&&u.enableTools([n.itemCredential]);u._checkSubscription()});u.options.$reportViewer.on(t.reportViewerFindDone(),function(){forerunner.device.isTouch()&&u.element.find(".fr-item-keyword-textbox").trigger("blur")});u.options.$reportViewer.on(t.reportViewerShowCredential(),function(){u.enableTools([n.itemCredential]);u.removeHideDisable([n.itemCredential])});u.options.$reportViewer.on(t.reportViewerZoomChange(),function(n,t){u._$itemPercentage.val(t.zoomFactor.toFixed(0))});u.options.$reportViewer.on(t.reportViewerResetCredential(),function(){u._clearItemStates();u.disableTools(u._viewerItems());u.enableTools([n.itemReportBack,n.itemCredential,r.itemFolders,i.itemFolderGroup])});u.options.$reportViewer.on(t.reportViewerRefresh(),function(){u._clearItemStates()})},_init:function(){var t=this,r,f,u;t._super();t.element.html("");r=new $("<div class='"+t.options.toolClass+" fr-core-widget' />");$(t.element).append(r);t.options.dbConfig.SeperateDB!==!0&&forerunner.helper.pushIfNot(i.itemFolderGroup.tools,n.itemRecent);t.addTools(1,!1,t._viewerItems());forerunner.ajax.isFormsAuth(function(n){!n&&forerunner.ssr.tools.toolpane.itemLogOff&&t.hideTool(forerunner.ssr.tools.toolpane.itemLogOff.selectorClass)});t.options.dbConfig&&t.options.dbConfig.UseMobilizerDB===!0&&!t.options.$reportViewer.reportViewer("showSubscriptionUI")&&t.hideTool(n.itemEmailSubscription.selectorClass);t._$itemPercentage=t.element.find("."+n.itemPercent.selectorClass);f=t.options.$reportViewer.reportViewer("getZoomFactor").toFixed(0);t._$itemPercentage.val(f);u=new $("<div />");u.attr("style","height:65px");r.append(u);t.options.$reportViewer&&t._initCallbacks()},_viewerItems:function(t){var e=this,u=[i.itemVCRGroup,i.itemFolderGroup],f;return(t===!0||t===undefined)&&u.push(n.itemReportBack),u.push(n.itemCredential,n.itemNav,n.itemRefresh,n.itemDocumentMap,n.itemZoomDropDown,i.itemZoomGroup,n.itemExport,i.itemExportGroup,n.itemPrint),e.options.dbConfig&&e.options.dbConfig.UseMobilizerDB===!0&&u.push(n.itemEmailSubscription),f=e.options.$reportViewer.reportViewer("getUserSettings"),f&&f.adminUI&&f.adminUI===!0&&u.push(r.itemProperty),u.push(i.itemFindGroup),u},_updateItemStates:function(t,i){var r=this;i!==0?(r.element.find(".fr-toolbar-numPages-button").html(i),r.element.find(".fr-item-textbox-reportpage").attr({max:i,min:1})):r.element.find(".fr-toolbar-numPages-button").html("?");r.options.$reportViewer.reportViewer("getHasDocMap")?(r.enableTools([n.itemDocumentMap]),r.removeHideDisable([n.itemDocumentMap])):r.disableTools([n.itemDocumentMap]);t<=1?r.disableTools([n.itemPrev,n.itemFirstPage]):r.enableTools([n.itemPrev,n.itemFirstPage]);t>=i&&i!==0&&r.disableTools([n.itemNext,n.itemLastPage]);i===1?r.disableTools([n.itemNav]):(r.enableTools([n.itemNav]),r.removeHideDisable([n.itemNav]))},_clearItemStates:function(){var n=this;n.element.find(".fr-item-keyword-textbox").val("");n.element.find(".fr-item-textbox-reportpage").val("");n.element.find(".fr-toolbar-numPages-button").html(0)},_leaveCurReport:function(){var t=this;t._clearItemStates();t.disableTools(t._viewerItems(!1));t.disableTools([n.itemCredential])},_checkSubscription:function(){var t=this,i;(!t.options.dbConfig||t.options.dbConfig.UseMobilizerDB!==!1)&&t.options.$reportViewer.reportViewer("showSubscriptionUI")&&(i=t.options.$reportViewer.reportViewer("getPermissions"),i["Create Subscription"]===!0?t.showTool(n.itemEmailSubscription.selectorClass):t.hideTool(n.itemEmailSubscription.selectorClass))}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,i=forerunner.localize;$.widget(n.getFullname(n.pageNav),{options:{$reportViewer:null,$appContainer:null,rsInstance:null},_create:function(){},_setCurrentPage:function(n){var t=this,i;t.currentPageNum!==null&&t.currentPageNum!==n&&(i=t.listItems[t.currentPageNum-1],i.removeClass("fr-nav-selected"),i.find("img").removeClass("fr-nav-page-thumb-selected"));t.currentPageNum=n;t._ScrolltoPage();i=t.listItems[t.currentPageNum-1];i.addClass("fr-nav-selected");i.find("img").addClass("fr-nav-page-thumb-selected")},_ScrolltoPage:function(){var n=this,t,i;if(n.currentPageNum>n._maxNumPages&&n.options.$reportViewer.reportViewer("getNumPages")===0){for(t=n._maxNumPages+1;t<=n.currentPageNum;t++)n._renderListItem(t,n.$list);n._maxNumPages=n.currentPageNum}n.currentPageNum&&!forerunner.device.isElementInViewport(n.listItems[n.currentPageNum-1].get(0))&&(i=n.$ul.scrollLeft()+n.listItems[n.currentPageNum-1].position().left,n.$ul.scrollLeft(i))},_maxNumPages:null,_renderListItem:function(n,t,i){var r=this,s=r.options.$reportViewer.reportViewer("getSessionID"),h=r.options.$reportViewer.reportViewer("getReportViewerAPI"),c=r.options.$reportViewer.reportViewer("getReportPath"),e=h+"/Thumbnail/?ReportPath="+encodeURIComponent(c)+"&SessionID="+s+"&PageNumber="+n,f,o,u;r.options.rsInstance&&(e+="&instance="+r.options.rsInstance);f=new $("<LI />");i&&r.$loadMore?f.insertBefore(r.$loadMore):t.append(f);r.listItems[n-1]=f;o=new $("<DIV class='fr-nav-centertext'>"+n.toString()+"<\/DIV>");u=new $("<IMG />");u.addClass("fr-nav-page-thumb");u.addClass("lazy");u.attr("src",forerunner.config.forerunnerFolder()+"reportviewer/Images/page-loading.gif");u.attr("data-src",e);u.data("pageNumber",n);this._on(u,{click:function(n){r.options.$reportViewer.reportViewer("navToPage",$(n.currentTarget).data("pageNumber"));forerunner.device.isSmall(r.options.$appContainer)&&r.options.$reportViewer.reportViewer("showNav")}});f.addClass("fr-nav-item");f.append(o);f.append(u)},_batchSize:10,_renderList:function(){var n=this,e=forerunner.device.isTouch(),i,r,t,u,f;for(i=new $("<ul class='fr-nav-container fr-core-widget' />"),n.$ul=i,n._maxNumPages=n.options.$reportViewer.reportViewer("getNumPages"),n._maxNumPages===0&&(n._maxNumPages=n._batchSize),n.listItems=new Array(n._maxNumPages),r=1;r<=n._maxNumPages;r++)n._renderListItem(r,i);if(n._maxNumPages!==n.options.$reportViewer.reportViewer("getNumPages")){t=new $("<LI />");t.addClass("fr-nav-loadmore");t.addClass("fr-nav-item");t.addClass("fr-core-cursorpointer");t.on("click",function(){var i,r,u;if(n.options.$reportViewer.reportViewer("getNumPages")===0){for(i=n._maxNumPages+1;i<=n._maxNumPages+n._batchSize;i++)n._renderListItem(i,n.$list,!0);n._maxNumPages+=n._batchSize}else{if(r=n.options.$reportViewer.reportViewer("getNumPages"),r!==n._maxNumPages){for(i=n._maxNumPages+1;i<=r;i++)n._renderListItem(i,n.$list,!0);n._maxNumPages=r}t.remove()}n._fullScreenCheck();u=$("ul.fr-nav-container",$(n.element));$(".lazy",n.$list).lazyload({$container:u,onError:function(n){t&&t.remove();n.data.parent().remove()}})});u=new $("<Div />");u.addClass("fr-nav-loadmore-text");t.append(u);i.append(t);n.$loadMore=t}return f=new $("<LI />"),f.addClass("fr-nav-li-spacer"),i.append(f)},reset:function(){var n=this;n.element.hide();n.isRendered=!1},_render:function(){var n=this,e,t,r,u,f;n.element.html("");e=forerunner.device.isTouch();t=new $("<DIV />");t.addClass("fr-nav-container");n.$slider=t;r=$("<DIV />");r.addClass("fr-nav-close-container");u=$("<SPAN>"+i.getLocData().paramPane.cancel+"<\/SPAN>");u.addClass("fr-nav-close");r.append(u);r.on("click",function(){n.options.$reportViewer.reportViewer("showNav")});t.append(r);n.currentPageNum=n.options.$reportViewer.reportViewer("getCurPage");f=n._renderList();n.$list=f;t.append(f);n.element.css("display","block");n.element.append(t);n.element.hide();n._initCallbacks();n._setCurrentPage(n.currentPageNum)},_makeVisible:function(n){var t=this;if(n){t._fullScreenCheck.call(t,0);t.element.fadeIn("fast");t._ScrolltoPage();$(window).on("resize",{me:t},t._fullScreenCheckCall)}else t.element.fadeOut("fast"),$(window).off("resize",t._fullScreenCheckCall)},_fullScreenCheckCall:function(n){var t=n.data.me;t._fullScreenCheck.call(t,100)},resizeTimer:null,_fullScreenCheck:function(n){var t=this;t.resizeTimer&&(clearTimeout(t.resizeTimer),t.resizeTimer=null);t.resizeTimer=setTimeout(function(){var n=t.element.find(".fr-nav-container"),i=t.element.find(".fr-nav-item"),r=t.element.find(".fr-nav-li-spacer"),u=t.element.find(".fr-nav-close-container");forerunner.device.isSmall(t.options.$appContainer)?(t.element.addClass("fr-nav-container-full"),n.addClass("fr-nav-container-full"),i.addClass("fr-nav-item-full"),r.addClass("fr-nav-li-spacer-full"),u.addClass("fr-nav-close-container-full")):(t.element.removeClass("fr-nav-container-full"),n.removeClass("fr-nav-container-full"),i.removeClass("fr-nav-item-full"),r.removeClass("fr-nav-li-spacer-full"),u.removeClass("fr-nav-close-container-full"));t.resizeTimer=null},n)},showNav:function(){var n=this,t;n.isRendered||(n._render(),n.isRendered=!0,t=$("ul.fr-nav-container",$(n.element)),$(".lazy",n.$list).lazyload({$container:t,onError:function(t){n.$loadMore&&n.$loadMore.remove();t.data.parent().remove()}}));n._makeVisible(!n.element.is(":visible"));$(".fr-nav-container",$(n.element)).css("position",n.element.css("position"));forerunner.device.isMSIE()&&n._ScrolltoPage()},_initCallbacks:function(){var n=this;n.options.$reportViewer.on(t.reportViewerChangePage(),function(t,i){n._setCurrentPage(i.newPageNum)})},_init:function(){var n=this;n.listItems=null;n.$ul=null;n.currentPageNum=null;n.isRendered=!1}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var f=forerunner.ssr.constants.widgets,r=forerunner.ssr.constants.events,o=forerunner.helper,e=forerunner.localize,t=forerunner.ssr.constants.itemType,n=forerunner.ssr.constants.properties,i=[n.description,n.tags,n.rdlExtension],u={1:i,2:i,3:i,4:i,searchFolder:[n.description,n.searchFolder,n.rdlExtension]};$.widget(f.getFullname(f.reportExplorerContextMenu),$.forerunner.contextMenuBase,{options:{$appContainer:null,$reportExplorer:null,reportManagerAPI:null,rsInstance:null,catalogItem:null,view:null},_init:function(){var n=this,i;if(n.contextMenu=e.getLocData().contextMenu,i=n.options.catalogItem,n.fetchPermissions(),n.setTitle(o.getCurrentItemName(n.options.catalogItem.Path)),n._$delete.off("click"),n.permissions.Delete){n._$delete.on("click",function(){n._onClickDelete.apply(n,arguments)});n._$delete.removeClass("fr-toolbase-disabled").addClass("fr-core-cursorpointer")}else n._$delete.addClass("fr-toolbase-disabled").removeClass("fr-core-cursorpointer");if(n._$properties.off("click"),!n.permissions["Update Properties"]&&u[n.options.catalogItem.Type])n._$properties.addClass("fr-toolbase-disabled").removeClass("fr-core-cursorpointer");else{n._$properties.on("click",function(){n._onClickProperties.apply(n,arguments)});n._$properties.removeClass("fr-toolbase-disabled").addClass("fr-core-cursorpointer")}if(n._$downloadFile.off("click"),i.Type!==t.report&&i.Type!==t.resource)n._$downloadFile.hide();else{n._$downloadFile.show();n._$downloadFile.on("click",function(){n._onClickDownloadFile.apply(n,arguments)});n._$downloadFile.removeClass("fr-toolbase-disabled").addClass("fr-core-cursorpointer")}if(n._$security.off("click"),n.permissions["Update Security Policies"]){n._$security.on("click",function(){n._onClickSecurity.apply(n,arguments)});n._$security.removeClass("fr-toolbase-disabled").addClass("fr-core-cursorpointer")}else n._$security.addClass("fr-toolbase-disabled").removeClass("fr-core-cursorpointer");if(n._$linkedReport.off("click").hide(),i.Type===t.report||i.Type===t.linkedReport){if(n.permissions["Create Link"]){n._$linkedReport.on("click",function(){n._onClickLinkedReport.apply(n,arguments)});n._$linkedReport.removeClass("fr-toolbase-disabled").addClass("fr-core-cursorpointer")}else n._$linkedReport.addClass("fr-toolbase-disabled").removeClass("fr-core-cursorpointer");n._$linkedReport.show()}else n._$linkedReport.hide();if(n._$moveItem.off("click"),n.permissions["Update Properties"]){n._$moveItem.on("click",function(){n._onClickMoveItem.apply(n,arguments)});n._$moveItem.removeClass("fr-toolbase-disabled").addClass("fr-core-cursorpointer")}else n._$moveItem.addClass("fr-toolbase-disabled").removeClass("fr-core-cursorpointer");if(n._$unFavorite.off("click").hide(),n.options.view==="favorites"){n._$unFavorite.on("click",function(){n._onClickUnFavorite.apply(n,arguments)});n._$unFavorite.show()}n._super()},_create:function(){var n=this;n.contextMenu=e.getLocData().contextMenu;n._super();n.addHeader();n._$moveItem=n.addMenuItem("fr-ctx-move-id",n.contextMenu.move);n._$delete=n.addMenuItem("fr-ctx-delete-id",n.contextMenu.delLabel);n._$security=n.addMenuItem("fr-ctx-security-id",n.contextMenu.security);n._$properties=n.addMenuItem("fr-ctx-properties-id",n.contextMenu.properties);n._$linkedReport=n.addMenuItem("fr-ctx-linked-id",n.contextMenu.linkedReport);n._$downloadFile=n.addMenuItem("fr-ctx-download-id",n.contextMenu.downloadFile);n._$unFavorite=n.addMenuItem("fr-crx-unFav-id",n.contextMenu.unFavorite)},_onClickDelete:function(){var n=this,i=forerunner.helper.getCurrentItemName(n.options.catalogItem.Path),t;window.confirm(n.contextMenu.deleteConfirm.format(i))&&(t=n.options.reportManagerAPI+"/DeleteCatalogItem",forerunner.ajax.ajax({dataType:"json",url:t,data:{path:n.options.catalogItem.Path,safeFolderDelete:!0,instance:n.options.rsInstance},async:!1,success:function(t){t.Warning==="folderNotEmpty"?forerunner.dialog.showMessageBox(n.options.$appContainer,n.contextMenu.folderNotEmpty):t.Status&&t.Status==="Success"&&n.options.$reportExplorer.reportExplorer("refresh")},fail:function(n){console.log("DeleteCatalogItem failed - "+n.statusText);console.log(n)}}),n.closeMenu())},_onClickDownloadFile:function(){var n=this,t=n.options.reportManagerAPI+"/DownloadFile?path="+encodeURIComponent(n.options.catalogItem.Path)+"&itemtype="+encodeURIComponent(n.options.catalogItem.Type);n.options.rsInstance&&(t+="&instance="+n.options.rsInstance);window.location.assign(t);n.closeMenu()},_onClickProperties:function(){var t=this,i=t.options.$appContainer.find(".fr-properties-section"),n,f;if(!i||i.length===0){console.log("Error - fr-properties-section not found");return}n=i.forerunnerProperties("getProperties");f=u[t.options.catalogItem.Type];t.options.catalogItem.Type===3&&(f=t.options.catalogItem.MimeType==="json/forerunner-searchfolder"?u.searchFolder:f);i.forerunnerProperties("setProperties","contextmenu",t.options.catalogItem.Path,f);i.forerunnerProperties("openDialog");i.one(r.forerunnerPropertiesClose(),function(r,u){n&&n.path&&n.propertyList&&(i.forerunnerProperties("setProperties",n.view,n.path,n.propertyList),n=null);u.isUpdate&&t.options.$reportExplorer.reportExplorer("refresh")});t.closeMenu()},_onClickSecurity:function(){var i=this,n=i.options.$appContainer.find(".fr-security-section"),t;if(!n||n.length===0){console.log("Error - fr-security-section not found");return}t=n.forerunnerSecurity("getCurPolicy");n.forerunnerSecurity("setData",i.options.catalogItem.Path,"Catalog");n.forerunnerSecurity("openDialog");n.one(r.forerunnerSecurityClose(),function(){t&&(n.forerunnerSecurity("setCurPolicy",t),t=null)});i.closeMenu()},_onClickLinkedReport:function(){var t=this,n=t.options.$appContainer.find(".fr-linked-section");if(!n||n.length===0){console.log("Error - fr-security-section not found");return}n.forerunnerLinkedReport("setData",t.options.catalogItem);n.forerunnerLinkedReport("openDialog");t.closeMenu()},_onClickMoveItem:function(){var t=this,n=t.options.$appContainer.find(".fr-move-section");if(!n||n.length===0){console.log("Error - fr-move-section not found");return}n.forerunnerMoveItem("setData",t.options.catalogItem);n.forerunnerMoveItem("openDialog");n.one(r.forerunnerMoveItemClose(),function(){t.options.$reportExplorer.reportExplorer("refresh")});t.closeMenu()},_onClickUnFavorite:function(){var n=this,i=forerunner.helper.getCurrentItemName(n.options.catalogItem.Path),t;window.confirm(n.contextMenu.unFavConfirm.format(i))&&(t=n.options.reportManagerAPI+"/UpdateView?view=favorites&action=delete&path="+n.options.catalogItem.Path,n.options.rsInstance&&(t+="&instance="+n.options.rsInstance),forerunner.ajax.ajax({dataType:"json",url:t,async:!1,success:function(t){t.Status==="Success"&&n.options.$reportExplorer.reportExplorer("refresh")},fail:function(n){console.log("UpdateView failed - "+n.statusText);console.log(n)}}),n.closeMenu())}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.tools=forerunner.ssr.tools||{};forerunner.ssr.tools.reportExplorerToolbar=forerunner.ssr.tools.reportExplorerToolbar||{};$(function(){var t=forerunner.ssr.constants.widgets,e=forerunner.ssr.constants.events,n=forerunner.ssr.tools.reportExplorerToolbar,u=forerunner.ssr.tools.mergedButtons,i=forerunner.ssr.tools.groups,r="fr-toolbase-persistent-active-state",f=forerunner.localize;$.widget(t.getFullname(t.reportExplorerToolbar),$.forerunner.toolBase,{options:{path:null,navigateTo:null,toolClass:"fr-toolbar",dbConfig:{},$appContainer:null,$reportExplorer:null},setFolderBtnActive:function(n){var t=this,i;t._clearFolderBtnState();n&&(i=t.element.find("."+n),i.addClass(r))},setSearchKeyword:function(n){var t=this;t.element.find(".fr-rm-keyword-textbox").val(n)},_clearFolderBtnState:function(){var n=this;$.each(n.folderBtns,function(n,t){t.removeClass(r)})},_initCallbacks:function(){var t=this;t.enableTools([n.btnMenu,n.btnBack,n.btnFav,n.btnRecent,i.explorerFindGroup]);t.element.find(".fr-rm-keyword-textbox").watermark(f.getLocData().toolbar.search,forerunner.config.getWatermarkConfig())},_init:function(){var t=this,r;t._super();t.element.empty();t.element.append($("<div class='"+t.options.toolClass+" fr-core-toolbar fr-core-widget'/>"));r=[n.btnMenu,n.btnBack];t.options.dbConfig&&t.options.dbConfig.UseMobilizerDB===!0&&(t.options.path!=="/"&&r.push(u.btnFav),r.push(n.btnSetup));forerunner.config.getCustomSettingsValue("showHomeButton","off")==="on"&&r.push(n.btnHome);t.options.dbConfig&&t.options.dbConfig.UseMobilizerDB===!0&&(forerunner.config.getCustomSettingsValue("showSubscriptionUI","off")==="on"&&r.push(n.btnMySubscriptions),t.options.dbConfig.SeperateDB!==!0&&r.push(n.btnRecent),r.push(n.btnFav));r.push(n.btnLogOff);r.push(i.explorerFindGroup);t.addTools(1,!0,r);forerunner.ajax.isFormsAuth(function(i){i||t.hideTool(n.btnLogOff.selectorClass)});t._initCallbacks();var f=t.element.find("."+n.btnHome.selectorClass),e=t.element.find("."+n.btnRecent.selectorClass),o=t.element.find("."+n.btnFav.selectorClass);t.folderBtns=[f,e,o];t.windowResize()},_create:function(){}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.tools=forerunner.ssr.tools||{};forerunner.ssr.tools.reportExplorerToolpane=forerunner.ssr.tools.reportExplorerToolpane||{};$(function(){var r=forerunner.ssr.constants.widgets,i=forerunner.ssr.constants.events,n=forerunner.ssr.tools.reportExplorerToolpane,e=forerunner.ssr.tools.groups,t=forerunner.ssr.tools.mergedItems,u="fr-toolbase-persistent-active-light",f=forerunner.localize;$.widget(r.getFullname(r.reportExplorerToolpane),$.forerunner.toolBase,{options:{navigateTo:null,dbConfig:{},path:null,toolClass:"fr-toolpane",$appContainer:null,$reportExplorer:null},setFolderItemActive:function(n){var t=this,i;t._clearFolderItemState();n&&(i=t.element.find("."+n),i.addClass(u))},setSearchKeyword:function(n){var t=this;t.element.find(".fr-rm-item-keyword").val(n)},_clearFolderItemState:function(){var n=this;$.each(n.folderItems,function(n,t){t.removeClass(u)})},_createCallbacks:function(){var n=this,t;n.options.$reportExplorer.off(i.reportExplorerBeforeFetch());n.options.$reportExplorer.on(i.reportExplorerBeforeFetch(),function(){n._updateBtnStates.call(n)});t=n.options.$appContainer.find(".fr-us-section");t.off(i.userSettingsClose());t.on(i.userSettingsClose(),function(t,i){i.isSubmit&&n._updateBtnStates.call(n)})},_isAdmin:function(){var t=this,n=t.options.$reportExplorer.reportExplorer("getUserSettings");return n&&n.adminUI&&n.adminUI===!0?!0:!1},_init:function(){var i=this;i._super();i.element.empty();i.element.append($("<div class='"+i.options.toolClass+" fr-core-widget'/>"));var r=[n.itemBack],u=forerunner.ssr.tools.groups,e=forerunner.ssr.tools.reportExplorerToolpane,o=forerunner.ssr.tools.dashboardToolPane;i.options.dbConfig&&i.options.dbConfig.UseMobilizerDB===!0&&(r.push(n.itemSetup),i.options.path!=="/"&&r.push(t.itemFav),r.push(n.itemFolders,u.explorerItemFolderGroup));i.options.dbConfig&&i.options.dbConfig.UseMobilizerDB===!0&&r.push(n.itemSearchFolder);i.options.dbConfig.SeperateDB!==!0&&(forerunner.helper.pushIfNot(u.explorerItemFolderGroup.tools,e.itemRecent),forerunner.helper.pushIfNot(u.dashboardItemFolderGroup.tools,o.itemRecent));forerunner.config.getCustomSettingsValue("showHomeButton","off")==="on"&&(u.itemFolderGroup.tools.push(n.itemHome),u.explorerItemFolderGroup.tools.push(e.itemHome),u.dashboardItemFolderGroup.tools.push(o.itemHome));r.push(n.itemCreateDashboard,n.itemUploadFile,n.itemNewFolder,t.itemSecurity);i.options.path!=="/"&&r.push(t.itemProperty);r.push(u.explorerItemFindGroup);r.push(n.itemLogOff);i.addTools(1,!0,r);forerunner.ajax.isFormsAuth(function(t){t||i.hideTool(n.itemLogOff.selectorClass)});var s=i.element.find("."+n.itemHome.selectorClass),h=i.element.find("."+n.itemRecent.selectorClass),c=i.element.find("."+n.itemFav.selectorClass);i.folderItems=[s,h,c];i.element.find(".fr-rm-item-keyword").watermark(f.getLocData().toolbar.search,forerunner.config.getWatermarkConfig());i._updateBtnStates()},_create:function(){var n=this;n._createCallbacks()},_updateBtnStates:function(){var r=this,u=[],e=[n.itemSearchFolder,n.itemCreateDashboard,n.itemUploadFile,n.itemNewFolder,t.itemProperty,t.itemSecurity],i,f;r.disableTools(e);r.hideTools(e);r._isAdmin()&&(i=r.options.$reportExplorer.reportExplorer("getLastFetched"),f=r.options.$reportExplorer.reportExplorer("getPermission"),i&&i.view==="catalog"&&(f["Create Resource"]&&u.push(n.itemSearchFolder,n.itemCreateDashboard,n.itemUploadFile),f["Create Folder"]&&i.view==="catalog"&&u.push(n.itemNewFolder),f["Update Security Policies"]&&u.push(t.itemSecurity)),i&&(i.view==="searchfolder"||i.view==="catalog"||i.view==="resource")&&i.path!=="/"&&f["Update Properties"]&&u.push(t.itemProperty),u.length&&(r.enableTools(u),r.showTools(u),r.removeHideDisable(u)))}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,n=forerunner.localize;$.widget(i.getFullname(i.reportExplorer),$.forerunner.viewerBase,{options:{reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager",forerunnerPath:forerunner.config.forerunnerFolder(),selectedItemPath:null,$scrollBarOwner:null,navigateTo:null,$appContainer:null,explorerSettings:null,rsInstance:null,onInputBlur:null,onInputFocus:null,userSettings:null,dbConfig:{}},_create:function(){var n=this;forerunner.ssr._internal.init();n._super()},_init:function(){var n=this,t;n.$RMList=null;n.$UL=null;n.rmListItems=null;n.colorOverrideSettings=null;n.selectedItem=0;n.isRendered=!1;n.$explorer=n.options.$scrollBarOwner?n.options.$scrollBarOwner:$(window);n._super(n.$explorer);n.$viewerContainer=n.$explorer;n.$selectedItem=null;t=n.element.find(".fr-report-explorer");t.length===0&&(t=$("<div class='fr-report-explorer fr-core-widget'><\/div>"),n.element.append(t));n.$reportExplorerContainer=t;n._super(t);n.subscriptionModel||(n.subscriptionModel=$({}).subscriptionModel({rsInstance:n.options.rsInstance}));n._initExplorerDialogs()},saveUserSettings:function(n){var t=this,r=JSON.stringify(n),i=forerunner.config.forerunnerAPIBase()+"ReportManager/SaveUserSettings?settings="+r;t.options.rsInstance&&(i+="&instance="+t.options.rsInstance);forerunner.ajax.ajax({url:i,dataType:"json",success:function(){t.refresh()},error:function(n){console.log(n)}})},getUserSettings:function(){var n=this;return n.options.userSettings},_generatePCListItem:function(n,t){var i=this,d=i.options.reportManagerAPI+"/Thumbnail/?ReportPath="+encodeURIComponent(n.Path)+"&DefDate="+n.ModifiedDate,r,u,v,e,k,o,f,g,s,y,h,nt,p,l,b,w,a,c;if(i.options.rsInstance&&(d+="&instance="+i.options.rsInstance),r=null,i.options.userSettings.viewStyle||(i.options.userSettings.viewStyle=forerunner.config.getCustomSettingsValue("DefaultViewStyle","large")),i.options.userSettings.viewStyle==="small"&&(r="-small"),i.options.userSettings.viewStyle==="list"&&(r="-list"),u=new $("<div />"),u.addClass("fr-explorer-item"),r&&u.addClass("fr-explorer-item"+r),t&&u.addClass("fr-explorer-item-selcted"),n.Hidden&&u.addClass("fr-explorer-hidden-item"),v=new $("<div />"),v.addClass("fr-explorer-item-image-link"),r&&v.addClass("fr-explorer-item-image-link"+r),n.Type===1||n.Type===7)e="explore";else if(n.Type===3)switch(n.MimeType){case"json/forerunner-dashboard":e="openDashboard";break;case"json/forerunner-searchfolder":if(e="searchfolder",i.options.dbConfig.UseMobilizerDB!==!0)return null;break;default:e="open"}else e="browse";if(forerunner.device.isTouch()){k={stop_browser_behavior:{userSelect:"none"},swipe_max_touches:22,drag_max_touches:2};u.hammer(k).on("tap",function(t){if(i.options.navigateTo){if(e==="open"&&forerunner.device.isMobile()){var r=i.options.reportManagerAPI+"/Resource?path="+encodeURIComponent(n.Path)+"&instance="+i.options.rsInstance;window.location=r;return}i.options.navigateTo(e,n.Path);t.stopPropagation()}});u.hammer(k).on("hold",function(t){var r={catalogItem:n,pageX:t.gesture.touches[0].clientX+i.options.$appContainer.scrollLeft(),pageY:t.gesture.touches[0].clientY+i.options.$appContainer.scrollTop()};i._onContextMenu.call(i,t,r);t.stopPropagation()})}else{u.on("contextmenu",function(t){var r={catalogItem:n,pageX:t.pageX,pageY:t.pageY};return i._onContextMenu.call(i,t,r),!1});u.on("click",function(){i.options.navigateTo&&i.options.navigateTo(e,n.Path)})}return u.append(v),o=new $("<div />"),o.addClass("fr-report-item-image-block"),r&&o.addClass("fr-report-item-image-block"+r),v.append(o),f=new $("<div />"),o.append(f),n.Type===1||n.Type===7?t?i.isIE8Small?f.addClass("fr-explorer-folder-selected-ie8"):f.addClass("fr-explorer-folder-selected"):i.isIE8Small?f.addClass("fr-explorer-folder-ie8"):f.addClass("fr-explorer-folder"):n.Type===3?(g=i._getFileTypeClass(n.MimeType),f.addClass(g),n.MimeType==="json/forerunner-searchfolder"&&t&&(i.isIE8Small?f.addClass("fr-explorer-searchfolder-selected-ie8").removeClass("fr-explorer-searchfolder-ie8"):f.addClass("fr-explorer-searchfolder-selected").removeClass("fr-explorer-searchfolder"))):(s=new $("<img />"),o.append(s),y=new $("<div />"),o.append(y),y.addClass("fr-explorer-item-earcorner"),r&&y.addClass("fr-explorer-item-earcorner"+r),n.Hidden||y.css("background-color",i.$UL.css("background-color")),h=new $("<div />"),o.append(h),nt=d,s.addClass("fr-report-item-inner-image"),r&&s.addClass("fr-report-item-inner-image"+r),s.addClass("fr-report-item-image-base"),f.addClass("fr-report-item-image-base"),h.addClass("fr-report-item-image-base"),i.isIE8Small?f.addClass("fr-report-item-outer-image-ie8"):f.addClass("fr-report-item-outer-image"),t?i.isIE8Small?h.addClass("fr-explorer-item-ear-selcted-ie8"):h.addClass("fr-explorer-item-ear-selcted"):i.isIE8Small?h.addClass("fr-report-item-ear-image-ie8"):h.addClass("fr-report-item-ear-image"),s.attr("src",nt),s.error(function(){$(this).attr("src",i.options.forerunnerPath+"ReportExplorer/images/Report-icon.png")}),s.removeAttr("height")),t&&(i.$selectedItem=u),p=new $("<div />"),p.addClass("fr-explorer-caption"),r&&p.addClass("fr-explorer-caption"+r),l=new $("<div />"),l.addClass("fr-explorer-item-title"),r&&l.addClass("fr-explorer-item-title"+r),b=n.Name,n.LocalizedName&&(b=n.LocalizedName),l.attr("title",b),l.text(b),p.append(l),u.append(p),w=new $("<div />"),w.addClass("fr-explorer-desc-container"),r&&w.addClass("fr-explorer-desc-container"+r),a=new $("<div />"),a.addClass("fr-explorer-item-desc"),r&&a.addClass("fr-explorer-item-desc"+r),c=n.Description,n.LocalizedDescription&&(c=n.LocalizedDescription),c&&(c=forerunner.helper.htmlDecode(c),a.attr("title",c),a.text(c)),w.append(a),u.append(w),u},_onContextMenu:function(n,t){var i=this,r;i.getUserSettings().adminUI&&(r=i.options.$appContainer.find(".fr-ctx-section"),r.length===0&&(r=$("<div class='fr-ctx-section'/>"),i.options.$appContainer.append(r),i._contextMenu=r),r.reportExplorerContextMenu({$appContainer:i.options.$appContainer,$reportExplorer:i.element,reportManagerAPI:i.options.reportManagerAPI,rsInstance:i.options.rsInstance,catalogItem:t.catalogItem,view:i.view}),i._contextMenu.reportExplorerContextMenu("openMenu",t.pageX,t.pageY))},_renderPCView:function(n){var t=this,u,i,r,f;for(t.$UL=t.element.find(".fr-report-explorer"),t.$UL.html(""),u=t.options.selectedItemPath?decodeURIComponent(t.options.selectedItemPath):null,t.rmListItems=new Array(n.length),i=0;i<n.length;i++)(r=n[i],!r.Hidden||t.getUserSettings().adminUI)&&(f=!1,u&&u===decodeURIComponent(r.Path)&&(t.selectedItem=i,f=!0),t.rmListItems[i]=t._generatePCListItem(r,f),t.rmListItems[i]&&t.$UL.append(t.rmListItems[i]));t.$UL.find(".fr-explorer-item-title").multiLineEllipsis();t.$UL.find(".fr-explorer-item-desc").multiLineEllipsis()},_render:function(n){var t=this;t.isIE8Small=forerunner.device.isMSIE8()&&(t.options.userSettings.viewStyle==="small"||t.options.userSettings.viewStyle==="list");t._renderPCView(n);t.$selectedItem?(setTimeout(function(){t.$explorer.scrollTop(t.$selectedItem.offset().top-50)},100),setTimeout(function(){t.$explorer.scrollLeft(t.$selectedItem.offset().left-20)},100)):(setTimeout(function(){t.$explorer.scrollTop(0)},100),setTimeout(function(){t.$explorer.scrollLeft(0)},100))},_renderResource:function(n){var i=this,f=i.options.reportManagerAPI+"/Resource?path="+encodeURIComponent(n)+"&instance="+i.options.rsInstance,r=$("<iframe/>"),u,t;r.addClass("fr-report-explorer fr-core-widget fr-explorer-iframe");r.attr("src",f);i.element.append(r);forerunner.device.isMSIE()?(u=r[0],t=function(){var n=null;if(document.readyState){try{n=u.document.readyState}catch(r){n=null}n!=="complete"&&n?setTimeout(t,10):i._loadIframeDone(u)}},t.TimeoutInt&&(clearTimeout(t.timeoutInt),t.TimeoutInt=null),t.timeoutInt=setTimeout(t,100)):r.load(function(){i._loadIframeDone(this)})},_loadIframeDone:function(n){var i=this;i.$reportExplorerContainer.length&&i.$reportExplorerContainer.hide();i._setIframeHeight(n);i._trigger(t.afterFetch,null,{reportExplorer:i});i.removeLoadingIndicator()},_setIframeHeight:function(n){var t=this,i=t.options.$appContainer.height()-60;n.style.height=i+"px"},_searchItems:function(i){var r=this,u,f;if(i===""){forerunner.dialog.showMessageBox(r.options.$appContainer,n.getLocData().explorerSearch.emptyError,n.getLocData().dialog.title);return}u=r.options.reportManagerAPI+"/FindItems";r.options.rsInstance&&(u+="?instance="+r.options.rsInstance);f={SearchCriteria:[{Key:"Name",Value:i},{Key:"Description",Value:i}]};forerunner.ajax.ajax({dataType:"json",url:u,data:{folder:"",searchOperator:"",searchCriteria:JSON.stringify(f)},success:function(i){i.Exception?forerunner.dialog.showMessageBox(r.options.$appContainer,i.Exception.Message,n.getLocData().messages.catalogsLoadFailed):i.length?r._render(i):r._showNotFound();r._trigger(t.afterFetch,null,{reportExplorer:r});r.removeLoadingIndicator()},error:function(i){console.log(i);r._trigger(t.afterFetch,null,{reportExplorer:r,lastFetched:r.lastFetched,newPath:r.path});r.removeLoadingIndicator();forerunner.dialog.showMessageBox(r.options.$appContainer,n.getLocData().messages.catalogsLoadFailed)}})},_showNotFound:function(){var i=this,t=new $("<div class='fr-report-explorer fr-core-widget'><\/div>"),r=new $("<div class='fr-explorer-notfound'>"+n.getLocData().explorerSearch.notFound+"<\/div>");t.append(r);i.element.append(t)},getLastFetched:function(){var n=this;return n.lastFetched?n.lastFetched:null},load:function(n,t){var i=this;i.view=n;i.path=t;i.showLoadingIndictator();i.view==="catalog"||i.view==="searchfolder"||i.view==="resource"?i._checkPermission(function(){i._fetch(n,t)}):i._fetch(n,t);i.options.explorerSettings&&i._initOverrides();i.colorOverrideSettings&&i.colorOverrideSettings.explorer&&$(".fr-report-explorer",i.element).addClass(i.colorOverrideSettings.explorer)},refresh:function(){var n=this;n._fetch(n.lastFetched.view,n.lastFetched.path)},_fetch:function(i,r){var u=this,f;if(u.lastFetched={view:i,path:r},u.showLoadingIndictator(),u._trigger(t.beforeFetch,null,{reportExplorer:u,lastFetched:u.lastFetched,newPath:r}),i==="resource"){u._renderResource(r);return}if(i==="search"){u._searchItems(r);return}u.parentPath=null;i==="searchfolder"&&(u.parentPath=forerunner.helper.getParentPath(u.path)||"/");f=u.options.reportManagerAPI+"/GetItems";u.options.rsInstance&&(f+="?instance="+u.options.rsInstance);forerunner.ajax.ajax({dataType:"json",url:f,data:{view:i,path:r}}).done(function(i){i.Exception?forerunner.dialog.showMessageBox(u.options.$appContainer,i.Exception.Message,n.getLocData().messages.catalogsLoadFailed):u._render(i);u._trigger(t.afterFetch,null,{reportExplorer:u,lastFetched:u.lastFetched,newPath:r});u.removeLoadingIndicator()}).fail(function(i,f,e){u._trigger(t.afterFetch,null,{reportExplorer:u,lastFetched:u.lastFetched,newPath:r});u.removeLoadingIndicator();console.log(f);forerunner.dialog.showMessageBox(u.options.$appContainer,f+" - "+e,n.getLocData().messages.catalogsLoadFailed)})},_initCallbacks:function(){var n=this},_initOverrides:function(){var n=this,t,i,r;if(n.options.explorerSettings.CustomColors){if(t=decodeURIComponent(n.path),i=n.options.explorerSettings.CustomColors[t],i){n.colorOverrideSettings=i;return}for(r in n.options.explorerSettings.CustomColors)if(t.indexOf(r,0)===0){n.colorOverrideSettings=n.options.explorerSettings.CustomColors[r];return}}},_checkPermission:function(n){var t=this;forerunner.ajax.hasPermission(t.path,"Create Resource,Update Properties,Update Security Policies,Create Report,Create Folder",t.options.rsInstance,function(i){t.permissions=i;n&&n()})},getPermission:function(){var n=this;return n.permissions},_initExplorerDialogs:function(){var n=this,t;n.options.dbConfig.UseMobilizerDB===!0&&(t=n.options.$appContainer.find(".fr-us-section"),t.length===0&&(t=new $("<div class='fr-us-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),t.userSettings({dbConfig:n.options.dbConfig,$appContainer:n.options.$appContainer,$reportExplorer:n.element}),n.options.$appContainer.append(t)),n._userSettingsDialog=t,t=n.options.$appContainer.find(".fr-mms-section"),t.length===0&&(t=new $("<div class='fr-mms-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),t.manageMySubscriptions({$appContainer:n.options.$appContainer,$reportExplorer:n.element,subscriptionModel:n.subscriptionModel}),n.options.$appContainer.append(t)),n._manageMySubscriptionsDialog=t,t=n.options.$appContainer.find(".fr-sf-section"),t.length===0&&(t=new $("<div class='fr-sf-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),t.reportExplorerSearchFolder({$appContainer:n.options.$appContainer,$reportExplorer:n.element}),n.options.$appContainer.append(t)),n._searchFolderDialog=t);t=n.options.$appContainer.find(".fr-linked-section");t.length===0&&(t=new $("<div class='fr-linked-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),t.forerunnerLinkedReport({$appContainer:n.options.$appContainer,$reportExplorer:n.element,reportManagerAPI:n.options.reportManagerAPI}),n.options.$appContainer.append(t));n._linkedReportDialog=t;t=n.options.$appContainer.find(".fr-move-section");t.length===0&&(t=new $("<div class='fr-move-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),t.forerunnerMoveItem({$appContainer:n.options.$appContainer,$reportExplorer:n.element,reportManagerAPI:n.options.reportManagerAPI}),n.options.$appContainer.append(t));n._moreItemDialog=t},showCreateDashboardDialog:function(){var n=this,t=n.options.$appContainer.find(".fr-cdb-section");t.length===0&&(t=$("<div class='fr-cdb-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),n.options.$appContainer.append(t),n._createDashboardDialog=t);t.createDashboard({$appContainer:n.options.$appContainer,$reportExplorer:n.element,parentFolder:n.lastFetched.path,reportManagerAPI:n.options.reportManagerAPI,rsInstance:n.options.rsInstance});n._createDashboardDialog.createDashboard("openDialog")},showUploadFileDialog:function(){var n=this,t=n.options.$appContainer.find(".fr-upf-section");t.length===0&&(t=$("<div class='fr-upf-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),n.options.$appContainer.append(t));t.uploadFile({$appContainer:n.options.$appContainer,$reportExplorer:n.element,parentFolder:n.lastFetched.path,rsInstance:n.options.rsInstance});t.uploadFile("openDialog")},showNewFolderDialog:function(){var n=this,t=n.options.$appContainer.find(".fr-nfd-section");t.length===0&&(t=$("<div class='fr-nfd-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),n.options.$appContainer.append(t));t.newFolder({$appContainer:n.options.$appContainer,$reportExplorer:n.element,parentFolder:n.lastFetched.path,rsInstance:n.options.rsInstance});t.newFolder("openDialog")},showUserSettingsDialog:function(){var n=this;n._userSettingsDialog.userSettings("openDialog")},showManageMySubscriptionsDialog:function(){var n=this;n._manageMySubscriptionsDialog.manageMySubscriptions("listSubscriptions");n._manageMySubscriptionsDialog.manageMySubscriptions("openDialog")},showSubscription:function(n,t){var i=this;i.options.navigateTo("browse",n+"?fr:showSubscriptionOnOpen="+t)},showExplorerSearchFolderDialog:function(){var n=this;n._searchFolderDialog.reportExplorerSearchFolder("openDialog")},setSearchFolder:function(t){var i=this,r=i.options.reportManagerAPI+"/SaveResource";forerunner.ajax.ajax({url:r,type:"POST",dataType:"text",data:{resourceName:t.searchFolderName,parentFolder:i.parentPath||i.path,contents:JSON.stringify(t.content),mimetype:"json/forerunner-searchfolder",instance:i.options.rsInstance,overwrite:t.overwrite},success:function(){location.reload(!0)},error:function(){forerunner.dialog.showMessageBox(i.options.$appContainer,n.getLocData().messages.saveSearchFolderFailed,n.getLocData().toolbar.searchFolder)}})},onInputBlur:function(){var n=this;n.options.onInputBlur&&n.options.onInputBlur()},onInputFocus:function(){var n=this;n.options.onInputFocus&&n.options.onInputFocus()},getCurrentPath:function(){var n=this;return decodeURIComponent(n.path)},getCurrentView:function(){var n=this;return n.view},_getFileTypeClass:function(n){var r=this,t=null,i=!1;switch(n){case"application/pdf":t="fr-icons128x128-file-pdf";break;case"application/vnd.ms-excel":t="fr-icons128x128-file-xls";break;case"application/msword":t="fr-icons128x128-file-doc";break;case"application/vnd.ms-powerpoint":t="fr-icons128x128-file-ppt";break;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":t="fr-icons128x128-file-xls";break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t="fr-icons128x128-file-doc";break;case"application/vnd.openxmlformats-officedocument.presentationml.presentation":t="fr-icons128x128-file-ppt";break;case"text/html":t="fr-icons128x128-file-html";break;case"audio/mpeg":t="fr-icons128x128-file-mp3";break;case"image/tiff":t="fr-icons128x128-file-tiff";break;case"application/xml":t="fr-icons128x128-file-xml";break;case"image/jpeg":t="fr-icons128x128-file-jpeg";break;case"application/x-zip-compressed":t="fr-icons128x128-file-zip";break;case"application/octet-stream":t="fr-icons128x128-file-ini";break;case"image/gif":t="fr-icons128x128-file-gif";break;case"image/png":t="fr-icons128x128-file-png";break;case"image/bmp":t="fr-icons128x128-file-bmp";break;case"text/plain":t="fr-icons128x128-file-text";break;case"text/css":t="fr-icons128x128-file-css";break;case"json/forerunner-dashboard":i=!0;t=r.isIE8Small?"fr-explorer-dashboard-ie8":"fr-explorer-dashboard";break;case"json/forerunner-searchfolder":i=!0;t=r.isIE8Small?"fr-explorer-searchfolder-ie8":"fr-explorer-searchfolder";break;default:t="fr-icons128x128-file-unknown"}return i===!1&&(t="fr-icons128x128 "+t),t}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants.widgets,n=forerunner.ssr.constants.events;$.widget(t.getFullname(t.userSettings),{options:{$reportExplorer:null},_create:function(){},_init:function(){var t=this,r=forerunner.localize,i=r.getLocData().userSettings,e=r.getLocData().unit,u,f;t.element.html("");t.element.off(n.modalDialogGenericSubmit);t.element.off(n.modalDialogGenericCancel);u=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-setup",i.title,"fr-us-cancel",i.cancel);f=new $("<div class='fr-core-dialog-innerPage fr-core-center'>"+u+"<form class='fr-us-form fr-core-dialog-form'><table><tr><td><label class='fr-us-label'>"+i.ResponsiveUI+"<\/label><\/td><td><input class='fr-us-responsive-ui-id fr-us-checkbox'  name='ResponsiveUI' type='checkbox'/><\/td><\/tr><tr><td><label class='fr-us-label'>"+i.AdminUI+"<\/label><\/td><td><input class='fr-us-admin-ui-id fr-us-checkbox'  name='adminUI' type='checkbox'/><\/td><\/tr><tr><td><label class='fr-us-label'>"+i.ViewStyle+"<\/label><\/td><td><select class='fr-us-viewStyle-id fr-us-dropdown  '  name='viewStyle' list='viewStyles'><option value='large'>"+i.ViewStyleLarge+"<\/option><option value='small'>"+i.ViewStyleSmall+"<\/option><option value='list'>"+i.ViewStyleList+"<\/option><\/select<\/td><\/tr><\/table><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input name='submit' type='button' class='fr-us-submit-id fr-core-dialog-submit fr-core-dialog-button' value='"+i.submit+"'/><\/div><\/form><div class='fr-buildversion-container'><\/div><\/div>");t.element.append(f);forerunner.ajax.getBuildVersion(function(n){t.element.find(".fr-buildversion-container").html(n)});t.element.find(".fr-us-form").on("submit",function(){return!1});t.element.find(".fr-us-submit-id").on("click",function(){t._saveSettings()});t.element.find(".fr-us-cancel").on("click",function(){t.closeDialog()});t.element.on(n.modalDialogGenericSubmit,function(){t._saveSettings()});t.element.on(n.modalDialogGenericCancel,function(){t.closeDialog()})},_getSettings:function(){var n=this,t,i;n.settings=n.options.$reportExplorer.reportExplorer("getUserSettings",!0);n.$resposiveUI=n.element.find(".fr-us-responsive-ui-id");t=n.settings.responsiveUI;n.$resposiveUI.prop("checked",t);n.$adminUI=n.element.find(".fr-us-admin-ui-id");i=n.settings.adminUI;n.$adminUI.prop("checked",i);n.$viewStyle=n.element.find(".fr-us-viewStyle-id");n.settings.viewStyle?n.$viewStyle.val(n.settings.viewStyle):n.$viewStyle.val("large")},_triggerClose:function(t){var i=this,r={isSubmit:t,settings:i.settings};i._trigger(n.close,null,r);forerunner.dialog.closeModalDialog(i.options.$appContainer,i)},_saveSettings:function(){var n=this,t=n.$resposiveUI.prop("checked"),i=n.$adminUI.prop("checked"),r=n.$viewStyle.val();if(n.settings.responsiveUI===t&&n.settings.adminUI===i&&n.settings.viewStyle===r){n.closeDialog();return}n.settings.responsiveUI=t;n.settings.adminUI=i;n.settings.viewStyle=r;forerunner.ajax.setUserSetting(n.settings);n.options.$reportExplorer.reportExplorer("saveUserSettings",n.settings);n._triggerClose(!0)},openDialog:function(){var n=this;n._getSettings();forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;n._triggerClose(!1)}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,n=forerunner.localize;$.widget(i.getFullname(i.reportExplorerSearchFolder),{options:{$reportExplorer:null,$appContainer:null},_create:function(){},_init:function(){var i=this,u,r;i.element.html("");i.element.off(t.modalDialogGenericSubmit);i.element.off(t.modalDialogGenericCancel);u=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-searchfolder",n.getLocData().searchFolder.title,"fr-sf-cancel",n.getLocData().searchFolder.cancel);r=new $("<div class='fr-core-dialog-innerPage fr-core-center'>"+u+"<div class='fr-sf-form-container'><form class='fr-core-dialog-form fr-sf-form'><table class='fr-sf-table'><tr><td><label class='fr-sf-label'>"+n.getLocData().searchFolder.name+":<\/label><\/td><td><input type='text' class='fr-core-input fr-sf-text fr-sf-foldername' name='foldername' required='true' /><span class='fr-sf-error-span' /><\/td><\/tr><tr><td><label class='fr-sf-label'>"+n.getLocData().searchFolder.tags+":<\/label><\/td><td><input type='text' class='fr-core-input fr-sf-text fr-sf-foldertags' name='tags' required='true' /><span class='fr-sf-error-span' /><\/td><\/tr><tr class='fr-sf-prompt'><td><\/td><td><label class='fr-sf-label-prompt'>"+n.getLocData().searchFolder.prompt+"<\/label><\/td><tr><\/table><\/form><\/div><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input type='button' class='fr-sf-submit-id fr-sf-button fr-core-dialog-button' value='"+n.getLocData().searchFolder.submit+"' /><\/div><div class='fr-sf-location' /><\/div><\/div>");i.element.append(r);i.element.find(".fr-sf-foldername").watermark(n.getLocData().searchFolder.namePlaceholder,forerunner.config.getWatermarkConfig());i.element.find(".fr-sf-foldertags").watermark(n.getLocData().searchFolder.tags,forerunner.config.getWatermarkConfig());i.$form=r.find(".fr-sf-form");i.$form.validate({errorPlacement:function(n,t){n.appendTo(t.siblings("span"))},highlight:function(n){$(n).addClass("fr-sf-error")},unhighlight:function(n){$(n).removeClass("fr-sf-error")}});i.$form.on("submit",function(){return!1});i.element.find(".fr-sf-cancel").on("click",function(){i.closeDialog()});i.element.find(".fr-sf-submit-id").on("click",function(){i._createSearchFolder()});i.element.on(t.modalDialogGenericSubmit,function(){i._createSearchFolder()});i.element.on(t.modalDialogGenericCancel,function(){i.closeDialog()})},_createSearchFolder:function(){var n=this,t,u;if(n.$form.valid()){var r=$.trim(n.element.find(".fr-sf-foldername").val()),f=$.trim(n.element.find(".fr-sf-foldertags").val()),i=f.split(",");for(t=0;t<i.length;t++)i[t]=$.trim(i[t]);u={searchFolderName:r,overwrite:!1,content:{name:r,tags:i.join(",")}};n.options.$reportExplorer.reportExplorer("setSearchFolder",u);n.closeDialog()}},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var r=forerunner.ssr.constants,u=r.widgets,t=r.events,n=forerunner.localize,i,f;$.widget(u.getFullname(u.forerunnerLinkedReport),$.forerunner.dialogBase,{options:{$appContainer:null,$reportExplorer:null,reportManagerAPI:null,rsInstance:null,iconClass:"fr-icons24x24-tags"},rootPath:"/",_create:function(){var n=this;n._super();n.guid=forerunner.helper.guidGen()},_init:function(){var t=this,r;i=n.getLocData().linkedReport;f=n.getLocData().common;t._super();t.$form.addClass("fr-linked-form");t.curPath=null;t.options.title||(t.options.title=i.title);r=new $("<div class='fr-linked-container'><div class='fr-linked-prompt fr-core-dialog-description'><\/div><div class='fr-linked-input-container fr-linked-dropdown-container'><label class='fr-linked-label fr-linked-tree-label' >"+i.location+"<\/label><input type='text' name='location' class='fr-core-input fr-linked-input fr-linked-location fr-core-cursorpointer' readonly='true' required='true' allowblank='false' nullable='false'/><div class='fr-linked-dropdown-iconcontainer fr-core-cursorpointer'><div class='fr-linked-dropdown-icon'><\/div><\/div><span class='fr-dlb-error-span'/><\/div><div class='fr-linked-input-container'><label class='fr-linked-label'>"+f.name+"<\/label><input type='text' name='linkedname' class='fr-core-input fr-linked-input fr-linked-name' autocomplete='off' required='true' /><span class='fr-dlb-error-span' /><\/div><\/div>");t.$formMain.html("");t.$formMain.append(r);t.$linkContainer=t.$formMain.find(".fr-linked-container");t.$prompt=t.$linkContainer.find(".fr-linked-prompt");t.$name=t.$linkContainer.find(".fr-linked-name");t.$location=t.$linkContainer.find(".fr-linked-location");t.$treeLabel=t.$linkContainer.find(".fr-linked-tree-label");t._bindEvents();t._reset()},_bindEvents:function(){var n=this;n._resetValidateMessage();n._validateForm(n.$form);n.$location.off("click");n.$location.on("click",function(){n._openPopup.call(n)});n.element.find(".fr-linked-dropdown-icon").off("click");n.element.find(".fr-linked-dropdown-icon").on("click",function(){n._openPopup.call(n)})},_submit:function(){var n=this;n.$form.valid()&&(n.isLinkedReport?n._setReportLink():n._createLinkedReport())},_reset:function(){var n=this;n.$name.val("");n.$location.removeAttr("title").val("")},_openPopup:function(){var n=this,t,i;n.initHeight=n.initHeight||n.$linkContainer.height();t=n.$location.width()+24;i=n.$location.catalogTree("toggleCatalog",t);i?n.$linkContainer.css({height:"220px"}):n.$linkContainer.css({height:n.initHeight})},setData:function(i){var r=this,f,e,u;r.reportType=i.Type;r.curPath=i.Path;r.linkedReportName=i.Name;r.isLinkedReport=r.reportType===forerunner.ssr.constants.itemType.linkedReport?!0:!1;r._reset();u={rootPath:"/",$appContainer:r.options.$appContainer,reportManagerAPI:r.options.reportManagerAPI,containerClass:"fr-linked-popup-container",catalogTreeClass:"fr-linked-tree-container",rsInstance:r.options.rsInstance};r.showLoadingIndictator();r.$location.off(t.catalogTreeGetCatalogComplete());r.$location.on(t.catalogTreeGetCatalogComplete(),function(){r.removeLoadingIndicator()});r.isLinkedReport?(r._getReportLink(),r.$name.attr("disabled",!0),f=n.getLocData().linkedReport.edit.format(r.curPath),e=n.getLocData().linkedReport.report,u.type="fullCatalog"):(r.$name.removeAttr("disabled"),f=n.getLocData().linkedReport.create.format(r.curPath),e=n.getLocData().linkedReport.locatiton,u.type="subCatalog");r.$prompt.text(f);r.$treeLabel.text(e);r.$location.catalogTree(u);r.$location.off(t.catalogTreeCatalogSelected());r.$location.on(t.catalogTreeCatalogSelected(),function(n,t){var i=t.path;r.$location.attr("title",i).val(i).valid();r.$linkContainer.css({height:r.initHeight})})},openDialog:function(){var n=this;forerunner.dialog.dialogLock=!0;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.dialogLock=!1;n._trigger(t.close,null,{$forerunnerLinkedReport:n.element,path:n.curPath});forerunner.dialog.closeModalDialog(n.options.$appContainer,n);n.initHeight&&n.$linkContainer.css({height:n.initHeight})},_getReportLink:function(){var n=this;forerunner.ajax.ajax({type:"GET",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/GetReportLink",async:!1,data:{path:n.curPath},success:function(t){n.$location.attr("title",t.linkedReport).val(t.linkedReport);n.$name.val(n.linkedReportName)},fail:function(){}})},_setReportLink:function(){var n=this,t=$.trim(n.$location.val());forerunner.ajax.ajax({type:"POST",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/SetReportLink",async:!0,data:{linkedReportPath:n.curPath,newLink:t},success:function(t){if(t.Exception){forerunner.dialog.showMessageBox(n.options.$appContainer,t.Exception.Message);console.log("Set linked report wrong.",t.Exception);return}n.closeDialog()},fail:function(){}})},_createLinkedReport:function(){var n=this,t=$.trim(n.$location.val()),i=$.trim(n.$name.val());forerunner.ajax.ajax({type:"POST",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/CreateLinkedReport",async:!0,data:{name:i,parent:t,link:n.curPath},success:function(t){if(t.Exception){forerunner.dialog.showMessageBox(n.options.$appContainer,t.Exception.Message);console.log("Create linked report wrong.",t.Exception);return}n.closeDialog()},fail:function(){}})}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,r=forerunner.ssr.constants.events,t=forerunner.localize,n,u=forerunner.helper;$.widget(i.getFullname(i.uploadFile),$.forerunner.dialogBase,{options:{iconClass:"fr-upf-upload-file-icon",itemType:"",parentFolder:"",$reportExplorer:null},_init:function(){var i=this,r,u,f,e;n=t.getLocData().uploadFile;i._super();i.options.title||(i.options.title=n.title);r=n.description.replace("{0}",i.options.parentFolder);u=$("<table><tr><td colspan='2'><label class='fr-upf-description fr-core-dialog-description'>"+r+"<\/label><\/td><\/tr><tr><td colspan='2' class='fr-upf-browse-btn-container'><input name='browse' type='button' autofocus='autofocus' value='"+n.browseBtn+"' title='"+n.browseBtn+"' class='fr-upf-browse-id fr-upf-browse fr-core-action-button'/><\/td><\/tr><tr><td class='fr-upf-label-cell'><label class='fr-upf-label'>"+n.uploadFileLabel+"<\/label><\/td><td><input name='filename' readonly class='fr-upf-file fr-upf-input' type='text' required='true'/><span class='fr-dlb-error-span'/><\/td><\/tr><tr><td><label class='fr-upf-label'>"+n.overwrite+"<\/label><\/td><td><input name='overwrite' class='fr-upf-overwrite-id fr-upf-checkbox' type='checkbox'/><\/td><\/tr><tr><td colspan='2'><div class='fr-upf-progess-container'><div class='fr-upf-progess-bar' /><div class='fr-upf-progress-text' /><\/div><\/td><\/tr><tr><input name='rsinstance' type='text' class='fr-core-hidden' value='"+i.options.rsInstance+"' /><input name='parentfolder' type='text' class='fr-core-hidden' value='"+i.options.parentFolder+"' /><input name='itemtype' type='text' class='fr-core-hidden' value='"+i.options.itemType+"' /><\/tr><\/table>");i.$formMain.html("");i.$formMain.append(u);f=i.options.reportManagerAPI+"UploadFile";i.$form.attr({action:f,method:"post",enctype:"multipart/form-data"});forerunner.device.isMSIE8()?(e=i.$submit.prop("outerHTML").replace(/type=[a-z]+/i,"type='submit'"),i.$submit.replaceWith(e)):i.$submit.attr({type:"submit"});i.$decsription=i.element.find(".fr-upf-description");i.$uploadFile=i.element.find(".fr-upf-file");i.$overwrite=i.element.find(".fr-upf-overwrite-id");i.$progressContainer=i.element.find(".fr-upf-progess-container");i.$progressBar=i.element.find(".fr-upf-progess-bar");i.$progress=i.element.find(".fr-upf-progress-text");i.$progressContainer.show();i.$form.ajaxForm({beforeSend:function(){var n="0%";i.$progress.text(n);i.$progressBar.width(n);i._hideSubmitError()},uploadProgress:function(n,t,r,u){var f=u+"%";i.$progress.text(f);i.$progressBar.width(f)},success:function(n,r,u){var f,e,o;if(i.$progressContainer.hide(),f=JSON.parse(u.responseText),e=JSON.parse(n),f.Warning)o=t.uploadFile.warningsMessage.replace("{0}",f.Warning),forerunner.dialog.showMessageBox(i.options.$appContainer,o,t.uploadFile.title);else if(e.Exception){i.$progressContainer.hide();i._showExceptionError(e);return}i.options.$reportExplorer.reportExplorer("refresh");i.closeDialog()},error:function(n){if(i.$progressContainer.hide(),n.status===400){forerunner.dialog.showMessageBox(i.options.$appContainer,t.uploadFile.overwriteMessage,t.uploadFile.overwriteTitle);return}i._showSubmitError(n.responseText)}});i._validateForm(i.$form);i.$uploadFile.watermark(n.uploadFileLabel,forerunner.config.getWatermarkConfig());i.$browseContainer=i.element.find(".fr-upf-browse-btn-container");i.$browseBtn=i.element.find(".fr-upf-browse-id")},_submit:function(){},openDialog:function(){var n=this;n._super()},onDialogVisible:function(){var n=this;n._super();n.$progressContainer.width(n.$decsription.width());n.$inputFile=new $("<input name='file' type=file class='fr-upf-transparent-input' />");n.$inputFile.on("change",function(){n._onChangeInputFile.apply(n,arguments)});n.$inputFile.css({top:n.$browseBtn.css("marginTop"),left:n.$browseBtn.css("marginLeft"),width:n.$browseBtn.css("width"),height:n.$browseBtn.css("height")});n.$browseContainer.append(n.$inputFile)},_onChangeInputFile:function(n){var t=this,i;forerunner.device.isMSIE()?i=n.target.value.replace(/C:\\fakepath\\/i,""):t.$inputFile[0]&&t.$inputFile[0].files&&t.$inputFile[0].files[0]&&t.$inputFile[0].files[0].name&&(i=t.$inputFile[0].files[0].name);t.$uploadFile.val(i)}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants.widgets,i=forerunner.ssr.constants.events,n=forerunner.localize,r=forerunner.helper;$.widget(t.getFullname(t.newFolder),$.forerunner.dialogBase,{options:{iconClass:"fr-nfd-new-folder-icon",parentFolder:"",$reportExplorer:null},_init:function(){var t=this,i=n.getLocData().newFolder,r,u;t._super();t.options.title||(t.options.title=i.title);r=i.description.replace("{0}",t.options.parentFolder);u=$("<div><label class='fr-nfd-description fr-core-dialog-description'>"+r+"<\/label><label class='fr-nfd-label'>"+i.name+"<\/label><input name='foldername' class='fr-nfd-name fr-core-input' type='text' required='true' autofocus='autofocus'/><span class='fr-dlb-error-span'/><label class='fr-nfd-label'>"+i.descriptionLabel+"<\/label><textarea name='folderdescription' rows='5' class='fr-nfd-folder-description fr-core-input' /><div class='fr-nfd-hidden-container'><input name='hide' class='fr-nfd-hidden' type='checkbox'/><label class='fr-nfd-hidden-label'>"+i.hide+"<\/label><\/div><\/div>");t.$formMain.html("");t.$formMain.append(u);t.$folderName=t.element.find(".fr-nfd-name");t.$folderDecsription=t.element.find(".fr-nfd-folder-description");t.$hidden=t.element.find(".fr-nfd-hidden");t._validateForm(t.$form);t.$folderName.watermark(i.name,forerunner.config.getWatermarkConfig())},_submit:function(){var t=this;t.$form.valid()&&(t._hideSubmitError(),forerunner.ajax.ajax({type:"POST",dataType:"text",async:!1,url:t.options.reportManagerAPI+"/NewFolder",data:{parentFolder:t.options.parentFolder,folderName:t.$folderName.val(),folderDecsription:t.$folderDecsription.val(),hidden:t.$hidden.is(":checked")?"on":"off",instance:t.options.rsInstance},success:function(n){var i=JSON.parse(n);if(i.Exception){t._showExceptionError(i);return}t.options.$reportExplorer.reportExplorer("refresh");t.closeDialog()},fail:function(i){if(i.status===400){forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().newFolder.fileExists,n.getLocData().newFolder.fileExists);return}t._showSubmitError(i.responseText)}}))},openDialog:function(){var n=this;n._super()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants,r=i.widgets,n=i.events,u=forerunner.localize,f,t;$.widget(r.getFullname(r.forerunnerMoveItem),$.forerunner.dialogBase,{options:{$appContainer:null,$reportExplorer:null,rsInstance:null,iconClass:"fr-icons24x24-tags"},_init:function(){var n=this,i;n._super();f=u.getLocData().common;t=u.getLocData().move;n.options.title||(n.options.title=t.title);n.curPath=null;i=new $("<div class='fr-move-container'><div class='fr-move-prompt fr-core-dialog-description'>"+t.prompt+"<\/div><div class='fr-move-input-container fr-move-dropdown-container'><label class='fr-move-label fr-move-tree-label' >"+t.location+"<\/label><input type='text' name='location' class='fr-core-input fr-move-input fr-move-location fr-core-cursorpointer' readonly='true' required='true' allowblank='false' nullable='false'/><div class='fr-move-dropdown-iconcontainer fr-core-cursorpointer'><div class='fr-move-dropdown-icon'><\/div><\/div><\/div><\/div>");n.$formMain.html("");n.$formMain.append(i);n.$moveContainer=n.$formMain.find(".fr-move-container");n.$location=n.$moveContainer.find(".fr-move-location");n._bindEvents()},_bindEvents:function(){var n=this;n.$location.off("click");n.$location.on("click",function(){n._openPopup.call(n)});n.element.find(".fr-move-dropdown-icon").off("click");n.element.find(".fr-move-dropdown-icon").on("click",function(){n._openPopup.call(n)})},setData:function(t){var i=this,r,u;i.curPath=t.Path;i.Name=t.Name;i.Type=t.Type;r=forerunner.helper.getParentPath(i.curPath);r=r===null||r===""?"/":r;i.$location.val(r);u={rootPath:"/",type:"subCatalog",$appContainer:i.options.$appContainer,reportManagerAPI:i.options.reportManagerAPI,containerClass:"fr-move-popup-container",catalogTreeClass:"fr-move-tree-container",rsInstance:i.options.rsInstance};i.$location.catalogTree(u);i.showLoadingIndictator();i.$location.off(n.catalogTreeGetCatalogComplete());i.$location.on(n.catalogTreeGetCatalogComplete(),function(){i.removeLoadingIndicator()});i.$location.off(n.catalogTreeCatalogSelected());i.$location.on(n.catalogTreeCatalogSelected(),function(n,t){var r=t.path;i.$location.attr("title",r).val(r);i.$moveContainer.css({height:i.initHeight})})},_openPopup:function(){var n=this,t,i;n.initHeight=n.initHeight||n.$moveContainer.height();t=n.$location.width()+24;i=n.$location.catalogTree("toggleCatalog",t);i?n.$moveContainer.css({height:"200px"}):n.$moveContainer.css({height:n.initHeight})},openDialog:function(){var n=this;forerunner.dialog.dialogLock=!0;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var t=this;forerunner.dialog.dialogLock=!1;t._trigger(n.close);forerunner.dialog.closeModalDialog(t.options.$appContainer,t);t.initHeight&&t.$moveContainer.css({height:t.initHeight})},_submit:function(){var n=this,t=n._generatePostData();if(t===null){n.closeDialog();return}forerunner.ajax.ajax({type:"POST",dataType:"JSON",url:forerunner.config.forerunnerAPIBase()+"ReportManager/MoveItem",data:t,success:function(t){if(t.Exception){forerunner.dialog.showMessageBox(n.options.$appContainer,t.Exception.Message);console.log("Set linked report wrong.",t.Exception);return}n.closeDialog()},fail:function(){}})},_generatePostData:function(){var n=this,t={curFullPath:n.curPath,newFullPath:null,instance:n.options.rsInstance},i=$.trim(n.$location.val()),r=i==="/"?i+n.Name:i+"/"+n.Name;return t.curFullPath===r?null:(t.newFullPath=r,t)}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){function n(n,t,i,r,u,f,e,o){this.RS=n;this.CurrObj=t;this.CurrObjIndex=i;this.CurrObjParent=r;this.$HTMLParent=u;this.Style=f;this.CurrLocation=e;this.ApplyBackgroundColor=o}function r(){this.ReportItems={};this.Height=0;this.LowestIndex=null}function t(n,t){this.Height=n;this.Width=t}function u(n){this.TopDelta=0;this.Height=0;this.Left=0;this.Index=n;this.IndexAbove=null;this.NewHeight=null;this.NewTop=null}function f(n,t,i){this.$tablix=n;this.$rowHeader=t;this.$colHeader=i}var i=forerunner.ssr.constants.widgets;$.widget(i.getFullname(i.reportRender),{options:{reportViewer:null,responsive:!1,renderTime:null},_create:function(){var n=this,t=forerunner.device.isTouch();if(n._defaultResponsizeTablix=forerunner.config.getCustomSettingsValue("DefaultResponsiveTablix","on").toLowerCase(),n._maxResponsiveRes=forerunner.config.getCustomSettingsValue("MaxResponsiveResolution",1280),n.options.reportViewer&&(n._currentWidth=n.options.reportViewer.element.width()),t)$(window).on("scrollstop",function(){n._lazyLoadTablix(n)});else $(window).on("scroll",function(){n._lazyLoadTablix(n)})},render:function(n,t,i){var r=this;r.reportObj=n.reportObj;r.Page=n;r._tablixStream={};r.RDLExt=i?i:{};r.RDLExt.ForceResponsive!==undefined&&(r.options.responsive=r.RDLExt.ForceResponsive);r._currentWidth=r.options.reportViewer.element.width();r.Page.Replay===undefined&&(r.Page.Replay={});r._createStyles(r.options.reportViewer);r._reRender();t!==!0&&r.layoutReport()},_reRender:function(){var t=this,i=t.element,r=t.options.reportViewer;t._rectangles=[];t._currentWidth=t.options.reportViewer.element.width();i.html("");$.each(t.reportObj.ReportContainer.Report.PageContent.Sections,function(u,f){t._writeSection(new n(r,f,u,t.reportObj.ReportContainer.Report.PageContent,i,""))});t._addPageStyle(r,t.reportObj.ReportContainer.Report.PageContent.PageLayoutStart.PageStyle,t.reportObj)},_addPageStyle:function(n,t,i){var r=this,f=r._getStyle(n,t),u=new $("<div class='fr-render-bglayer'><\/div>");u.attr("style",f);i.ReportContainer.Trial===1&&r.element.append(r._getWatermark());r.element.append(u)},_getWatermark:function(){var r="opacity:0.30;color: #d0d0d0;font-size: 120pt;display: inline-block ;position: fixed; float: left;margin: 0;left:0px;top:40px;  pointer-events: none;",f=forerunner.config.getCustomSettingsValue("WatermarkPostText",""),u,n,t,i;return forerunner.device.isMSIE8()||forerunner.device.isAndroid()?(u=$("<DIV/>").html("Evaluation <\/br><\/br>"+f),r+="z-index: -1;",u.attr("style",r),u):(n=document.createElementNS("http://www.w3.org/2000/svg","svg"),n.setAttribute("xlink","http://www.w3.org/1999/xlink"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("pointer-events","none"),r="opacity:0.10;color: #d0d0d0;font-size: 120pt;display: inline-block ;position: fixed; float: left;margin: 0;left:0px;top:40px; pointer-events: none;",r+=forerunner.device.isSafariPC()?"z-index: -1;":"z-index: 1000;",n.setAttribute("style",r),t=document.createElementNS("http://www.w3.org/2000/svg","text"),t.setAttribute("x","10"),t.setAttribute("y","160"),t.setAttribute("fill","#000"),t.setAttribute("pointer-events","none"),i=document.createElementNS("http://www.w3.org/2000/svg","tspan"),i.textContent="Evaluation",t.appendChild(i),i=document.createElementNS("http://www.w3.org/2000/svg","tspan"),i.setAttribute("x","10"),i.setAttribute("y","280"),i.textContent=f,t.appendChild(i),n.appendChild(t),n)},writeError:function(n){var i=this,r=i.options.reportViewer.locData.getLocData().errorTag,t;if(n.Exception.Type==="LicenseException")i.element.html($("<div class='Page' ><div class='fr-render-error-license Page'><div class='fr-render-error-license-container'><p class='fr-render-error-license-title'><\/p><br/><p class='fr-render-error-license-content'><\/p><\/div><\/div>")),i.options.reportViewer&&(t=i.element.find(".fr-render-error-license-title"),t.html(r.licenseErrorTitle),t=i.element.find(".fr-render-error-license-content"),t.html(r.licenseErrorContent));else if(i.element.html($("<div class='Page' ><div class='fr-render-error-message'><\/div><\/br><div class='fr-render-error-details'>"+r.moreDetail+"<\/div><div class='fr-render-error'><h3>"+r.serverError+"<\/h3><div class='fr-render-error fr-render-error-DetailMessage'><\/div><div class='fr-render-error fr-render-error-type'><\/div><div class='fr-render-error fr-render-error-targetsite'><\/div><div class='fr-render-error fr-render-error-source'><\/div><div class='fr-render-error fr-render-error-stacktrace'><\/div><\/div><\/div>")),i.options.reportViewer){t=i.element.find(".fr-render-error");t.hide();t=i.element.find(".fr-render-error-details");t.on("click",{$Detail:i.element.find(".fr-render-error")},function(n){n.data.$Detail.show();$(n.target).hide()});t=i.element.find(".fr-render-error-DetailMessage");t.append("<h4>"+r.message+":<\/h4>"+n.Exception.DetailMessage);t=i.element.find(".fr-render-error-type");t.append("<h4>"+r.type+":<\/h4>"+n.Exception.Type);t=i.element.find(".fr-render-error-targetsite");t.html("<h4>"+r.targetSite+":<\/h4>"+n.Exception.TargetSite);t=i.element.find(".fr-render-error-source");t.html("<h4>"+r.source+":<\/h4>"+n.Exception.Source);t=i.element.find(".fr-render-error-message");t.html(n.Exception.Message);t=i.element.find(".fr-render-error-stacktrace");t.html("<h4>"+r.stackTrace+":<\/h4>"+n.Exception.StackTrace)}},_writeSection:function(t){for(var i=this,u=i._getDefaultHTMLTable(),e=$("<TR/>"),o,s,h,c,f=t.CurrObj.Measurement?t.CurrObj.Measurement:t.CurrObjParent.Measurement,r=0;r<f.Count;r++)f.Measurements[r].Type==="PageHeader"&&(s=r),f.Measurements[r].Type==="PageFooter"&&(h=r),f.Measurements[r].Type==="BodyArea"&&(c=r);o=c>=0?f.Measurements[c]:i._getMeasurmentsObj(t.CurrObjParent,t.CurrObjIndex);t.CurrObj.PageHeader&&u.append(i._writeHeaderFooter(t,"PageHeader",s));t.CurrObjParent.PageHeader&&u.append(i._writeHeaderFooter(new n(t.RS,t.CurrObjParent,null,null,null,null,null),"PageHeader",s));e.attr("Style","width:"+i._getWidth(o.Width)+"mm;");i._setResonsiveWidth(i._getWidth(o.Width),e);u.append(e);$.each(t.CurrObj.Columns,function(r,u){var f=new $("<TD/>");f.append(i._writeRectangle(new n(t.RS,u,r,t.CurrObj,new $("<Div/>"),null,o)));e.append(f)});t.CurrObj.PageFooter&&u.append(i._writeHeaderFooter(t,"PageFooter",h));t.CurrObjParent.PageFooter&&u.append(i._writeHeaderFooter(new n(t.RS,t.CurrObjParent,null,null,null,null,null),"PageFooter",h));t.$HTMLParent.append(u)},_writeHeaderFooter:function(t,i,r){var u=this,f,o,e;if(t.CurrObj[i])return f=$("<TR/>"),o=$("<TD/>"),f.append(o),e=u._getMeasurmentsObj(t.CurrObj,r),f.attr("Style","width:"+u._getWidth(e.Width)+"mm;"),u._setResonsiveWidth(u._getWidth(e.Width),f),o.append(u._writeRectangle(new n(t.RS,t.CurrObj[i],r,t.CurrObj,new $("<DIV/>"),null,e))),f},_setResonsiveWidth:function(){var n=this;return},_writeRectangle:function(t){var o,e,h,f,r=this,s={},i=t.$HTMLParent,c,u;return h=t.CurrObj.Measurement.Measurements,c=r._getSharedElements(t.CurrObj.Elements.SharedElements),u=r._getRDLExt(t),u.FormAction&&(i=$("<form />"),i.attr("action",u.FormAction),u.FormName&&i.attr("name",u.FormName),u.FormMethod&&i.attr("method",u.FormMethod),t.$HTMLParent=i),u.IFrameSrc?(i=$("<iframe />"),i.attr("src",u.IFrameSrc),u.IFrameSeamless===!0&&i.addClass("fr-iframe-seamless"),t.$HTMLParent=i):u.CustomHTML?(i=$("<div />"),i.html(u.CustomHTML),t.$HTMLParent=i):$.each(t.CurrObj.ReportItems,function(u,c){f="";c.Type!=="Line"&&c.Elements&&(f+=r._getFullBorderStyle(c.Elements.NonSharedElements.Style));o=r._writeReportItems(new n(t.RS,c,u,t.CurrObj,new $("<Div/>"),f,h[u]));c.Type!=="Line"&&c.Type!=="Tablix"&&(o.addClass("fr-render-rec"),o.addClass(r._getClassName("fr-b-",c)));e=new $("<Div/>");e.append(o);f="";s[u]={};s[u].HTMLElement=e;s[u].Type=c.Type;c.Type==="Tablix"&&r._tablixStream[c.Elements.NonSharedElements.UniqueName].BigTablix===!0&&(s[u].BigTablix=!0);f+="position:absolute;";t.CurrObj.ReportItems[u].Element&&t.CurrObj.ReportItems[u].Elements.NonSharedElements.Style&&t.CurrObj.ReportItems[u].Elements.NonSharedElements.Style.BackgroundColor&&(f+="background-color:"+t.CurrObj.ReportItems[u].Elements.NonSharedElements.Style.BackgroundColor+";");e.attr("Style",f);e.append(o);i.append(e)}),f="position:relative;",t.CurrObjParent.Type!=="Tablix"&&(f+=r._getElementsStyle(t.RS,t.CurrObj.Elements),i.addClass(r._getClassName("fr-n-",t.CurrObj)),i.addClass(r._getClassName("fr-t-",t.CurrObj)),i.addClass(r._getClassName("fr-b-",t.CurrObj)),f+=r._getFullBorderStyle(t.CurrObj.Elements.NonSharedElements.Style)),u.FixedHeight&&(f+="overflow-y: scroll;height:"+r._convertToMM(u.FixedHeight)+"mm;"),u.FixedWidth&&(f+="overflow-x: scroll;width:"+r._convertToMM(u.FixedWidth)+"mm;"),r._AddExtIDs(u,i),r._writeActions(t,{},i),i.attr("Style",f),t.CurrObj.Elements.NonSharedElements.UniqueName&&r._writeUniqueName(i,t.CurrObj.Elements.NonSharedElements.UniqueName),r._writeBookMark(t),r._writeTooltip(t),r._rectangles.push({ReportItems:s,Measurements:h,HTMLRec:i,RIContext:t,RecExt:u}),i},layoutReport:function(n,t,i){var e=this,h=e.options.reportViewer.element.width(),s,r,l;if(i&&(e.RDLExt=i),h===0)return!0;if((Math.abs(e._currentWidth-h)>30||t)&&e.options.responsive&&e._defaultResponsizeTablix==="on"&&(e._currentWidth=h,e._reRender()),e._rectangles){for(s=0;s<e._rectangles.length;s++){var f=e._rectangles[s],u=e._getRectangleLayout(f.Measurements),c=f.Measurements,o=f.RIContext;for(r=0;r<forerunner.helper.objectSize(u.ReportItems);r++)u.ReportItems[r].NewHeight=f.ReportItems[r].Type==="Image"||f.ReportItems[r].Type==="Chart"||f.ReportItems[r].Type==="Gauge"||u.ReportItems[r].Type==="Map"||f.ReportItems[r].Type==="Line"?f.Measurements[r].Height:n?e._convertToMM(f.ReportItems[r].HTMLElement.outerHeight()+"px"):f.ReportItems[r].BigTablix?f.Measurements[r].Height:e._getHeight(f.ReportItems[r].HTMLElement),u.ReportItems[r].NewHeight>u.ReportItems[u.LowestIndex].NewHeight&&u.ReportItems[r].IndexAbove===u.ReportItems[u.LowestIndex].IndexAbove&&(u.LowestIndex=r),u.ReportItems[r].NewTop=u.ReportItems[r].IndexAbove===null?c[r].Top:parseFloat(u.ReportItems[u.ReportItems[r].IndexAbove].NewTop)+parseFloat(u.ReportItems[u.ReportItems[r].IndexAbove].NewHeight)+parseFloat(u.ReportItems[r].TopDelta),f.ReportItems[r].HTMLElement.css("top",e._roundToTwo(u.ReportItems[r].NewTop)+"mm"),f.ReportItems[r].HTMLElement.css("left",e._roundToTwo(u.ReportItems[r].Left)+"mm");(f.RecExt.FixedHeight||f.RecExt.FixedWidth)&&f.HTMLRec.removeClass("fr-render-rec");o.CurrLocation&&(f.RecExt.FixedWidth===undefined&&f.HTMLRec.css("width",e._getWidth(o.CurrLocation.Width)+"mm"),e._setResonsiveWidth(e._getWidth(o.CurrLocation.Width),f.HTMLRec),o.CurrObj.ReportItems.length===0?f.HTMLRec.css("height",e._roundToTwo(o.CurrLocation.Height+1)+"mm"):(l=parseFloat(u.ReportItems[u.LowestIndex].NewTop)+parseFloat(u.ReportItems[u.LowestIndex].NewHeight)+(parseFloat(o.CurrLocation.Height)-(parseFloat(c[u.LowestIndex].Top)+parseFloat(c[u.LowestIndex].Height)))+0,f.RecExt.FixedHeight===undefined&&f.HTMLRec.css("height",e._roundToTwo(l)+"mm")))}return e.element.hide().show(0),!1}},_getRectangleLayout:function(n){var t=new r,i=this;return($.each(n,function(r,f){var e,o,s;for(t.ReportItems[r]=new u(r),e=t.ReportItems[r],e.Left=f.Left,i._isNull(t.LowestIndex)?t.LowestIndex=r:f.Top+f.Height>n[t.LowestIndex].Top+n[t.LowestIndex].Height&&(t.LowestIndex=r),o=0;o<n.length;o++)s=n[o].Top+n[o].Height,f.Top>s&&(e.IndexAbove?s>n[e.IndexAbove].Top+n[e.IndexAbove].Height&&(e.IndexAbove=o,e.TopDelta=f.Top-s):(e.IndexAbove=o,e.TopDelta=f.Top-s))}),i.options.responsive&&i._maxResponsiveRes>i._currentWidth)?i._getResponsiveRectangleLayout(n,t):t},_getResponsiveRectangleLayout:function(n,t){var u=this,i=u._convertToMM(u._currentWidth+"px"),r=!1;return $.each(n,function(u,f){var e=t.ReportItems[u],c,h,s,l,a,o;if(e.OrgBottom=f.Top+f.Height,e.OrgRight=f.Left+f.Width,e.OrgIndexAbove=e.IndexAbove,c=!1,h=!1,e.OrgRight>i)for(e.Left=0,s=0;s<n.length;s++)l=n[s].Top+n[s].Height,a=n[s].Left+n[s].Width,!h&&u!==s&&f.Top<n[s].Top&&e.OrgBottom>n[s].Top&&(t.ReportItems[s].IndexAbove=u,t.ReportItems[s].TopDelta=1,u===t.LowestIndex&&(t.LowestIndex=t.ReportItems[s].Index),r=!0,h=!0),u!==s&&f.Top>=n[s].Top&&f.Top<l&&u>s&&(e.IndexAbove===null||t.ReportItems[e.IndexAbove].OrgBottom<=t.ReportItems[s].OrgBottom)&&(e.IndexAbove=s,e.TopDelta=1,s===t.LowestIndex&&(t.LowestIndex=u),c=!0,r=!0);if(r||u===n.length-1)for(o=0;o<e.Index;o++)e.IndexAbove===t.ReportItems[o].IndexAbove&&e.OrgRight<=i&&t.ReportItems[o].OrgRight>i&&(e.IndexAbove=o,t.LowestIndex===o&&(t.LowestIndex=e.Index)),(t.ReportItems[o].OrgRight>i||e.OrgRight>i)&&(e.IndexAbove===t.ReportItems[o].IndexAbove?(e.IndexAbove=t.ReportItems[o].Index,e.TopDelta=1,t.LowestIndex===t.ReportItems[o].Index&&(t.LowestIndex=e.Index)):t.ReportItems[o].OrgIndexAbove===e.IndexAbove&&o>e.Index&&(t.ReportItems[o].IndexAbove=e.Index,t.ReportItems[o].TopDelta=1,t.LowestIndex===e.Index&&(t.LowestIndex=t.ReportItems[o].Index))),e.IndexAbove===t.ReportItems[o].IndexAbove&&e.Left>=n[o].Left&&e.Left<t.ReportItems[o].Left+n[o].Width&&(e.IndexAbove=t.ReportItems[o].Index,e.TopDelta=1,t.LowestIndex===t.ReportItems[o].Index&&(t.LowestIndex=e.Index))}),t},_writeReportItems:function(n){var t=this;switch(n.CurrObj.Type){case"RichTextBox":return t._writeRichText(n);case"Image":case"Chart":case"Gauge":case"Map":return t._writeImage(n);case"Tablix":return t._writeTablix(n);case"Rectangle":return t._writeRectangle(n);case"SubReport":return t._writeSubreport(n);case"Line":return t._writeLine(n)}},_getRDLExt:function(n){var i=this,t={};return i.RDLExt&&(t=i.RDLExt[i._getSharedElements(n.CurrObj.Elements.SharedElements).Name],t||(t={})),t},_getRDLExtShared:function(){var t=this,n={};return t.RDLExt&&(n=t.RDLExt.SharedActions,n||(n={})),n},_writeEasySubmit:function(n,t){var i=this;if(t.EasySubmitURL&&t.EasySubmitType){n.on("click",{reportViewer:i.options.reportViewer.element,element:n,getInputs:i._getInputsInRow,easySubmit:i._submitRow,veryEasySubmit:i._easySubmit,deleteCurrentRow:i._delCurrentRow,insertNewRow:i._insNewRow},function(n){n.data.veryEasySubmit(n,t.EasySubmitType,t.EasySubmitURL,t.EasySubmitDatatype,t.EasySubmitSuccess,t.EasySubmitFail,t.EasySubmitReportPath)});n.addClass("fr-core-cursorpointer")}},_writeRichText:function(n){var u=n.Style,i=$("<div/>"),e=null,t=this,r=t._getRDLExt(n),o,h,c,l,y,p,f;if(u+="",t._getMeasurements(t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),!0)!==""&&(u+=t._getMeasurements(t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),!0)),(n.CurrObjParent.Type!=="Tablix"||n.ApplyBackgroundColor)&&(u+=t._getElementsNonTextStyle(n.RS,n.CurrObj.Elements),n.$HTMLParent.addClass(t._getClassName("fr-n-",n.CurrObj))),n.$HTMLParent.attr("Style",u),n.$HTMLParent.addClass("fr-r-rT"),u="",r.InputType&&(r.InputType==="textarea"?(i=$("<textarea name='"+r.InputName+"'/>"),u+="resize:none;"):i=$("<input type='"+r.InputType+"' name='"+r.InputName+"'/>"),u+="height:auto;box-sizing:border-box;",r.InputRequired===!0&&i.attr("required",!0),r.InputSubmit&&i.attr("data-submitType",r.InputSubmit),i.addClass("fr-input-"+r.InputType)),t._writeEasySubmit(i,r),r.Align==="justify"&&(u+="white-space:normal;text-align:"+r.Align+";"),t._getSharedElements(n.CurrObj.Elements.SharedElements).IsToggleParent===!0||n.CurrObj.Elements.NonSharedElements.IsToggleParent===!0){o=$("<div/>");o.attr("id",n.CurrObj.Elements.NonSharedElements.UniqueName);o.html("&nbsp");n.CurrObj.Elements.NonSharedElements.ToggleState!==undefined&&n.CurrObj.Elements.NonSharedElements.ToggleState===!0?o.addClass("fr-render-drilldown-collapse"):o.addClass("fr-render-drilldown-expand");o.on("click",{ToggleID:n.CurrObj.Elements.NonSharedElements.UniqueName},function(n){var i=$(this).parent().parent().attr("data-uniqName");t.options.reportViewer.toggleItem(n.data.ToggleID,i)});o.addClass("fr-core-cursorpointer");n.$HTMLParent.append(o)}if(t._getSharedElements(n.CurrObj.Elements.SharedElements).CanSort!==undefined){e=$("<div/>");e.html("&nbsp");h="None";c=forerunner.ssr.constants.sortDirection;n.CurrObj.Elements.NonSharedElements.SortState===2?(e.attr("class","fr-render-sort-descending"),h=c.desc):n.CurrObj.Elements.NonSharedElements.SortState===1?(e.attr("class","fr-render-sort-ascending"),h=c.asc):e.attr("class","fr-render-sort-unsorted");e.on("click",{Viewer:n.RS,SortID:n.CurrObj.Elements.NonSharedElements.UniqueName,Direction:h},function(n){n.data.Viewer.sort(n.data.Direction,n.data.SortID,!n.shiftKey)});u+="width:"+(t._getWidth(n.CurrLocation.Width)-6)+"mm;";n.$HTMLParent.append(e)}if(t._writeActions(n,n.CurrObj.Elements.NonSharedElements,i),n.CurrObj.Elements.NonSharedElements.UniqueName&&t._writeUniqueName(i,n.CurrObj.Elements.NonSharedElements.UniqueName),l=t._getTextDirection(n.CurrObj.Elements),l!==""?(u+="width:"+n.CurrLocation.Height+"mm;height:"+t._getWidth(n.CurrLocation.Width)+"mm;",u+="position:absolute;",forerunner.device.isMSIE8()||(y=-(t._getWidth(n.CurrLocation.Width)-n.CurrLocation.Height)/2,p=-(n.CurrLocation.Height-t._getWidth(n.CurrLocation.Width))/2,u+="left:"+p+"mm;top:"+y+"mm;"),i.addClass(l)):i.addClass("fr-r-fS"),f=null,n.CurrObj.Paragraphs.length===0)f=t._getSharedElements(n.CurrObj.Elements.SharedElements).Value?t._getSharedElements(n.CurrObj.Elements.SharedElements).Value:n.CurrObj.Elements.NonSharedElements.Value,r&&r.localize&&(f=forerunner.localize.getLocalizedValue(f,r.localize)),f?(f=t._getNewLineFormatText(f),r.InputType?(i.attr("data-origVal",f),i.val(f)):i.text(f),r.InputReadOnly===!0&&i.attr("readonly","readonly"),u+=t._getElementsTextStyle(n.CurrObj.Elements),n.CurrObj.Elements.NonSharedElements.TypeCode&&(t._getSharedElements(n.CurrObj.Elements.SharedElements).TextAlign===0||t._getSharedElements(n.CurrObj.Elements.SharedElements).Style.TextAlign===0)&&(u+="text-align:"+t._getTextAlign(0,n.CurrObj.Elements.NonSharedElements)+";")):(i.html("&nbsp"),u+="text-decoration:none;"),i.addClass(t._getClassName("fr-t-",n.CurrObj));else{var a=null,v={},s={};s.Root="";u+=t._getElementsTextStyle(n.CurrObj.Elements);$.each(n.CurrObj.Paragraphs,function(n,i){var r=t._getSharedElements(i.Paragraph.SharedElements).ListLevel,u;a===null&&(a=r);s[r]||(s[r]=[]);v[r]=i.Paragraph.NonSharedElements.UniqueName;u=v[r-1]?v[r-1]:"Root";u={Parent:u,Value:i};s[r].push(u)});t._writeRichTextItem(n,s,a,"Root",i)}return t._writeBookMark(n),t._writeTooltip(n),i.attr("Style",u),i.addClass(t._getClassName("fr-t-",n.CurrObj)),i.addClass("fr-r-t"),t._AddExtIDs(r,i),n.$HTMLParent.append(i),e&&n.$HTMLParent.append(e),n.$HTMLParent},_writeRichTextItem:function(n,t,i,r,u){var e=null,f=this;$.each(t[i],function(o,s){var c,a,v,h,l,p,y;if(s.Parent===r){for(a="font-size:small;",s=s.Value,f._getSharedElements(s.Paragraph.SharedElements).ListStyle===1?(e&&e.is("ol")||(e=new $("<OL />")),e.addClass(f._getListStyle(1,f._getSharedElements(s.Paragraph.SharedElements).ListLevel)),c=new $("<LI />")):f._getSharedElements(s.Paragraph.SharedElements).ListStyle===2?(e&&e.is("ul")||(e=new $("<UL />")),e.addClass(f._getListStyle(2,f._getSharedElements(s.Paragraph.SharedElements).ListLevel)),c=new $("<LI />")):(e&&e.is("div")||(e=new $("<DIV />")),c=new $("<DIV />")),a+=f._getMeasurements(f._getMeasurmentsObj(s,i)),a+=f._getElementsStyle(n.RS,s.Paragraph),v=f._getRDLExt(n),v.Align==="justify"&&(a+="white-space:normal;text-align:"+v.Align+";"),c.attr("Style",a),c.addClass(f._getClassName("fr-n-",s.Paragraph)),c.addClass(f._getClassName("fr-t-",s.Paragraph)),f._writeUniqueName(c,s.Paragraph.NonSharedElements.UniqueName),h=0;h<s.TextRunCount;h++)p=!0,s.TextRuns[h].Elements.NonSharedElements.ActionInfo?(l=new $("<A />"),f._writeActions(n,s.TextRuns[h].Elements.NonSharedElements,l)):l=new $("<SPAN />"),f._getSharedElements(s.TextRuns[h].Elements.SharedElements).Value&&f._getSharedElements(s.TextRuns[h].Elements.SharedElements).Value!==""?l.text(f._getNewLineFormatText(f._getSharedElements(s.TextRuns[h].Elements.SharedElements).Value)):s.TextRuns[h].Elements.NonSharedElements.Value&&s.TextRuns[h].Elements.NonSharedElements.Value!==""?l.text(f._getNewLineFormatText(s.TextRuns[h].Elements.NonSharedElements.Value)):(l.html("&nbsp"),p=!1),f._writeUniqueName(l,s.TextRuns[h].Elements.NonSharedElements.UniqueName),p&&(y="",y+=f._getMeasurements(f._getMeasurmentsObj(s.TextRuns[h],h)),y+=f._getElementsTextStyle(s.TextRuns[h].Elements),v.Align==="justify"&&(y+="white-space:normal;text-align:"+v.Align+";"),l.attr("Style",y),l.addClass(f._getClassName("fr-t-",s.TextRuns[h]))),c.append(l);t[i+1]&&f._writeRichTextItem(n,t,i+1,s.Paragraph.NonSharedElements.UniqueName,c);e.addClass("fr-r-pL");e.append(c);u.append(e)}})},_writeUniqueName:function(n,t){n.attr("data-uniqName",t)},_getImageURL:function(n,t){var i=this,r;return i.imageList||(i.imageList={}),i.imageList[t]||(r=i.options.reportViewer.options.reportViewerAPI+"/Image/?",r+="SessionID="+i.options.reportViewer.sessionID,r+="&ImageID="+t,r+="&"+i.options.renderTime,i.options.reportViewer.options.rsInstance&&(r+="&instance="+i.options.reportViewer.options.rsInstance),i.imageList[t]=r),i.imageList[t]},_writeImage:function(n){var i=$("<img/>"),t=this,u=$("<div/>").addClass("fr-render-image"),w=t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),f=n.Style,v=t._getRDLExt(n),o,s,r,e,h,c,l,a,y,p;f+=t._getTextStyle(n.CurrObj.Elements);u.addClass(t._getClassName("fr-t-",n.CurrObj));n.CurrObjParent.Type!=="Tablix"&&(f+=t._getElementsStyle(n.RS,n.CurrObj.Elements),u.addClass(t._getClassName("fr-n-",n.CurrObj)));f+=t._getMeasurements(w,!0);s="";e=t._getSharedElements(n.CurrObj.Elements.SharedElements).Sizing;e||(e=0);h=t._getPaddingSize(n.CurrObj,"Left")+t._getPaddingSize(n.CurrObj,"Right");c=t._getPaddingSize(n.CurrObj,"Top")+t._getPaddingSize(n.CurrObj,"Bottom");n.CurrObj.Type==="Image"?(o=n.CurrObj.Elements.NonSharedElements.ImageDataProperties.ImageName,n.CurrObj.Elements.NonSharedElements.ImageDataProperties.NonSharedImageDataProperties&&(r=n.CurrObj.Elements.NonSharedElements.ImageDataProperties.NonSharedImageDataProperties.ImageConsolidationOffsets)):(o=n.CurrObj.Elements.NonSharedElements.StreamName,n.CurrObj.Elements.NonSharedElements.ImageConsolidationOffsets&&(r=n.CurrObj.Elements.NonSharedElements.ImageConsolidationOffsets,f+="width:"+r.Width+"px;height:"+r.Height+"px"));r&&(s+="position:relative;top:"+r.Top*-1+"px;left:"+r.Left*-1+"px");n.CurrObj.Elements.NonSharedElements.ActionImageMapAreas&&i.attr("useMap","#Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName);i.attr("alt",t.options.reportViewer.locData.getLocData().messages.imageNotDisplay);i.attr("src",this._getImageURL(n.RS,o));t._writeActions(n,n.CurrObj.Elements.NonSharedElements,$(i));t._writeEasySubmit($(i),v);t._writeBookMark(n);t._writeTooltip(n);n.CurrObj.Elements.NonSharedElements.UniqueName&&t._writeUniqueName($(i),n.CurrObj.Elements.NonSharedElements.UniqueName);r?(l=r.Width,a=r.Height):(l=n.CurrLocation.Width*3.78,a=n.CurrLocation.Height*3.78);u.append(i);u.attr("style",f);n.$HTMLParent.append(u);t._writeActionImageMapAreas(n,l,a,r);i.attr("style",s);forerunner.config.getCustomSettingsValue("ImageAreaHighligh","off")!=="on"||forerunner.device.isMSIE8()||(y=forerunner.config.getCustomSettingsValue("ImageAreaHighlighBorderColor","ff0000"),p=forerunner.config.getCustomSettingsValue("ImageAreaHighlighBorderWidth","1"),window.setTimeout(function(){$(u).FRmaphilight({strokeColor:y,strokeWidth:p})},200));i.css("border","0").css("text-decoration","none");switch(e){case 1:$(i).css("height",n.CurrLocation.Height-c+"mm");$(i).css("width",n.CurrLocation.Width-h+"mm");break;case 2:case 3:$(i).css("height",n.CurrLocation.Height+"mm");$(i).css("width",n.CurrLocation.Width+"mm");i.on("load",function(){var u=t._getNatural(this),f,o;r?(f=r.Width,o=r.Height):(f=i.width,o=i.height);t._resizeImage(this,e,u.height,u.width,n.CurrLocation.Height-c,n.CurrLocation.Width-h)})}return t._AddExtIDs(v,i),n.$HTMLParent},_delCurrentRow:function(n){var r=this,t=$(n).parent().parent().parent(),i;t.is("td")===!0&&(t=t.parent());t.hasClass("fr-render-row")?(i=t.next(),i.hasClass("fr-render-respRow")&&$(i).remove()):(i=t.prev(),i.hasClass("fr-render-row")&&$(i).remove());$(t).remove()},_insNewRow:function(n,t){var o=this,i=$(n).parent().parent().parent(),f,r,u,e;if(i.is("td")===!0&&(i=i.parent()),i.hasClass("fr-render-colHeader")&&(i=i.next(),i&&i.hasClass("fr-render-respRow")&&(i=i.next())),i&&!i.hasClass("fr-render-row")&&(i=i.next()),i&&(f=i.next(),i.before(i.clone(!0,!0)),r=i.prev(),u=r.find("*").filter(":input").not("input[type=button], :input[type=submit], :input[type=reset]"),t.indexOf("clearInputs")>=0&&(u.val(""),u.attr("data-origval","")),t.indexOf("removeReadOnly")>=0&&u.attr("readonly",!1)),f&&f.hasClass("fr-render-respRow")){r.after(f.clone(!0,!0));r=r.next();u=r.find("*").filter(":input").not("input[type=button], :input[type=submit], :input[type=reset]");t.indexOf("clearInputs")>=0&&(u.val(""),u.attr("data-origval",""));t.indexOf("removeReadOnly")>=0&&u.attr("readonly",!1);e=r.prev().find(".fr-render-respIcon");e.off("click");e.on("click",{icon:e,ExtRow:r},function(n){var t=!n.data.ExtRow.is(":visible");t?(n.data.ExtRow.show(),$(n.data.icon).addClass("fr-render-respTablix-collapse"),$(n.data.icon).removeClass("fr-render-respTablix-expand")):(n.data.ExtRow.hide(),$(n.data.icon).removeClass("fr-render-respTablix-collapse"),$(n.data.icon).addClass("fr-render-respTablix-expand"))})}},_getInputsInRow:function(n,t){var f=this,r=[],u=0,i;if(t===undefined&&(t="auto"),i=$(n).parent().parent().parent(),i.is("td")===!0&&(i=i.parent()),i.is("tr")===!1)return r;while(u<2)$.each(i.find("input, textarea"),function(n,i){var u={};u.name=$(i).attr("name");u.value=$(i).val();u.origionalValue=$(i).attr("data-origVal");u.type=$(i).attr("type");u.submitType=$(i).attr("data-submitType");u.origionalValue||(u.origionalValue="");t==="all"&&r.push(u);t==="auto"&&(u.submitType==="always"||u.submitType==="changed"&&u.value!==u.origionalValue)&&r.push(u)}),u++,i.hasClass("fr-render-row")?(i=i.next(),i.hasClass("fr-render-respRow")===!1&&(u=2)):i.hasClass("fr-render-respRow")&&(i=i.prev(),i.hasClass("fr-render-row")===!1&&(u=2));return r},_submitRow:function(n,t,i,r,u,f,e){var l=this,o={},c,s,h;if(e){for(o.ReportPath=e,c={},c.ParamsList=new Array(n.length),s=0;s<n.length;s++)c.ParamsList[s]={Parameter:n[s].name,Value:n[s].value};o.ParameterList=JSON.stringify(c)}else{for(h=0;h<n.length;h++)o[n[h].name]=n[h].value;r==="json"&&(o=JSON.stringify(o))}forerunner.ajax.ajax({type:t,url:i,data:o,async:!0}).done(function(n){e&&JSON.parse(n).Exception?f():u()}).fail(f)},_easySubmit:function(n,t,i,r,u,f,e){var o;u||(u="alert('Success');");f||(f="alert('Failed');");try{o=new Function("e",u);u=o}catch(l){o=undefined}try{o=new Function("e",f);f=o}catch(l){o=undefined}var s=function(){u(n)},h=function(){f(n)},c=n.data.getInputs(n.currentTarget,"auto");n.data.easySubmit(c,t,i,r,s,h,e)},_writeActions:function(n,t,i){var u=this,r;if(t.ActionInfo)for(r=0;r<t.ActionInfo.Count;r++)this._writeAction(n,t.ActionInfo.Actions[r],i);u._writeRDLExtActions(n,i)},_writeRDLExtActions:function(n,t,i){var r=this;forerunner.ssr._writeRDLExtActions(r._getSharedElements(n.CurrObj.Elements.SharedElements).Name,r.RDLExt,t,i,r.options.reportViewer.element,r._getInputsInRow,r._submitRow,undefined,undefined,r._delCurrentRow,r._insNewRow)},_writeAction:function(n,t,i){var r=this;if(t.HyperLink){i.addClass("fr-core-cursorpointer");i.attr("href","#");i.on("click",{HyperLink:t.HyperLink},function(n){r._stopDefaultEvent(n);forerunner.config.getCustomSettingsValue("URLActionNewTab","off")==="on"?window.open(n.data.HyperLink,"_blank"):location.href=n.data.HyperLink})}else if(t.BookmarkLink){i.attr("href","#");i.addClass("fr-core-cursorpointer");i.on("click",{BookmarkID:t.BookmarkLink},function(n){r._stopDefaultEvent(n);r.options.reportViewer.navigateBookmark(n.data.BookmarkID)})}else if(t.DrillthroughId){i.addClass("fr-core-cursorpointer");i.attr("href","#");i.on("click",{DrillthroughId:t.DrillthroughId},function(n){r._stopDefaultEvent(n);r.options.reportViewer.navigateDrillthrough(n.data.DrillthroughId)})}},_writeActionImageMapAreas:function(n,t,i,r){var p=n.CurrObj.Elements.NonSharedElements.ActionImageMapAreas,v=this,s=0,h=0,c,a,u,f,e,y,l,w,o;if(r&&(s=r.Left,h=r.Top),p){for(c=$("<MAP/>"),v._writeUniqueName(c,"Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName),c.attr("name","Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName),c.attr("id","Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName),a=0;a<p.Count;a++)for(u=p.ActionInfoWithMaps[a],f=0;f<u.ImageMapAreas.Count;f++){e=$("<AREA />");e.attr("tabindex",a+1);e.attr("style","text-decoration:none");v._writeTooltipInternal(u.ImageMapAreas.ImageMapArea[f].Tooltip,n.$HTMLParent,e,s,h);u.Actions&&v._writeAction(n,u.Actions[0],e);v._writeRDLExtActions(n,e,!0);l="";switch(u.ImageMapAreas.ImageMapArea[f].ShapeType){case 0:y="rect";l=parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[0]*t/100,10)+s+","+(parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[1]*i/100,10)+h)+","+(parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[2]*t/100,10)+s)+","+(parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[3]*i/100,10)+h);break;case 1:for(y="poly",w=u.ImageMapAreas.ImageMapArea[f].CoorCount,o=0;o<w;o++)l+=o%2==0?parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[o]*t/100,10)+s:parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[o]*i/100,10)+h,o<w-1&&(l+=",");break;case 2:y="circ";l=parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[0]*t/100,10)+s+","+(parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[1]*i/100,10)+h)+","+parseInt(u.ImageMapAreas.ImageMapArea[f].Coordinates[2]*t/100,10)}e.attr("shape",y);e.attr("coords",l);c.append(e)}n.$HTMLParent.append(c)}},_resizeImage:function(n,t,i,r,u,f){var o=0,s=this,e,h;if(i=s._convertToMM(i+"px"),r=s._convertToMM(r+"px"),e=$(n),i!==0&&r!==0)switch(t){case 0:e.css("height",i+"mm");e.css("width",r+"mm");break;case 1:e.css("height",u+"mm");e.css("width",f+"mm");break;case 2:(i/u>1||r/f>1)&&(i/u>=r/f?(o=u/i,e.css("height",u+"mm"),e.css("width",r*o+"mm"),e.css("max-height",u+"mm"),e.css("max-width",r*o+"mm"),e.css("min-height",u+"mm"),e.css("min-width",r*o+"mm")):(o=f/r,e.css("width",f+"mm"),e.css("height",i*o+"mm"),e.css("max-width",f+"mm"),e.css("max-height",i*o+"mm"),e.css("min-width",f+"mm"),e.css("min-height",i*o+"mm")));break;case 3:h=s._getNatural(n);e.css("height",s._convertToMM(h.height+"px")+"mm");e.css("width",s._convertToMM(h.width+"px")+"mm");e.css("max-height",s._convertToMM(h.height+"px")+"mm");e.css("max-width",s._convertToMM(h.width+"px")+"mm")}},_writeTablixCell:function(i,r,u,f,e){var s=new $("<TD/>"),h="",c,l,o=this,a,v,y,p,w;if(h="",r.Cell&&(o._getElements(r.Cell.ReportItem).NonSharedElements&&(h+=o._getFullBorderStyle(o._getElements(r.Cell.ReportItem).NonSharedElements.Style)),s.addClass(o._getClassName("fr-b-",r.Cell.ReportItem))),a=r.ColumnIndex,v=o._isNull(f)?r.RowIndex:f,c=o._getWidth(i.CurrObj.ColumnWidths.Columns[a].Width),l=i.CurrObj.RowHeights.Rows[v].Height,h+="width:"+c+"mm;max-width:"+c+"mm;",h+=forerunner.device.isMSIE()?"min-height:"+l+"mm;":"height:"+l+"mm;",r.RowSpan!==undefined){for(y=v+1;y<v+r.RowSpan;y++)l+=i.CurrObj.RowHeights.Rows[y].Height;s.attr("rowspan",r.RowSpan)}if(r.ColSpan!==undefined){for(p=a+1;p<a+r.ColSpan;p++)c+=o._getWidth(i.CurrObj.ColumnWidths.Columns[p].Width);s.attr("colspan",r.ColSpan)}return r.Cell?(o._getElements(r.Cell.ReportItem).NonSharedElements.Style&&o._getElements(r.Cell.ReportItem).NonSharedElements.Style.BackgroundColor&&(h+="background-color:"+o._getElements(r.Cell.ReportItem).NonSharedElements.Style.BackgroundColor+";"),s.addClass(o._getClassName("fr-n-",r.Cell.ReportItem)),s.attr("Style",h),s.addClass("fr-r-tC"),w=o._writeReportItems(new n(i.RS,r.Cell.ReportItem,u,i.CurrObj,new $("<Div/>"),"",new t(l,c))),w.addClass("fr-r-tCI"),e&&w.prepend(e),s.append(w)):s.html("&nbsp"),s},_AddExtIDs:function(n,t){n.ID&&t.attr("id",n.ID);n.Class&&t.addClass(n.Class)},_writeTablix:function(n){var t=this,o=t._getDefaultHTMLTable(),l="",s=new $("<TABLE/>").addClass("fr-render-tablix-header"),e=new $("<TABLE/>").addClass("fr-render-tablix-header"),u,a,w,c,y;e.attr("CELLSPACING",0);e.attr("CELLPADDING",0);var b=!1,k=!1,i={isResp:!1};if(l+=t._getElementsStyle(n.RS,n.CurrObj.Elements),l+=t._getFullBorderStyle(n.CurrObj.Elements.NonSharedElements),o.addClass("fr-render-tablix"),o.addClass(t._getClassName("fr-n-",n.CurrObj)),o.addClass(t._getClassName("fr-t-",n.CurrObj)),o.addClass(t._getClassName("fr-b-",n.CurrObj)),u=t._getRDLExt(n),t._AddExtIDs(u,o),n.CurrObj.ColumnWidths){var d=$("<colgroup/>"),tt=$("<colgroup/>"),p=0,it=t._convertToMM(t._currentWidth+"px"),g=n.CurrLocation.Width,r,ft=t._getSharedElements(n.CurrObj.Elements.SharedElements);if(i.Columns=new Array(n.CurrObj.ColumnWidths.ColumnCount),i.ColumnCount=n.CurrObj.ColumnWidths.ColumnCount,i.ColumnHeaders={},i.ColHeaderRow=0,i.BackgroundColor="#F2F2F2",u.ColumnHeaders)for(a=0;a<u.ColumnHeaders.length;a++)i.ColumnHeaders[u.ColumnHeaders[a]]=a;if(u.ColHeaderRow!==undefined&&(i.ColHeaderRow=u.ColHeaderRow-1),u.BackgroundColor!==undefined&&(i.BackgroundColor=u.BackgroundColor),t.options.responsive&&t._defaultResponsizeTablix==="on"&&t._maxResponsiveRes>t._currentWidth){var rt=!0,v=n.CurrObj.ColumnWidths.ColumnCount,ut=n.CurrObj.ColumnWidths.Columns,nt=-1,h;if(u.Columns&&u.Columns.length<=n.CurrObj.ColumnWidths.ColumnCount)for(r=0;r<u.Columns.length;r++)i.Columns[parseInt(u.Columns[r].Col,10)-1]={show:!0};while(rt){if(nt=-1,u.Columns){if(i.ColumnCount>u.Columns.length){for(r=i.ColumnCount-1;r>=0;r--)if(i.Columns[r]===undefined){h=r;i.Columns[h]={show:!1};break}}else{for(r=0;r<u.Columns.length;r++)u.Columns[r].Pri>=nt&&i.Columns[parseInt(u.Columns[r].Col,10)-1].show===!0&&(v=r,nt=u.Columns[r].Pri);h=parseInt(u.Columns[v].Col,10)-1;i.Columns[h].Ext=u.Columns[v];i.Columns[h]={show:!1}}i.ColumnCount--}else v--,h=v,i.Columns[h]={show:!1},i.ColumnCount--;g-=ut[h].Width;(g<it||i.ColumnCount===0)&&(rt=!1,(it-g>ut[h].Width*.9||i.ColumnCount===0)&&(i.Columns[h].show=!0,i.ColumnCount++))}}for(r=0;r<n.CurrObj.ColumnWidths.ColumnCount;r++)i.Columns[r]===undefined?i.Columns[r]={show:!0}:i.Columns[r].show===!1&&(i.isResp=!0),i.Columns[r].show&&(d.append($("<col/>").css("width",t._getWidth(n.CurrObj.ColumnWidths.Columns[r].Width)+"mm")),n.CurrObj.ColumnWidths.Columns[r].FixColumn===1&&(w=t._getWidth(n.CurrObj.ColumnWidths.Columns[r].Width),n.CurrObj.ColumnWidths.Columns[r+1].FixColumn===0&&(w+=.25),p+=t._getWidth(w),tt.append($("<col/>").css("width",w+"mm"))));i.isResp===!1&&(l+=t._getMeasurements(t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex)));o.attr("Style",l);o.append(d);forerunner.device.isFirefox()||e.append(tt);s.append(d.clone(!0,!0));e.addClass("fr-render-tablix");s.addClass("fr-render-tablix");s.addClass(t._getClassName("fr-n-",n.CurrObj));e.addClass(t._getClassName("fr-n-",n.CurrObj));s.addClass(t._getClassName("fr-t-",n.CurrObj));e.addClass(t._getClassName("fr-t-",n.CurrObj));s.attr("Style",l);e.css("width",p+"mm");e.css("min-width",p+"mm");e.css("max-width",p+"mm")}return t._tablixStream[n.CurrObj.Elements.NonSharedElements.UniqueName]={$Tablix:o,$FixedColHeader:s,$FixedRowHeader:e,HasFixedRows:b,HasFixedCols:k,RIContext:n,respCols:i},c=t._tablixStream[n.CurrObj.Elements.NonSharedElements.UniqueName],c.State={LastRowIndex:0,LastObjType:"",StartIndex:0,CellCount:0},c.EndRow=$("<TR/>").addClass("fr-lazyNext").css("visible",!1).text(t.options.reportViewer.locData.getLocData().messages.loading),t._writeTablixRowBatch(c),b=c.HasFixedRows,k=c.HasFixedCols,b?s.css("visibility","hidden"):s=null,k?e.css("visibility","hidden"):e=null,y=$("<div style='position:relative'><\/div"),o.append(s),o.append(e),n.CurrObj.Elements.NonSharedElements.UniqueName&&t._writeUniqueName(o,n.CurrObj.Elements.NonSharedElements.UniqueName),n.$HTMLParent=y,t._writeBookMark(n),t._writeTooltip(n),t._writeActions(n,{},o),y.append(o),n.RS.floatingHeaders.push(new f(y,s,e)),y},_writeSingleTablixRow:function(i,r,u,f,e,o,s,h){var y=this,nt=s.LastRowIndex,v=s.LastColIndex,tt=s.LastObjType,c=s.Row,ut=!1,ft=!1,l=s.ExtRow,p=s.ExtCell,k,d,w,a,rt,g,b,et,it;if(s.ExtRow===undefined&&h.isResp&&(l=new $("<TR/>"),p=new $("<TD/>").attr("colspan",h.ColumnCount).css("background-color",h.BackgroundColor),p.css("position","relative"),l.addClass("fr-render-respRow"),l.append(p),l.hide()),s.Row===undefined&&(c=new $("<TR/>"),c.addClass("fr-render-row")),w=s.Colspans,a=s.Rowspans,v===undefined&&(v=-1,w={},a={}),f.RowSpan?a[f.ColumnIndex]=f.RowSpan:a[f.ColumnIndex]>0&&a[f.ColumnIndex]--,(a[f.ColumnIndex]===0||isNaN(a[f.ColumnIndex]))&&(a[f.ColumnIndex]=undefined),f.ColSpan?w[f.ColumnIndex]=f.ColSpan:w[f.ColumnIndex]>0&&w[f.ColumnIndex]--,(w[f.ColumnIndex]===0||isNaN(w[f.ColumnIndex]))&&(w[f.ColumnIndex]=undefined),f.RowIndex!==nt){for(r.append(c),h.isResp&&l&&l.children()[0].children.length>0?r.append(l):c.findUntil(".fr-render-respIcon",".fr-render-tablix").hide(),i.CurrObj.RowHeights.Rows[f.RowIndex-1].FixRows===1&&e.append(c.clone(!0,!0)),c=new $("<TR/>"),c.addClass("fr-render-row"),h.isResp&&(l=new $("<TR/>"),p=new $("<TD/>").attr("colspan",h.ColumnCount).css("background-color",h.BackgroundColor),p.css("position","relative"),l.addClass("fr-render-respRow"),l.append(p),l.hide()),rt=nt+1;rt<f.RowIndex;rt++)r.append(c),c=new $("<TR/>");nt=f.RowIndex;v=-1}if(f.UniqueName&&y._writeUniqueName(c,f.UniqueName),f.Type!=="Corner"&&tt==="Corner"&&o.append(c.clone(!0,!0)),f.Type!=="RowHeader"&&tt==="RowHeader"&&o.append(c.clone(!0,!0)),i.CurrObj.RowHeights.Rows[f.RowIndex]&&i.CurrObj.RowHeights.Rows[f.RowIndex].FixRows===1&&(ft=!0),f.Type!=="BodyRow"&&i.CurrObj.ColumnWidth&&i.CurrObj.ColumnWidths.Columns[f.ColumnIndex]&&i.CurrObj.ColumnWidths.Columns[f.ColumnIndex].FixColumn===1&&(ut=!0),k=0,i.CurrObj.RowHeights.Rows[f.RowIndex]&&(k=i.CurrObj.RowHeights.Rows[f.RowIndex].Height),f.Type==="BodyRow")$.each(a,function(n){a[n]!==undefined&&a[n]--}),$.each(f.Cells,function(u,e){var s,o;for(h.ColHeaderRow===f.RowIndex&&c.addClass("fr-render-colHeader"),d=i.CurrObj.ColumnWidths.Columns[e.ColumnIndex].Width,s=v;s>=e.ColumnIndex;s--)$("td:last-child",c).remove();v=e.ColumnIndex;e.ColSpan&&(v+=e.ColSpan-1);g=undefined;h.Columns[e.ColumnIndex].show?(h.isResp&&h.ColHeaderRow!==f.RowIndex&&e.RowSpan===undefined&&l&&l.HasDrill!==!0&&e.Cell&&(g=y._addTablixRespDrill(l,e.ColumnIndex,r,e.Cell),l.HasDrill=!0),c.append(y._writeTablixCell(i,e,u,f.RowIndex,g))):h.ColHeaderRow===f.RowIndex||y._isHeader(h,e.Cell)?(h.Columns[e.ColumnIndex].HeaderIndex===undefined&&(h.Columns[e.ColumnIndex].HeaderIndex=0),h.Columns[e.ColumnIndex].HeaderName===undefined&&(h.Columns[e.ColumnIndex].HeaderName=y._getElements(e.Cell.ReportItem).NonSharedElements.UniqueName),h.Columns[e.ColumnIndex].Header=y._writeReportItems(new n(i.RS,e.Cell.ReportItem,u,i.CurrObj,new $("<Div/>"),"",new t(k,d),!0)),h.Columns[e.ColumnIndex].Header.children().removeClass("fr-r-fS"),y._unRotate(h.Columns[e.ColumnIndex].Header.children(0).children(0)),l=null):(h.Columns[e.ColumnIndex].Header&&p.append(h.Columns[e.ColumnIndex].Header.clone(!0,!0).attr("data-uniqName",h.Columns[e.ColumnIndex].HeaderName+"-"+h.Columns[e.ColumnIndex].HeaderIndex++)),e.Cell&&(o=y._writeReportItems(new n(i.RS,e.Cell.ReportItem,u,i.CurrObj,new $("<Div/>"),"",new t(k,d))),o.css("width",d+"mm"),o.css("height",k+"mm"),p.append(o)))}),s.CellCount+=f.Cells.length;else if(b=v,f.Cell){for(b=v+1;b<f.ColumnIndex&&a[b]===undefined;b++)c.append($("<TD/>").html("&nbsp;"));v=f.ColumnIndex;f.ColSpan&&(v+=f.ColSpan-1);h.Columns[f.ColumnIndex].show===!1&&(f.Type==="Corner"||f.Type==="ColumnHeader")?(d=i.CurrObj.ColumnWidths.Columns[f.ColumnIndex].Width,et=y._writeReportItems(new n(i.RS,f.Cell.ReportItem,u,i.CurrObj,new $("<Div/>"),"",new t(k,d),!0)),h.Columns[f.ColumnIndex].Header===undefined&&(h.Columns[f.ColumnIndex].Header=new $("<div/>")),h.Columns[f.ColumnIndex].HeaderIndex===undefined&&(h.Columns[f.ColumnIndex].HeaderIndex=0),h.Columns[f.ColumnIndex].HeaderName===undefined&&(h.Columns[f.ColumnIndex].HeaderName=y._getElements(f.Cell.ReportItem).NonSharedElements.UniqueName),h.Columns[f.ColumnIndex].Header.append(et),h.Columns[f.ColumnIndex].Header.children().children().removeClass("fr-r-fS"),y._unRotate(h.Columns[f.ColumnIndex].Header.children(0).children(0)),l=null):(h.isResp&&f.Type==="RowHeader"&&f.RowSpan===undefined&&h.ColHeaderRow!==f.RowIndex&&l&&l.HasDrill!==!0&&(g=y._addTablixRespDrill(l,f.ColumnIndex,r,f.Cell),p.attr("colspan",h.ColumnCount-f.ColumnIndex),l.HasDrill=!0),h.isResp&&f.RowSpan!==undefined&&f.ColumnIndex===0&&(f.Type==="Corner"?c.addClass("fr-resp-corner"):c.addClass("fr-resp-rowspan")),c.append(y._writeTablixCell(i,f,u,undefined,g)));s.CellCount+=1}else if(f.Type!=="ColumnHeader"){for(b=v+1;b<f.ColumnIndex&&a[b]===undefined;b++)c.append($("<TD/>").html("&nbsp;"));v=f.ColumnIndex;f.ColSpan&&(v+=f.ColSpan-1);(a[f.ColumnIndex]===undefined||f.RowSpan>0||f.ColSpan>0)&&(it=$("<TD/>").html("&nbsp;"),f.RowSpan>0&&it.attr("rowspan",f.RowSpan),f.ColSpan>0&&it.attr("colspan",f.ColSpan),c.append(it))}return tt=f.Type,{LastRowIndex:nt,LastColIndex:v,Colspans:w,Rowspans:a,LastObjType:tt,Row:c,ExtRow:l,ExtCell:p,HasFixedCols:ut,HasFixedRows:ft,CellCount:s.CellCount}},_unRotate:function(n){$.each(n,function(n,t){t=$(t);(t.hasClass("fr-rotate-90")||t.hasClass("fr-rotate-270"))&&(t.removeClass("fr-rotate-90").removeClass("fr-rotate-270"),t.css("left","").css("top","").css("width","").css("height","").css("position",""))})},_isHeader:function(n,t){var i=this,r;return t===undefined?!1:(r=i._getSharedElements(i._getElements(t.ReportItem).SharedElements).Name,n.ColumnHeaders[r])?!0:!1},replayRespTablix:function(n){var t=this;n&&$.each(n,function(n,i){var r,u,f;i.Visible&&(f=t.element.find('[data-uniqName="'+i.UniqueName+'"]'),r=f.prev(),r.hasClass("fr-render-respIcon")===!1&&(r=r.prev()),u=r.parent().parent().parent().next(),t._TablixRespShow(r,u,i.ColIndex,i.UniqueName))})},_addTablixRespDrill:function(n,t,i,r){var f=this,u=new $("<div/>");u.html("&nbsp");u.addClass("fr-render-respTablix-expand");u.addClass("fr-render-respIcon");u.on("click",{ExtRow:n,ColIndex:t,UniqueName:f._getElements(r.ReportItem).NonSharedElements.UniqueName,$Tablix:i},function(n){f._TablixRespShow(this,n.data.ExtRow,n.data.ColIndex,n.data.UniqueName,n.data.$Tablix);return});return u.addClass("fr-core-cursorpointer"),u},_TablixRespShow:function(n,t,i,r,u){var f=this,o=!t.is(":visible"),e;o?(t.show(),e=1,f.Page.Replay[r]={Visible:!0,ColIndex:i,UniqueName:r}):(e=-1,f.Page.Replay[r]={Visible:!1,ColIndex:i,UniqueName:r});i>0&&$.each(t.prevAll(),function(n,t){return $(t).hasClass("fr-resp-corner")?!1:($.each($(t).children("[rowspan]"),function(n,t){$(t).height()>0&&$(t).attr("rowspan",parseInt($(t).attr("rowspan"),10)+e)}),$(t).hasClass("fr-resp-rowspan")?!1:void 0)});o?($(n).addClass("fr-render-respTablix-collapse"),$(n).removeClass("fr-render-respTablix-expand")):(t.hide(),$(n).removeClass("fr-render-respTablix-collapse"),$(n).addClass("fr-render-respTablix-expand"));f.layoutReport(!0);u&&u.hide().show(0)},_batchSize:function(){return forerunner.config.getCustomSettingsValue("BigTablixBatchSize",3e3)},_tablixStream:{},_writeTablixRowBatch:function(n){for(var r,i=this,t=n.State.StartIndex;t<n.RIContext.CurrObj.TablixRows.length&&n.State.CellCount<i._batchSize();t++)r=n.RIContext.CurrObj.TablixRows[t],n.State=i._writeSingleTablixRow(n.RIContext,n.$Tablix,t,r,n.$FixedColHeader,n.$FixedRowHeader,n.State,n.respCols),n.State.HasFixedRows===!0&&(n.HasFixedRows=!0),n.State.HasFixedCols===!0&&(n.HasFixedCols=!0);n.State.StartIndex=t;n.State.CellCount=0;n.State.StartIndex<n.RIContext.CurrObj.TablixRows.length?(n.$Tablix.append(n.EndRow),n.BigTablix=!0):(n.$Tablix.append(n.State.Row),n.respCols.isResp&&n.State.ExtRow&&n.State.ExtRow.children()[0].children.length>0?(n.$Tablix.append(n.State.ExtRow),n.State.ExtRow.hide()):n.State.Row&&n.State.Row.findUntil(".fr-render-respIcon",".fr-render-tablix").hide(),n.BigTablixDone=!0)},_lazyLoadTablix:function(n){for(var t in n._tablixStream)n._tablixStream[t].EndRow.visible(!1,!1,"vertical")&&(n._tablixStream[t].EndRow.detach(),n._writeTablixRowBatch(n._tablixStream[t]),n._tablixStream[t].BigTablixDone&&n.layoutReport(!0))},_writeSubreport:function(n){var t=this;return n.CurrObjParent.Type!=="Tablix"&&(n.Style+=t._getElementsStyle(n.RS,n.CurrObj.SubReportProperties)),n.CurrObj=n.CurrObj.BodyElements,t._writeBookMark(n),t._writeTooltip(n),t._writeRectangle(n)},_writeLine:function(n){var t=this,i=t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),o="position:relative;width:"+i.Width+"mm;height:"+i.Height+"mm;",u;if(i.Width===0||i.Height===0)o+=t._getFullBorderStyle(n.CurrObj.Elements.NonSharedElements),n.$HTMLParent.addClass(t._getClassName("fr-b-",n.CurrObj));else{var e=$("<Div/>"),f=Math.sqrt(Math.pow(i.Height,2)+Math.pow(i.Width,2)),r=Math.atan(i.Height/i.Width),s=f/2*Math.sin(r),h=f/2-Math.sqrt(Math.pow(f/2,2)+Math.pow(s,2));t._getSharedElements(n.CurrObj.Elements.SharedElements).Slant===undefined||t._getSharedElements(n.CurrObj.Elements.SharedElements).Slant===0||(r=r-2*r);u="position:absolute;top:"+s+"mm;left:"+h+"mm;";u+=t._getFullBorderStyle(n.CurrObj.Elements.NonSharedElements);e.addClass(t._getClassName("fr-b-",n.CurrObj));u+="width:"+f+"mm;height:0;";u+="-moz-transform: rotate("+r+"rad);";u+="-webkit-transform: rotate("+r+"rad);";u+="-ms-transform: rotate("+r+"rad);";u+="transform: rotate("+r+"rad);";e.attr("Style",u);n.$HTMLParent.append(e)}return t._writeBookMark(n),t._writeTooltip(n),n.$HTMLParent.attr("Style",o+n.Style),n.$HTMLParent},_writeBookMark:function(n){var t=this,i=$("<a/>"),r=n.CurrObj.Elements,u=t._getSharedElements(r.SharedElements).Bookmark||r.NonSharedElements.Bookmark;u&&(t._writeUniqueName(i,u),n.$HTMLParent.append(i))},_writeTooltipInternal:function(n,t,i){var f=this,r,u;if(n&&forerunner.config.getCustomSettingsValue("FancyTooltips","off").toLowerCase()==="on"&&!forerunner.device.isMSIE8()){r=$("<div class='fr-tooltip'>"+n+"<div class='fr-arrow'><\/div><\/div>");t.append(r);i.on("mouseenter",function(n){u&&(clearTimeout(u),u=null);var e=$(this),i=0,f=0,t=$(this).parent().offset();$(this).parent().is("map")&&(t=$(this).parent().parent().offset());i=n.pageY-t.top;f=n.pageX-t.left;r.css({top:i-r.outerHeight()-13,left:f-r.outerWidth()/2});u=setTimeout(function(){r.addClass("active")},1e3)});i.on("mouseleave",function(){clearTimeout(u);var n=$(this);setTimeout(function(){r.removeClass("active").removeClass("out")},300)})}else n&&(i.attr("alt",n),i.attr("title",n))},_writeTooltip:function(n){var t=this,i=n.CurrObj.Elements,r=t._getSharedElements(i.SharedElements).Tooltip||i.NonSharedElements.Tooltip;t._writeTooltipInternal(r,n.$HTMLParent,n.$HTMLParent,0,0)},_getHeight:function(n){var r=this,i,t;return t=n.clone().css({visibility:"hidden"}),t.find("img").remove(),$("body").append(t),i=t.outerHeight()+"px",t.remove(),r._convertToMM(i)},_getElements:function(n){return n.Elements?n.Elements:n.SubReportProperties?n.SubReportProperties:void 0},_getElementsStyle:function(n,t){var i="",r=this;return i+=r._getStyle(n,t.NonSharedElements.Style,t.NonSharedElements),i+r._getStyle(n,t,t)},_getElementsTextStyle:function(n){var t=this;return""+t._getTextStyle(n.NonSharedElements.Style,n.NonSharedElements)},_getElementsNonTextStyle:function(n,t){var i=this;return""+i._getNonTextStyle(n,t.NonSharedElements.Style,t.NonSharedElements)},_getBorderSize:function(n,t){var f=this,i,e,r,o,u;return(i=f._getSharedElements(n.Elements.SharedElements).Style,i?(e=i.BorderStyle,r=i["BorderStyle"+t],o=i.BorderWidth,u=i["BorderWidth"+t]):(i=n.Elements.NonSharedElements.Style,i&&(e=i.BorderStyle,r=i["BorderStyle"+t],o=i.BorderWidth,u=i["BorderWidth"+t])),!r&&e===0)?0:r===0?0:u?f._convertToMM(u):f._convertToMM(o)},_getPaddingSize:function(n,t){var u=this,i,r;return i=u._getSharedElements(n.Elements.SharedElements).Style,i?r=i["Padding"+t]:(i=n.Elements.NonSharedElements.Style,i&&(r=i["Padding"+t])),u._convertToMM(r)},_getFullBorderStyle:function(n){var i=this,r="",t;return n?(t=n,t!==undefined&&(t.BorderStyle!==undefined&&t.BorderStyle!==0&&(r+="border:"+t.BorderWidth+" "+i._getBorderStyle(t.BorderStyle)+" "+t.BorderColor+"!important;"),(t.BorderStyleLeft!==undefined||t.BorderWidthLeft!==undefined||t.BorderColorLeft!==undefined)&&(r+="border-left:"+(t.BorderWidthLeft===undefined?t.BorderWidth:t.BorderWidthLeft)+" "+(t.BorderStyleLeft===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleLeft))+" "+(t.BorderColorLeft===undefined?t.BorderColor:t.BorderColorLeft)+"!important;"),(t.BorderStyleRight!==undefined||t.BorderWidthRight!==undefined||t.BorderColorRight!==undefined)&&(r+="border-right:"+(t.BorderWidthRight===undefined?t.BorderWidth:t.BorderWidthRight)+" "+(t.BorderStyleRight===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleRight))+" "+(t.BorderColorRight===undefined?t.BorderColor:t.BorderColorRight)+"!important;"),(t.BorderStyleTop!==undefined||t.BorderWidthTop!==undefined||t.BorderColorTop!==undefined)&&(r+="border-top:"+(t.BorderWidthTop===undefined?t.BorderWidth:t.BorderWidthTop)+" "+(t.BorderStyleTop===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleTop))+" "+(t.BorderColorTop===undefined?t.BorderColor:t.BorderColorTop)+"!important;"),(t.BorderStyleBottom!==undefined||t.BorderWidthBottom!==undefined||t.BorderColorBottom!==undefined)&&(r+="border-bottom:"+(t.BorderWidthBottom===undefined?t.BorderWidth:t.BorderWidthBottom)+" "+(t.BorderStyleBottom===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleBottom))+" "+(t.BorderColorBottom===undefined?t.BorderColor:t.BorderColorBottom)+"!important;"),t.BackgroundColor&&(r+="background-color:"+t.BackgroundColor+";")),r):""},_getMeasurementsInvert:function(n){var i=this,t="";return n?(n.Width!==undefined&&(t+="height:"+n.Width+"mm;",t+="min-height:"+n.Width+"mm;",t+="max-height:"+n.Width+"mm;"),n.Height!==undefined&&(t+="width:"+n.Height+"mm;",t+="min-width:"+n.Height+"mm;",t+="max-width:"+n.Height+"mm;"),t):""},_getMeasurements:function(n,t){var r=this,i="";return n?(n.Width!==undefined&&(i+="width:"+r._getWidth(n.Width)+"mm;",i+="min-width:"+r._getWidth(n.Width)+"mm;",i+="max-width:"+r._getWidth(n.Width)+"mm;"),t&&n.Height!==undefined&&(i+="height:"+n.Height+"mm;",i+="min-height:"+n.Height+"mm;",i+="max-height:"+n.Height+"mm;"),i):""},_getStyle:function(n,t,i){var u=this,r="";return t?(r+=u._getNonTextStyle(n,t,i),r+u._getTextStyle(t,i)):r},_backgroundRepeatTypesMap:function(){return{0:"repeat",1:"no-repeat",2:"repeat-x",3:"repeat-y"}},_getImageStyleURL:function(n,t){var i=this;return"url("+i._getImageURL(n,t)+")"},_getNonTextStyle:function(n,t){var r=this,i="";return t?(t.BackgroundColor&&(i+="background-color:"+t.BackgroundColor+";"),t.BackgroundImage&&(i+="background-image:"+r._getImageStyleURL(n,t.BackgroundImage.ImageName)+";"),t.BackgroundRepeat!==undefined&&r._backgroundRepeatTypesMap()[t.BackgroundRepeat]&&(i+="background-repeat:"+r._backgroundRepeatTypesMap()[t.BackgroundRepeat]+";"),i):i},_getTextDirection:function(n){var t="",i=this;return i._getSharedElements(n.SharedElements).Style&&i._getSharedElements(n.SharedElements).Style.WritingMode!==undefined&&(i._getSharedElements(n.SharedElements).Style.WritingMode===1&&(t="fr-rotate-90"),i._getSharedElements(n.SharedElements).Style.WritingMode===2&&(t="fr-rotate-270")),n.NonSharedElements.Style&&n.NonSharedElements.Style.WritingMode!==undefined&&(n.NonSharedElements.Style.WritingMode===1&&(t="fr-rotate-90"),n.NonSharedElements.Style.WritingMode===2&&(t="fr-rotate-270")),t!==""&&forerunner.device.isMSIE8()&&(t+="-IE8"),t},_getTextStyle:function(n,t){var r=this,i="";return n?(n.PaddingBottom!==undefined&&(i+="padding-bottom:"+n.PaddingBottom+";"),n.PaddingLeft!==undefined&&(i+="padding-left:"+n.PaddingLeft+";"),n.PaddingRight!==undefined&&(i+="padding-right:"+n.PaddingRight+";"),n.PaddingTop!==undefined&&(i+="padding-top:"+n.PaddingTop+";"),n.UnicodeBiDi!==undefined&&(i+="unicode-bidi:"+r._getBiDi(n.UnicodeBiDi)+";"),n.VerticalAlign!==undefined&&(i+="vertical-align:"+r._getVAligh(n.VerticalAlign)+";"),n.Direction!==undefined&&(i+="Direction:"+r._getDirection(n.Direction)+";"),n.TextAlign!==undefined&&(i+="text-align:"+r._getTextAlign(n.TextAlign,t)+";"),n.FontStyle!==undefined&&(i+="font-style:"+r._getFontStyle(n.FontStyle)+";"),n.FontWeight!==undefined&&(i+="font-weight:"+r._getFontWeight(n.FontWeight)+";"),n.FontFamily!==undefined&&(i+='font-family:"'+n.FontFamily+'";'),n.FontSize!==undefined&&(i+="font-size:"+r._getFontSize(n.FontSize)+";"),n.TextDecoration!==undefined&&(i+="text-decoration:"+r._getTextDecoration(n.TextDecoration)+";"),n.Color!==undefined&&(i+="color:"+n.Color+";"),i):i},_getCalendar:function(n){switch(n){case 0:return"Gregorian";case 1:return"GregorianArabic";case 2:return"GregorianMiddleEastFrench";case 3:return"GregorianTransliteratedEnglish";case 4:return"GregorianTransliteratedFrench";case 5:return"GregorianUSEnglish";case 6:return"Hebrew";case 7:return"Hijri";case 9:return"Korean";case 10:return"Julian";case 11:return"Taiwan";case 12:return"ThaiBuddist"}return"Gregorian"},_getTextDecoration:function(n){switch(n){case 0:return"None";case 1:return"Underline";case 2:return"Overline";case 3:return"LineThrough"}return"None"},_getFontWeight:function(n){switch(n){case 0:return"Normal";case 1:return"Thin";case 2:return"ExtraLight";case 3:return"Light";case 4:return"Medium";case 5:return"SemiBold";case 6:return"Bold";case 7:return"ExtraBold";case 8:return"Heavy"}return"General"},_getFontStyle:function(n){switch(n){case 0:return"Normal";case 1:return"Italic"}return"Normal"},_getTextAlign:function(n,t){switch(n){case 0:if(t===undefined||t.TypeCode===undefined)return"Left";switch(t.TypeCode){case 3:case 6:case 7:case 9:case 11:case 12:case 13:case 14:case 15:case 16:return"Right";case 4:case 17:case 18:return"Left";default:return"Left"}break;case 1:return"Left";case 2:return"Center";case 3:return"Right"}},_getDirection:function(n){switch(n){case 0:return"LTR";case 1:return"RTL"}return"LTR"},_getLayoutFlow:function(n){switch(n){case 0:return"Horizontal";case 1:return"Vertical";case 2:return"Rotate270"}return"Horizontal"},_getVAligh:function(n){switch(n){case 0:return"Top";case 1:return"Middle";case 2:return"Bottom"}return"Top"},_getBiDi:function(n){switch(n){case 0:return"normal";case 1:return"embed";case 2:return"BiDiOverride"}return"normal"},_getDefaultHTMLTable:function(){var n=$("<Table/>");return n.attr("CELLSPACING",0),n.attr("CELLPADDING",0),n},_getBorderStyle:function(n){switch(n){case 0:return"None";case 1:return"Dotted";case 2:return"Dashed";case 3:return"Solid";case 4:return"Double"}return"None"},_getMeasurmentsObj:function(n,t){var i=null;return n.Measurement&&(i=n.Measurement.Measurements[t]),i},_getSharedElements:function(n){var t=this;return n.SID?t.reportObj.ReportContainer.SharedElements[n.SID]:n},_convertToMM:function(n){if(!n)return 0;var i=n.match(/\D+$/),t=n.match(/\d+/);i=i&&i.length===1?i[0]:"px";t.length===1&&(t=t[0]);switch(i){case"px":return t/3.78;case"pt":return t*.352777777778;case"in":return t*25.4;case"mm":return t;case"cm":return t*10;case"em":return t*4.2175176}return t},_getFontSize:function(n){return n?n:""},_getListStyle:function(n,t){var i;if(n===1)switch(t%3){case 1:i="decimal";break;case 2:i="lower-roman";break;case 0:i="lower-latin"}else if(n===2)switch(t%3){case 0:i="square";break;case 1:i="disc";break;case 2:i="circle"}return"fr-render-list-"+i},_stopDefaultEvent:function(n){window.ActiveXObject?window.event.returnValue=!1:(n.preventDefault(),n.stopPropagation())},_getNatural:function(n){if(n.naturalWidth&&n.naturalHeight)return{width:n.naturalWidth,height:n.naturalHeight};var t=new Image;return t.src=n.src,{width:t.width,height:t.height}},_isNull:function(n){return n===null||n===undefined?!0:!1},_getWidth:function(n){return n},_getNewLineFormatText:function(n){return n.replace(/\r\n+/g,"\n")},_createStyles:function(n){var t=this,u="<style type='text/css' id='"+t.options.reportViewer.viewerID+"'>",i=t.reportObj.ReportContainer.SharedElements;for(var r in i)u+=".fr-b-"+i[r].SID+"-"+t.options.reportViewer.viewerID+"{"+t._getFullBorderStyle(i[r].Style)+"} ",u+=".fr-t-"+i[r].SID+"-"+t.options.reportViewer.viewerID+"{"+t._getTextStyle(i[r].Style,i[r])+"} ",u+=".fr-n-"+i[r].SID+"-"+t.options.reportViewer.viewerID+"{"+t._getNonTextStyle(n,i[r].Style)+"} ";t.Page.CSS=$(u+"<\/style>");t.Page.CSS.appendTo("head")},_getClassName:function(n,t){var i=this;return(t.SubReportProperties&&(t=t.SubReportProperties),t.Elements&&t.Elements.SharedElements)?n+t.Elements.SharedElements.SID+"-"+i.options.reportViewer.viewerID:t.SharedElements?n+t.SharedElements.SID+"-"+i.options.reportViewer.viewerID:""},_roundToTwo:function(n){return+(Math.round(n+"e+2")+"e-2")}})});forerunner=forerunner||{};moment=moment||{};forerunner.ssr=forerunner.ssr||{};$(function(){var r=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,i="fr-param-container",n="***ThisIsNull***";$.widget(r.getFullname(r.reportParameter),{options:{$reportViewer:null,pageNum:null,$appContainer:null,RDLExt:{}},$params:null,_formInit:!1,_defaultValueExist:!1,_loadedForDefault:!0,_reportDesignError:null,_revertLock:!1,_useDefault:!1,_submittedParamsList:null,_parameterDefinitions:null,_hasPostedBackWithoutSubmitForm:!1,_dependencyList:null,_writeParamDoneCallback:null,_init:function(){var n=this;n.element.html(null);n.enableCascadingTree=forerunner.config.getCustomSettingsValue("EnableCascadingTree","on")==="on";n.isDebug=forerunner.config.getCustomSettingsValue("Debug","off")==="on"?!0:!1},_render:function(){var n=this,t;n.element.children().remove();t=new $("<div class='"+i+" fr-core-widget'><form class='fr-param-form' onsubmit='return false'><div class='fr-param-element-border'><input type='text' style='display:none'><\/div><div><div class='fr-param-submit-container'><input name='Parameter_ViewReport' type='button' class='fr-param-viewreport fr-param-button' value='"+n.options.$reportViewer.locData.getLocData().paramPane.viewReport+"'/><\/div><div class='fr-param-cancel-container'><span class='fr-param-cancel'>"+n.options.$reportViewer.locData.getLocData().paramPane.cancel+"<\/span><\/div><\/div><\/form><div style='height:65px;'/><\/div>");n.element.css("display","block");n.element.html(t);n.$params=t;n.$form=n.element.find(".fr-param-form");n._formInit=!0},getNumOfVisibleParameters:function(){var n=this;return n._numVisibleParams!==undefined?n._numVisibleParams:0},updateParameterPanel:function(n,t,i,r,u,f,e){var o=this,s=o.element.find(".fr-param-tree-loading"),h;if(s.length!==0){o._dataPreprocess(n.ParametersList);var a=s.parent("ul").attr("level"),v=s.parent().attr("name"),l=o._dependencyList[v],c=null;for(h=0;h<l.length;h++)c=o._getCascadingTree(o._parameterDefinitions[l[h]],parseInt(a,10)+1),c&&s.append(c);s.removeClass("fr-param-tree-loading")}else this.removeParameter(),this.writeParameterPanel(n,i,t,r,f,e);this._hasPostedBackWithoutSubmitForm=!0},setParametersAndUpdate:function(n,t,i){var r=this;r.updateParameterPanel(n,!1,i,!1);r._submittedParamsList=t;this._hasPostedBackWithoutSubmitForm=!1;r.revertParameters()},writeParameterPanel:function(n,r,u,f,e,o){var s=this,c;n.Debug&&(s._debug=n.Debug);s.$params===null&&s._render();s.options.pageNum=r;s._defaultValueExist=n.DefaultValueExist;s._loadedForDefault=!0;s._submittedParamsList=null;s._numVisibleParams=0;s._render();s._dataPreprocess(n.ParametersList,!0);var l=$(".fr-param-element-border",s.$params),h=o&&o.ParametersList,a=s._getParamMap(e);$.each(n.ParametersList,function(n,t){var i=s._getMergedParam(t,a);i.Prompt!==""&&(i.PromptUserSpecified?i.PromptUser:!0)&&(s._numVisibleParams+=1,l.append(s._writeParamControl(i,new $("<div />"),r,h?h[n]:null)))});s._elementWidthCheck();e&&s._useDefaultCheck(e);s._reportDesignError!==null&&(s._reportDesignError+=s.options.$reportViewer.locData.getLocData().messages.contactAdmin);s.$form.validate({ignoreTitle:!0,errorPlacement:function(n,t){t.is(":radio")?n.appendTo(t.parent("div").nextAll(".fr-param-error-message")):t.attr("ismultiple")==="true"||t.hasClass("ui-autocomplete-input")||t.hasClass("fr-param-tree-input")?n.appendTo(t.parent("div").siblings(".fr-param-error-message")):n.appendTo(t.siblings(".fr-param-error-message"))},highlight:function(n){$(n).is(":radio")?$(n).parent("div").addClass("fr-param-error"):$(n).addClass("fr-param-error")},unhighlight:function(n){$(n).is(":radio")?$(n).parent("div").removeClass("fr-param-error"):$(n).removeClass("fr-param-error")}});$(".fr-param-viewreport",s.$params).on("click",function(){s._submitForm(r)});$(".fr-param-cancel",s.$params).on("click",function(){s._cancelForm()});s.isDebug&&console.log("writeParameterPanel",{submitForm:u,DefaultValueCount:n.DefaultValueCount,DataCount:parseInt(n.Count,10),LoadedForDefault:s._loadedForDefault});u!==!1?n.DefaultValueCount===parseInt(n.Count,10)&&s._loadedForDefault?s._submitForm(r):(s._trigger(t.render),s.options.$reportViewer.removeLoadingIndicator()):(f!==!1&&s._trigger(t.render),s.options.$reportViewer.removeLoadingIndicator());c=s.element.find("."+i);c.removeAttr("style");s._setDatePicker();$(document).off("click",s._checkExternalClick);$(document).on("click",{me:s},s._checkExternalClick);$(":text",s.$params).each(function(){var n=$(this);n.on("blur",function(){s.options.$reportViewer.onInputBlur()});n.on("focus",function(){s.options.$reportViewer.onInputFocus()})});typeof s._writeParamDoneCallback=="function"&&(s._writeParamDoneCallback(),s._writeParamDoneCallback=null)},_getParamMap:function(n){var t={},r,i;return n?(r=forerunner.helper.JSONParse(n),i=!1,$.each(r.ParamsList,function(n,r){var u=r.Parameter?r.Parameter:r.Name;t[u]=r;i=!0}),i?t:null):t},_getMergedParam:function(n,t){var i=n,r;return t&&(r=t[n.Name],r&&typeof r.Prompt=="string"&&(i.Prompt=r.Prompt,i.Prompt===""&&(i.PromptUser=!1,i.PromptUserSpecified=!1),r.ValidValues&&(i.ValidValues=r.ValidValues))),i},_addWriteParamDoneCallback:function(n){if(typeof n=="function"){var t=this,i=t._writeParamDoneCallback;t._writeParamDoneCallback=i===null?n:function(){i();n()}}},_elementWidthCheck:function(){var t=this,i=t.options.$appContainer.width(),r=forerunner.config.getCustomSettingsValue("ParameterPaneWidth",280),u=r<i?r:i,n=u-80;n>180&&(t.element.find(".fr-param-width").css({width:n}),t.element.find(".fr-param-dropdown-input").css({width:n-24}),t.element.find(".ui-autocomplete").css({"min-width":n,"max-width":n}),t.element.find(".fr-param-option-container").css({width:n}))},_useDefaultCheck:function(n){var t=this,i=forerunner.helper.JSONParse(n),r=t.element.find(".fr-usedefault-checkbox");$.each(i.ParamsList,function(n,t){if(t.UseDefault&&t.UseDefault.toLowerCase()==="true"){var u=t.Parameter?t.Parameter:t.Name,i=r.filter("[name='"+u+"']");i.length&&i.trigger("click")}})},setsubmittedParamsList:function(n){var t=this;t._submittedParamsList=n},_submitForm:function(n){var i=this,r;if(i._closeAllDropdown(),i._reportDesignError!==null){forerunner.dialog.showMessageBox(i.options.$appContainer,i._reportDesignError);return}i.formIsValid()&&(r=i.getParamsList(),i._debug?i.options.$reportViewer.removeLoadingIndicator():i.options.$reportViewer.loadReportWithNewParameters(r,n,i._useDefault),i._submittedParamsList=r,i._trigger(t.submit));i._hasPostedBackWithoutSubmitForm=!1},revertParameters:function(){var n=this,u,r,t;if(n.getParamsList(!0)!==n._submittedParamsList&&n._submittedParamsList!==null){for(n._revertLock=!0,n._hasPostedBackWithoutSubmitForm&&(n._refreshParameters(n._submittedParamsList,!1),n._hasPostedBackWithoutSubmitForm=!1,n.options.$reportViewer.invalidateReportContext()),u=JSON.parse(n._submittedParamsList),r=u.ParamsList,t=0;t<r.length;t++){var i=r[t],f=i.Parameter?i.Parameter:i.Name,e=n._parameterDefinitions[f];n._setParamValue(e,i.Value)}n._revertLock=!1}},_cancelForm:function(){var n=this;n._closeAllDropdown();n.revertParameters();n.$form.valid();n._trigger(t.cancel,null,{})},_setDatePicker:function(){var n=this,t=n._getDatePickerLoc();if(t&&$.datepicker.setDefaults(t),n.$datepickers=n.element.find(".hasDatepicker"),n.$datepickers.length){$.each(n.$datepickers,function(t,i){$(i).datepicker("option","buttonImage",forerunner.config.forerunnerFolder()+"reportviewer/Images/calendar.png").datepicker("option","buttonImageOnly",!0).datepicker("option","buttonText",n.options.$reportViewer.locData.getLocData().paramPane.datePicker)});$(window).off("resize",n._paramWindowResize);$(window).on("resize",{me:n},n._paramWindowResize)}},_getPredefinedValue:function(n){var t=this;return t._hasDefaultValue(n)?n.MultiValue===!1?n.DefaultValues[0]:n.DefaultValues:undefined},_writeParamControl:function(n,t,i,r){var u=this,l=new $("<div class='fr-param-label'>"+n.Prompt+"<\/div>"),s=!0,e=u._getPredefinedValue(n),h=new $("<div class='fr-param-item-container'><\/div>"),c=new $("<div class='fr-param-option-container'><\/div>"),v=new $("<div class='fr-param-error-message'/>"),f=null,a=r||n,o;if(u._parameterDefinitions[n.Name].isParent===!0&&u._parameterDefinitions[n.Name].isChild!==!0&&u._parameterDefinitions[n.Name].enableCascadingTree===!0&&(f=u._writeCascadingTree(n,e)),u._parameterDefinitions[n.Name].isChild===!0&&u._parameterDefinitions[n.Name].enableCascadingTree===!0&&(f=u._writeCascadingChildren(n,e),t.addClass("fr-param-tree-hidden")),f===null&&(o=u._checkDependencies(n),o&&(u._loadedForDefault=!1),n.MultiValue===!0?n.ValidValues!==""?f=u._writeDropDownWithCheckBox(n,o,e):(s=!1,f=u._writeDropDownWithTextArea(n,o,e)):n.ValidValues!==""?(s=!1,f=forerunner.device.isTouch()&&n.ValidValues.length<=forerunner.config.getCustomSettingsValue("MinItemToEnableBigDropdownOnTouch",20)?u._writeDropDownControl(n,o,i,e):u._writeBigDropDown(n,o,i,e)):f=n.Type==="Boolean"?u._writeRadioButton(n,o,i,e):u._writeTextArea(n,o,i,e)),f!==undefined&&s)f.on("keydown",function(n){n.keyCode===13&&u._submitForm(i)});return u.options.RDLExt&&u.options.RDLExt[n.Name]!==undefined&&f!==undefined&&(forerunner.ssr._writeRDLExtActions(n.Name,u.options.RDLExt,f,undefined,u.options.$reportViewer.element,undefined,undefined,function(){return u._getParamControls.call(u)},function(n,t){u._setParamError.call(u,n,t)}),u.options.RDLExt[n.Name].localize&&l.text(forerunner.localize.getLocalizedValue(n.Prompt,u.options.RDLExt[n.Name].localize))),h.append(f),t.hasClass("fr-param-tree-hidden")||(n.ValidValues===""&&(c.append(u._addNullableCheckBox(n,f,e)),u._checkDependencies(n)),a&&u._hasDefaultValue(a)&&c.append(u._addUseDefaultOption(n,f,e)),h.append(v)),t.append(l).append(h).append(c),t},_setParamError:function(n,t){var i=this,r={};r[n.attr("name")]=t;t!==undefined?(i.$form.validate().showErrors(r),i.$form.validate().invalid[n.attr("name")]=!0):(delete i.$form.validate().invalid[n.attr("name")],i.$form.validate().hideErrors())},_setParamValue:function(n,t,i){var r=this,u,e,o,f;r._parameterDefinitions[n.Name].enableCascadingTree&&(n.isParent||n.isChild)?(e=n.isParent===!0&&n.isChild!==!0,r._setTreeItemStatus(n,t,e),u=i||r.element.find(".fr-paramname-"+n.Name),u.attr("backendValue",JSON.stringify(t)),r._closeCascadingTree(!0)):n.MultiValue?n.ValidValues!==""?(u=$(".fr-paramname-"+n.Name+"-dropdown-cb",r.$params),r._setCheckBoxes(u,t),r._setMultipleInputValues(n)):(u=i||$(".fr-paramname-"+n.Name),o=$(".fr-paramname-"+n.Name+"-dropdown-textArea"),o.val(r._getTextAreaValue(t,!0)),u.val(r._getTextAreaValue(t,!1)),u.attr("jsonValues",JSON.stringify(t))):(u=i||$(".fr-paramname-"+n.Name,r.$params),n.Nullable&&t===null?(f=$(".fr-param-checkbox",r.$params).filter("[name='"+n.Name+"']").first(),f.length!==0&&f.attr("checked")!=="checked"&&f.trigger("click")):n.ValidValues!==""?forerunner.device.isTouch()&&n.ValidValues.length<=forerunner.config.getCustomSettingsValue("MinItemToEnableBigDropdownOnTouch",10)?r._setSelectedIndex(u,t):r._setBigDropDownIndex(n,t,u):n.Type==="Boolean"?r._setRadioButton(u,t):u.attr("datatype").toLowerCase()==="datetime"?u.val(r._getDateTimeFromDefault(t)):u.val(t))},_getParameterControlProperty:function(n,t){var i=this;t.attr("allowblank",n.AllowBlank).attr("nullable",n.Nullable).attr("ErrorMessage",n.ErrorMessage);(n.AllowBlank===!1||n.MultiValue===!0)&&i._addRequiredPrompt(n,t)},_addRequiredPrompt:function(n,t){var i=this;t.attr("required","true").watermark(i.options.$reportViewer.locData.getLocData().paramPane.required,forerunner.config.getWatermarkConfig());t.addClass("fr-param-required");i._paramValidation[n.Name].push("required")},_addNullableCheckBox:function(n,t,i){var f=this,e,r,u;if(n.Nullable===!0){t=t.hasClass("fr-param-element-container")?t.find(".fr-param"):n.Type==="Boolean"?$(".fr-paramname-"+n.Name,t):t;e=new $("<div class='fr-param-option-div' />");r=new $("<Input type='checkbox' class='fr-param-option-checkbox fr-null-checkbox' name='"+n.Name+"' />");r.on("click",function(){r[0].checked!==!0?(t.removeAttr("disabled").removeClass("fr-param-disable"),$.watermark.show(t),$.each(f._paramValidation[n.Name],function(n,i){t.attr(i,"true")}),n.Type==="DateTime"&&t.datepicker("enable")):(t.attr("disabled",!0).addClass("fr-param-disable"),$.watermark.hide(t),$.each(f._paramValidation[n.Name],function(n,i){t.removeAttr(i)}),n.Type==="DateTime"&&t.datepicker("disable"))});u=new $("<Label class='fr-param-option-label' />");u.html(f.options.$reportViewer.locData.getLocData().paramPane.nullField);u.on("click",function(){r.trigger("click")});return e.append(r).append(u),i===null&&n.State!=="MissingValidValue"&&(forerunner.device.isFirefox()&&(r[0].checked=!0),r.trigger("click")),e}return null},_addUseDefaultOption:function(n,t,i){var f=this,o=null,e,r,u;t.hasClass("fr-param-element-container")?(o=t.find("input[type='hidden']"),t=t.find(".fr-param-dropdown-input")):t=n.Type==="Boolean"?$(".fr-paramname-"+n.Name,t):t;e=new $("<div class='fr-param-option-div' />");r=new $("<Input type='checkbox' class='fr-param-option-checkbox fr-usedefault-checkbox' name='"+n.Name+"' />");r.on("click",function(){f._triggerUseDefaultClick.call(f,n,t,r,i,o)});u=new $("<label class='fr-param-option-label' />");u.text(f.options.$reportViewer.locData.getLocData().paramPane.useDefault);u.on("click",function(){r.trigger("click")});return e.append(r).append(u),e},_triggerUseDefaultClick:function(n,t,i,r,u){var e=this,f=$(".fr-null-checkbox").filter("[name='"+n.Name+"']"),o;if(i[0].checked===!1)f.length&&f.removeAttr("disabled"),t.removeAttr("disabled").removeClass("fr-usedefault"),o=t.attr("data-custom"),t.val(o).attr("data-custom",""),u&&u.length&&u.removeClass("fr-usedefault"),t.hasClass("fr-param-tree-input")&&$.each(e._getTreeItemChildren(n.Name),function(n,t){$(".fr-paramname-"+t).removeClass("fr-usedefault")}),t.hasClass("fr-param-dropdown-input")&&t.parent().removeClass("fr-param-disable"),t.removeClass("fr-param-disable"),$.watermark.show(t),$.each(e._paramValidation[n.Name],function(n,i){t.attr(i,"true")}),n.Type==="DateTime"&&t.datepicker("enable");else{f.length&&(f[0].checked===!0&&(f[0].checked=!1),f.attr("disabled",!0));t.attr("disabled",!0).addClass("fr-usedefault");o=t.val();t.attr("data-custom",o).val("");for(var s=0,h=e._paramValidation[n.Name],c=h.length;s<c;s++)t.removeAttr(h[s]);u&&u.length&&u.addClass("fr-usedefault");t.hasClass("fr-param-tree-input")&&$.each(e._getTreeItemChildren(n.Name),function(n,t){$(".fr-paramname-"+t).addClass("fr-usedefault")});t.hasClass("fr-param-dropdown-input")&&t.parent().addClass("fr-param-disable");t.addClass("fr-param-disable");$.watermark.hide(t);n.Type==="DateTime"&&setTimeout(function(){t.datepicker("disable")},100);t.valid()}},_setRadioButton:function(n,t){for(var i=0;i<n.length;i++)n[i].checked=n[i].value===t?!0:!1},_writeRadioButton:function(n,t,i,r){var s=this,h=s.options.$reportViewer.locData.getLocData().paramPane,u=[],f,e,o,c;for(u[0]={display:h.isTrue,value:"True"},u[1]={display:h.isFalse,value:"False"},f=s._createDiv(["fr-param-checkbox-container","fr-param-width"]),f.attr("ismultiple",n.MultiValue),f.attr("datatype",n.Type),e=0;e<u.length;e++){if(o=new $("<input type='radio' class='fr-param fr-param-radio fr-paramname-"+n.Name+"' name='"+n.Name+"' prompt='"+n.Prompt+"' value='"+u[e].value+"' datatype='"+n.Type+"' />"),t)o.attr("disabled",!0);else{s._getParameterControlProperty(n,o);r&&r===u[e].value&&o.attr("checked",!0);o.on("click",function(){s.getNumOfVisibleParameters()===1&&s._submitForm(i)})}c=new $("<label class='fr-param-radio-label'>"+u[e].display+"<\/label>");f.append(o);f.append(c)}return f},_setParamScrollPos:function(n){var t=this;if(forerunner.device.isTouch())n.off("focus",t._setScrollPos).on("focus",{me:t},t._setScrollPos)},_setScrollPos:function(n){var t=n.data.me,i=n.target,r=i.offsetTop-28;setTimeout(function(){t.$params.scrollTop(r)},500)},_writeTextArea:function(n,t,i,r){var f=this,u=new $("<input class='fr-param fr-param-width fr-paramname-"+n.Name+"' prompt='"+n.Prompt+"' name='"+n.Name+"' type='text' size='100' ismultiple='"+n.MultiValue+"' datatype='"+n.Type+"' />");if(t)return f._disabledSubSequenceControl(u),u;f._getParameterControlProperty(n,u);switch(n.Type){case"DateTime":u.datepicker({showOn:"button",changeMonth:!0,changeYear:!0,showButtonPanel:!0,dateFormat:forerunner.ssr._internal.getDateFormat(f.options.$reportViewer.locData),onClose:function(){var t=u;t.removeAttr("disabled").removeClass("datepicker-focus");$(".fr-paramname-"+n.Name,f.$params).valid();f.getNumOfVisibleParameters()===1&&f._submitForm(i)},beforeShow:function(n){$(n).attr("disabled",!0).addClass("datepicker-focus")}});u.attr("formattedDate","true");f._paramValidation[n.Name].push("formattedDate");r&&u.datepicker("setDate",f._getDateTimeFromDefault(r));break;case"Integer":case"Float":u.attr("number","true");f._paramValidation[n.Name].push("number");r&&u.val(r);break;case"String":r&&u.val(r)}return f._setParamScrollPos(u),u},_setSelectedIndex:function(n,t){for(var r=n[0],i=0;i<r.length;i++)if(r[i].value===t){r[i].selected=!0;return}},_setBigDropDownIndex:function(n,t,i){for(var r=0;r<n.ValidValues.length;r++)(t&&t===n.ValidValues[r].Value||!t&&r===0)&&i.val(n.ValidValues[r].Key).attr("backendValue",n.ValidValues[r].Value);i.hasClass("fr-param-autocomplete-error")&&i.removeClass("fr-param-autocomplete-error")},_writeBigDropDown:function(t,i,r,u){var e=this,l=!1,a=!1,c=!1,h=e._createDiv(["fr-param-element-container","fr-param-dropdown-div","fr-param-width"]),f=e._createInput(t,"text",!1,["fr-param","fr-param-dropdown-input","fr-param-not-close","fr-paramname-"+t.Name]),s,v,o;if(e._getParameterControlProperty(t,f),f.attr("autoCompleteDropdown","true"),e._paramValidation[t.Name].push("autoCompleteDropdown"),s=e._createDiv(["fr-param-dropdown-iconcontainer","fr-core-cursorpointer"]),v=e._createDiv(["fr-param-dropdown-icon","fr-param-not-close"]),s.append(v),i)return e._disabledSubSequenceControl(f),h.append(f).append(s),h;s.on("mousedown",function(){a=f.autocomplete("widget").is(":visible")});s.on("click",function(){f.attr("disabled")||(forerunner.device.isTouch()||f.focus(),a)||(e._closeAllDropdown(),setTimeout(function(){f.autocomplete("search","")},50))});for(o=0;o<t.ValidValues.length;o++)u!==undefined&&u===t.ValidValues[o].Value&&(t.ValidValues[o].Value===null&&(t.ValidValues[o].Value=n),f.val(t.ValidValues[o].Key).attr("title",t.ValidValues[o].Key).attr("backendValue",t.ValidValues[o].Value),l=!0),t.ValidValues[o].label=t.ValidValues[o].Key,t.ValidValues[o].value=t.ValidValues[o].Value;l||t.Nullable===!0||(e._loadedForDefault=!1);f.autocomplete({source:t.ValidValues,minLength:0,delay:0,autoFocus:!0,appendTo:e.$params,position:{of:h},maxItem:forerunner.config.getCustomSettingsValue("MaxBigDropdownItem",50),select:function(t,i){return i.item.value===null?f.attr("backendValue",n).attr("title",i.item.label).val(i.item.label).trigger("change",{item:i.item.value}):f.attr("backendValue",i.item.value).attr("title",i.item.label).val(i.item.label).trigger("change",{item:i.item.value}),c=!0,e.getNumOfVisibleParameters()===1&&setTimeout(function(){e._submitForm(r)},100),f.valid(),!1},focus:function(){return!1},response:function(n,t){t.content.length===0?f.addClass("fr-param-autocomplete-error"):f.removeClass("fr-param-autocomplete-error");f.val()!==""&&f.valid()},change:function(n,t){t.item?f.removeClass("fr-param-autocomplete-error"):(f.removeAttr("backendValue"),f.addClass("fr-param-autocomplete-error"));f.attr("required")||f.val()!==""||f.removeClass("fr-param-autocomplete-error");f.valid()},close:function(n){n.originalEvent&&n.originalEvent.originalEvent.type==="click"&&(c=!1)}});f.on("focus",function(){$(".ui-autocomplete",e.options.$appContainer).hide()});f.on("change",function(n,t){t||f.val()===""||n.stopImmediatePropagation()});f.on("keydown",function(n){if(n.keyCode===13){if(c){c=!1;return}e._submitForm(r)}});return e._setParamScrollPos(f),h.append(f).append(s),h},_writeDropDownControl:function(t,i,r,u){var o=this,a=!1,f=new $("<select class='fr-param fr-param-select fr-param-width fr-paramname-"+t.Name+"' name='"+t.Name+"' ismultiple='"+t.MultiValue+"' datatype='"+t.Type+"' readonly='true'>"),h,v,e,c,s,l;if(i)return o._disabledSubSequenceControl(f),f;for(o._getParameterControlProperty(t,f),h=o.options.$reportViewer.locData.getLocData().paramPane.select,v=new $("<option title='"+h+"' value=''>&#60"+h+"&#62<\/option>"),f.append(v),e=0;e<t.ValidValues.length;e++)c=forerunner.helper.htmlEncode(t.ValidValues[e].Key),s=t.ValidValues[e].Value,t.ValidValues[e].Value===null&&(s=n),l=new $("<option title='"+c+"' value='"+s+"'>"+c+"<\/option>"),u&&u===s&&(l.attr("selected","true"),f.attr("title",t.ValidValues[e].Key),a=!0),f.append(l);a||(o._loadedForDefault=!1);f.on("change",function(){f.attr("title",$(this).find("option:selected").text());o.getNumOfVisibleParameters()===1&&o._submitForm(r)});return f},_writeCascadingTree:function(n,t){var i=this,o=i._createDiv(["fr-param-element-container","fr-param-tree-container","fr-param-dropdown-div","fr-param-width"]),r=i._createInput(n,"text",!1,["fr-param-client","fr-param-not-close","fr-paramname-"+n.Name]),f,u,s,e,h;r.attr("cascadingTree",!0).attr("readonly","readonly").addClass("fr-param-tree-input").addClass("fr-param-dropdown-input");i._paramValidation[n.Name].push("cascadingTree");i._getParameterControlProperty(n,r);f=i._createInput(n,"hidden",!1,["fr-param","fr-paramname-"+n.Name]);i._setTreeElementProperty(n,f);i._setTreeDefaultValue(n,t,r,f);u=i._createDiv(["fr-param-tree","ui-corner-all","fr-param-not-close"]);s=i._getCascadingTree(n,1);u.append(s);e=i._createDiv(["fr-param-dropdown-iconcontainer","fr-core-cursorpointer"]);h=i._createDiv(["fr-param-dropdown-icon","fr-param-not-close"]);e.append(h);r.on("click",function(){i._showTreePanel(u,r)});e.on("click",function(){r.attr("disabled")||i._showTreePanel(u,r)});return i._addWriteParamDoneCallback(function(){i._setTreeSelectedValues(u)}),o.append(r).append(f).append(e).append(u),o},_showTreePanel:function(n,t){var r=this;if(n.is(":visible"))r._setTreeSelectedValues(n),n.hide();else{t.removeClass("fr-param-cascadingtree-error").attr("cascadingTree","");n.show();var i=t.parent(),u=forerunner.helper.parseCss(t,"marginLeft")+(t.outerWidth()-t.innerWidth())/2,f=forerunner.helper.parseCss(t,"marginTop")+i.outerHeight();n.css({top:f,left:u,"min-width":i.width()});t.blur()}},_writeCascadingChildren:function(n,t){var r=this,u=null,i=null;return u=r._createDiv(["fr-param-element-container"]),i=r._createInput(n,"hidden",!1,["fr-param","fr-paramname-"+n.Name]),i.val("#"),r._setTreeElementProperty(n,i),r._setTreeDefaultValue(n,t,null,i),u.append(i),u},_getCascadingTree:function(t,i){var f=this,u=null,r,o,c;if(!!t.ValidValues){var e=f._getPredefinedValue(t),s=f._dependencyList[t.Name].length>0,h=t.ValidValues.length;for(u=new $("<ul />"),u.attr("name",t.Name).attr("allowmultiple",t.MultiValue).attr("haschild",s).attr("nullable",t.Nullable).attr("level",i).attr("prompt",t.Prompt).addClass("fr-param-tree-ul"),t.isChild&&(u.attr("parent",t.Dependencies.join()),u.addClass("fr-param-tree-child")),r=0;r<h;r++)o=!1,t.ValidValues[r].Value===null&&(t.ValidValues[r].Value=n),e&&(t.MultiValue?f._contains(e,t.ValidValues[r].Value)&&(o=!0):e&&e===t.ValidValues[r].Value&&(o=!0)),c=f._getCascadingTreeItem(t,t.ValidValues[r],s,r===h-1,o,i),u.append(c)}return u},_getCascadingTreeItem:function(n,t,i,r,u,f){var o=this,e=new $("<li/>"),h,c,v,l,s,y,a,w,p;e.addClass("fr-param-tree-item").attr("value",t.Value);r&&e.addClass("fr-param-tree-item-last");h=new $("<i/>");h.addClass("fr-param-tree-icon");h.addClass("fr-param-tree-ocl");h.on("click",function(){if(e.hasClass("fr-param-tree-item-close")){if(o._revertLock===!0){e.children("ul").length!==0&&(e.children("ul").show(),e.removeClass("fr-param-tree-item-close").addClass("fr-param-tree-item-open"));return}if(o._setRuntimeTreeValues(e),e.children("ul").length===0?(e.addClass("fr-param-tree-loading"),o._refreshParameters(null,!0,n.Name)):e.children("ul").show(),n.MultiValue===!1){var t=o.element.find(".fr-param-tree-container ul[level='"+f+"']").children("li.fr-param-tree-item-open");$.each(t,function(n,t){$(t).children(".fr-param-tree-icon").trigger("click")})}e.removeClass("fr-param-tree-item-close").addClass("fr-param-tree-item-open")}else e.hasClass("fr-param-tree-item-open")&&(n.MultiValue===!1?o._clearTreeItemStatus(e.children("ul")):(o._revertLock===!0&&o._clearTreeItemStatus(e.children("ul")),e.children("ul").hide(),e.removeClass("fr-param-tree-item-open").addClass("fr-param-tree-item-close")))});c=new $("<i/>");c.addClass("fr-param-tree-icon fr-param-tree-icon-cb");n.MultiValue===!1&&c.addClass("fr-param-tree-icon-hidden");v=new $("<i/>");v.addClass("fr-param-tree-icon fr-param-tree-icon-theme");l=new $("<span/>");l.addClass("fr-param-tree-item-text");l.text(t.Key);s=new $("<a href=''/>");s.addClass("fr-param-tree-anchor");s.on("click",function(t){var u,r,c;if(t.preventDefault(),n.MultiValue===!1&&(i?(u=o.element.find(".fr-param-tree-container ul[level='"+f+"']").children("li.fr-param-tree-item-open"),$.each(u,function(n,t){if(e.attr("value")===$(t).attr("value"))return!0;$(t).children(".fr-param-tree-ocl").trigger("click")})):(u=o.element.find(".fr-param-tree-container ul[level='"+f+"']").children("li.fr-param-tree-item-selected"),$.each(u,function(n,t){if(e.attr("value")===$(t).attr("value"))return!0;$(t).children(".fr-param-tree-anchor").trigger("click")}))),r=e.children("ul"),c=r.attr("allowmultiple")==="true",s.hasClass("fr-param-tree-anchor-selected"))if(i){if(r.length!==0&&r.is(":visible")){if(s.removeClass("fr-param-tree-anchor-selected"),e.removeClass("fr-param-tree-item-selected"),c&&r.children("li.fr-param-tree-item-selected").length===0){s.trigger("click");return}r.find(".fr-param-tree-item .fr-param-tree-anchor").removeClass("fr-param-tree-anchor-selected");r.find(".fr-param-tree-item").removeClass("fr-param-tree-item-selected")}}else s.removeClass("fr-param-tree-anchor-selected"),e.removeClass("fr-param-tree-item-selected");else e.addClass("fr-param-tree-item-selected"),s.addClass("fr-param-tree-anchor-selected"),i&&c&&r.is(":visible")&&(r.children("li").children(".fr-param-tree-anchor").addClass("fr-param-tree-anchor-selected"),r.children("li").addClass("fr-param-tree-item-selected"));i&&(r.length===0||r.is(":visible")===!1)&&h.trigger("click");o._setParentStatus(e)});if(s.append(c).append(v).append(l),e.append(h).append(s),i)if(u){for(f+=1,y=o._dependencyList[n.Name],a=0;a<y.length;a++)w=o._parameterDefinitions[y[a]],p=o._getCascadingTree(w,f),p&&e.append(p);f-=1;e.addClass("fr-param-tree-item-open")}else e.addClass("fr-param-tree-item-close");return u&&!i&&o._addWriteParamDoneCallback(function(){s.trigger("click")}),e},_setParentStatus:function(n){var u=this;if(n.parent().attr("parent")){var i=n.parent(),t=i.parent("li"),r=t.children(".fr-param-tree-anchor");i.find("li a").filter(".fr-param-tree-anchor-selected").length===0?(t.removeClass("fr-param-tree-item-selected"),r.removeClass("fr-param-tree-anchor-selected")):(t.addClass("fr-param-tree-item-selected"),r.addClass("fr-param-tree-anchor-selected"));u._setParentStatus(t)}},_setRuntimeTreeValues:function(n){var i=this,t=n.parent(),u=t.attr("name"),r=i.element.find(".fr-paramname-"+u);t.attr("allowmultiple")==="true"?r.filter(".fr-param").val("#").attr("backendValue",'["'+n.attr("value")+'"]'):r.filter(".fr-param").val("#").attr("backendValue",n.attr("value"));t.attr("parent")&&i._setRuntimeTreeValues(t.parent("li"))},_setTreeSelectedValues:function(n){var r=this,t=null,u=null,s=null,f=null,i=null,c=!0,e=null,o=n.siblings(".fr-param-tree-input"),h,l;o.removeClass("fr-param-cascadingtree-error").attr("cascadingTree","");for(h in r._parameterDefinitions)r._parameterDefinitions.hasOwnProperty(h)&&(t=r._parameterDefinitions[h],(t.isParent||t.isChild)&&(u=r.element.find(".fr-paramname-"+t.Name),f="",t.MultiValue?(i=[],$.each(n.find("ul[name="+t.Name+"] > li.fr-param-tree-item-selected"),function(n,t){i.push($(t).attr("value"))}),i.length&&(f=JSON.stringify(i))):(l=n.find("ul[name="+t.Name+"] > li.fr-param-tree-item-selected"),i=l.attr("value"),i&&(f=i)),u.hasClass("fr-param-required")&&Boolean(f)===!1&&(e=e||[],e.push(t.Prompt),c=!1),u.filter(".fr-param").attr("backendValue",f),t.isParent&&!t.isChild&&(s=r._getTreeDisplayText(n),s?u.val(s):u.val(""))));c===!1&&(e.length&&o.attr("cascadingTree","["+e.join()+"]"),o.addClass("fr-param-cascadingtree-error"));o.blur()},_getTreeDisplayText:function(n){var u=this,t=n.children("ul");if(t.length===0)return"";var i=null,r=[],f=t.attr("haschild").toLowerCase()==="true"?!0:!1;return $.each(t.children("li.fr-param-tree-item-selected"),function(n,t){i=$(t).children("a").text();f&&(i+=u._getTreeDisplayText($(t)));r.push(i)}),t.hasClass("fr-param-tree-child")?"("+r.join()+")":r.join(", ")},_setTreeDefaultValue:function(n,t,i,r){var o=this,f=n.ValidValues,u,e;if(t){if(n.MultiValue){for(e=[],u=0;u<f.length;u++)o._contains(t,f[u].Value)&&e.push(f[u].Key);e.length&&(i&&i.val(e.join()),r.attr("backendValue",JSON.stringify(t)))}else for(u=0;u<f.length;u++)if(t&&t===f[u].Value){i&&i.val(f[u].Key);r.attr("backendValue",f[u].Value);break}}else o._loadedForDefault=!1},_setTreeItemStatus:function(n,t,i){var r=this,u=r.element.find(".fr-param-tree ul[name='"+n.Name+"']"),f;i&&u.children("li.fr-param-tree-item-open").children(".fr-param-tree-ocl").trigger("click");f=u.children("li");$.each(f,function(i,u){n.MultiValue?r._contains(t,$(u).attr("value"))&&$(u).children(".fr-param-tree-anchor").trigger("click"):$(u).attr("value")===t&&$(u).children(".fr-param-tree-anchor").trigger("click")})},_clearTreeItemStatus:function(n){var i=this,r=n.attr("haschild")==="true",t;r&&(t=n.children("li.fr-param-tree-item-open").children("ul"),$.each(t,function(n,t){i._clearTreeItemStatus($(t))}));n.children("li.fr-param-tree-item-selected").children(".fr-param-tree-anchor").removeClass("fr-param-tree-anchor-selected");n.children("li.fr-param-tree-item-selected").removeClass("fr-param-tree-item-selected");n.hide();n.parent("li").children(".fr-param-tree-anchor").removeClass("fr-param-tree-anchor-selected");n.parent("li").removeClass("fr-param-tree-item-selected").removeClass("fr-param-tree-item-open").addClass("fr-param-tree-item-close")},_closeCascadingTree:function(n){var t=this,i=t.element.find(".fr-param-tree");$.each(i,function(i,r){var u=$(r);(n||u.is(":visible"))&&(t._setTreeSelectedValues(u),u.hide())})},_setTreeElementProperty:function(n,t){var i=this;t.attr("treeInput","");t.attr("backendValue","");t.attr("allowblank",n.AllowBlank);t.attr("nullable",n.Nullable);t.addClass("fr-param-tree-hidden-input");n.AllowBlank===!1&&(t.attr("required"),t.addClass("fr-param-required"))},_getTreeItemChildren:function(n,t){var r=this,i=t||[];return r._dependencyList[n]&&$.each(r._dependencyList[n],function(n,t){i.indexOf(t)===-1&&(i.push(t),i=r._getTreeItemChildren(t,i))}),i},_createInput:function(n,t,i,r){var u=new $("<Input />"),f;for(u.attr("type",t),u.attr("name",n.Name),u.attr("ismultiple",n.MultiValue),u.attr("datatype",n.Type),u.attr("prompt",n.Prompt),i&&u.attr("readonly",!0),f=0;f<r.length;f++)u.addClass(r[f]);return u},_createDiv:function(n){for(var i=new $("<div />"),t=0;t<n.length;t++)i.addClass(n[t]);return i},_createLabel:function(n){for(var i=new $("<label />"),t=0;t<n.length;t++)i.addClass(n[t]);return i},_writeDropDownWithCheckBox:function(n,t,i){var r=this,o=r._createDiv(["fr-param-element-container","fr-param-dropdown-div","fr-param-width"]),f=r._createInput(n,"text",!0,["fr-param-client","fr-param-dropdown-input","fr-param-not-close","fr-paramname-"+n.Name]),h=r._createDiv(["fr-param-dropdown-iconcontainer","fr-core-cursorpointer"]),it=r._createDiv(["fr-param-dropdown-icon","fr-param-not-close"]),y,c,p,u,l,e,a,k,v;if(h.append(it),t)return r._disabledSubSequenceControl(f),o.append(f).append(h),o;r._getParameterControlProperty(n,f);y=r._createInput(n,"hidden",!1,["fr-param","fr-paramname-"+n.Name]);h.on("click",function(){f.attr("disabled")||r._popupDropDownPanel(n)});f.on("click",function(){r._popupDropDownPanel(n)});c=r._createDiv(["fr-param-dropdown","fr-param-not-close","fr-paramname-"+n.Name+"-dropdown-container"]);c.attr("value",n.Name);p=r._getDefaultHTMLTable();n.ValidValues.length&&n.ValidValues[n.ValidValues.length-1].Key!=="Select All"&&n.ValidValues.push({Key:"Select All",Value:"Select All"});var w="",rt="",b=null,d=!0;for(u=0;u<n.ValidValues.length;u++){a=u===0;a?(k=n.ValidValues[n.ValidValues.length-1],l=k.Key,e=k.Value):(l=n.ValidValues[u-1].Key,e=n.ValidValues[u-1].Value);var g=new $("<TR />"),nt=new $("<TD/>"),tt=new $("<Span />"),s=r._createInput(n,"checkbox",!1,["fr-param-dropdown-checkbox","fr-paramname-"+n.Name+"-dropdown-cb"]);s.attr("value",e);a&&(b=s);i&&r._contains(i,e)?(s.attr("checked","true"),w+=l+",",rt+=e+","):a||(d=!1);s.on("click",function(){var t,i,f,u;this.value==="Select All"?(this.checked===!0&&$(".fr-paramname-"+n.Name+"-dropdown-cb",r.$params).each(function(){this.checked=!0}),this.checked===!1&&$(".fr-paramname-"+n.Name+"-dropdown-cb",r.$params).each(function(){this.checked=!1})):(t=$(this).parents("table"),i=t.find("input[value='Select All']"),this.checked===!0?(f=t.find("input[value!='Select All']"),u=!0,f.each(function(n,t){t.checked===!1&&(u=!1)}),i.prop("checked",u)):i.prop("checked",!1))});v=r._createLabel(["fr-param-dropdown-label","fr-paramname-"+n.Name+"-dropdown-"+u.toString()+"-label"]);v.attr("for",n.Name+"_DropDown_"+u.toString());v.attr("value",e).text(l);tt.append(s).append(v);nt.append(tt);g.append(nt);p.append(g)}return b&&b.prop("checked",d),c.append(p),i&&r._containsSome(i,n.ValidValues)?(f.val(w.substr(0,w.length-1)),y.val(JSON.stringify(i))):r._loadedForDefault=!1,o.append(f).append(y).append(h).append(c),o.delegate("label","click",function(){$(this).siblings(".fr-param-dropdown-checkbox").trigger("click")}),o},_writeDropDownWithTextArea:function(n,t,i){var r=this,f=r._createDiv(["fr-param-element-container","fr-param-dropdown-div","fr-param-width"]),u=r._createInput(n,"text",!0,["fr-param","fr-param-dropdown-input","fr-param-not-close","fr-paramname-"+n.Name]),e=r._createDiv(["fr-param-dropdown-iconcontainer","fr-core-cursorpointer"]),h=r._createDiv(["fr-param-dropdown-icon","fr-param-not-close"]),o,s;if(e.append(h),t)return r._disabledSubSequenceControl(u),f.append(u).append(e),f;r._getParameterControlProperty(n,u);u.on("click",function(){r._popupDropDownPanel(n)});e.on("click",function(){u.attr("disabled")||r._popupDropDownPanel(n)});return o=r._createDiv(["fr-param-dropdown","fr-param-not-close","fr-paramname-"+n.Name+"-dropdown-container"]),o.attr("value",n.Name),s=new $("<textarea class='fr-param-dropdown-textarea fr-paramname-"+n.Name+"-dropdown-textArea' />"),i&&(s.val(r._getTextAreaValue(i,!0)),u.val(r._getTextAreaValue(i,!1)).attr("title",r._getTextAreaValue(i,!1)),u.attr("jsonValues",JSON.stringify(i))),o.append(s),f.append(u).append(e).append(o),f},_getTextAreaValue:function(n,t){var i="",r,u;if(t){for(r=0;r<n.length;r++)i+=n[r]+"\n";i=i.substr(0,i.length-1)}else{for(u=0;u<n.length;u++)i+=n[u]+",";i=i.substr(0,i.length-1)}return i},_setCheckBoxes:function(n,t){for(var i=0;i<n.length;i++)n[i].checked=$.inArray(n[i].value,t)>=0?!0:!1},_setMultipleInputValues:function(n){var i=this,t,e,r=$(".fr-paramname-"+n.Name,i.$params),u,f,o;e=r.val();r.hasClass("fr-param-client")?(u="",f=[],$(".fr-paramname-"+n.Name+"-dropdown-cb",i.$params).each(function(t){this.checked&&this.value!=="Select All"&&(u+=$(".fr-paramname-"+n.Name+"-dropdown-"+t.toString()+"-label",i.$params).text()+",",f.push(this.value))}),t=u.substr(0,u.length-1),$(".fr-paramname-"+n.Name,i.$params).val(t).attr("title",t),$(".fr-paramname-"+n.Name,i.$params).filter(".fr-param").val(JSON.stringify(f))):(t=$(".fr-paramname-"+n.Name+"-dropdown-textArea",i.$params).val(),o=t.split("\n"),t=t.replace(/\n+/g,","),t.charAt(t.length-1)===","&&(t=t.substr(0,t.length-1)),r.val(t).attr("title",t),r.attr("jsonValues",JSON.stringify(o)));e!==t&&r.change()},_popupDropDownPanel:function(n){var t=this,u=$(".fr-paramname-"+n.Name+"-dropdown-container",t.$params).is(":visible");if(t._closeAllDropdown(),!u){var f=t.$params,i=$(".fr-paramname-"+n.Name+"-dropdown-container",t.$params),r=$(".fr-paramname-"+n.Name,t.$params),e=r.offset().top;r.parent().css("z-index",1);f.height()-e-r.height()<i.height()?i.css("top",(i.height()+10)*-1):i.css("top",r.height()+9);i.is(":hidden")?i.width(r.width()+20).addClass("fr-param-dropdown-show").show(10):t._closeDropDownPanel(n)}},_closeDropDownPanel:function(n){var t=this;t._setMultipleInputValues(n);$(".fr-paramname-"+n.Name+"-dropdown-container",t.$params).removeClass("fr-param-dropdown-show").hide();$(".fr-paramname-"+n.Name,t.$params).focus().blur().parent().css("z-index","inherit")},_closeAllDropdown:function(){var n=this;$(".fr-param-dropdown-show",n.$params).filter(":visible").each(function(t,i){n._closeDropDownPanel({Name:$(i).attr("value")})});$(".ui-autocomplete",n.options.$appContainer).hide();n._closeCascadingTree(!1)},_checkExternalClick:function(n){var t=n.data.me;forerunner.helper.containElement(n.target,["fr-param-not-close"])||t._closeAllDropdown()},_shouldInclude:function(n,t){var r;if(!t)return!0;var i=this,u=$(n).attr("datatype")==="String",f=$(n).attr("allowblank")==="true";return u&&f?!0:n.value===""?i._isNullChecked(n):(r=!!$(n).attr("required"),r&&n.value===i.options.$reportViewer.locData.getLocData().paramPane.required)?!1:!0},_pushParam:function(n,t,i){i.Prompt=t.attr("prompt");n.push(i)},_getParamControls:function(){for(var r=this,i={},t=$(".fr-param",r.$params),n=0;n<t.length;n++)i[$(t[n]).attr("name")]=$(t[n]);return i},formIsValid:function(){var n=this;return n.$form&&n.$form.length===0||n.$form&&n.$form.validate().numberOfInvalids()<=0&&n.$form.valid()},getParamsList:function(n){var t=this,i,r,u,f,e;if(n||t._closeAllDropdown(),t._useDefault=!1,t.$form&&n||t.$form&&t.$form.length!==0&&t.$form.validate().numberOfInvalids()<=0&&t.$form.valid()){r=[];$(".fr-param",t.$params).filter(":text").each(function(u,f){if(i=$(f),i.hasClass("fr-usedefault"))return t._useDefault=!0,t._pushParam(r,i,{Parameter:f.name,UseDefault:"true"}),!0;if(t._shouldInclude(f,n))if(i.attr("ismultiple")==="false")t._pushParam(r,i,{Parameter:f.name,IsMultiple:i.attr("ismultiple"),Type:i.attr("datatype"),Value:t._isParamNullable(f)});else{var e=i.attr("jsonValues");t._pushParam(r,i,{Parameter:f.name,IsMultiple:i.attr("ismultiple"),Type:i.attr("datatype"),Value:JSON.parse(e?e:null)})}});$(".fr-param",t.$params).filter("[type='hidden']").each(function(u,f){if(i=$(f),i.hasClass("fr-usedefault"))return t._useDefault=!0,t._pushParam(r,i,{Parameter:f.name,UseDefault:"true"}),!0;if(t._shouldInclude(f,n))if(i.attr("ismultiple")==="false")t._pushParam(r,i,{Parameter:f.name,IsMultiple:i.attr("ismultiple"),Type:i.attr("datatype"),Value:t._isParamNullable(f)});else{var e=t._isParamNullable(f);t._pushParam(r,i,{Parameter:f.name,IsMultiple:i.attr("ismultiple"),Type:i.attr("datatype"),Value:JSON.parse(e?e:null)})}});$(".fr-param",t.$params).filter("select").each(function(u,f){if(i=$(f),i.hasClass("fr-usedefault"))return t._useDefault=!0,t._pushParam(r,i,{Parameter:f.name,UseDefault:"true"}),!0;var e=f.value!==null&&t._shouldInclude(f,n);e&&t._pushParam(r,i,{Parameter:f.name,IsMultiple:i.attr("ismultiple"),Type:i.attr("datatype"),Value:t._isParamNullable(f)})});u={};$(".fr-param",t.$params).filter(":radio").each(function(r,f){i=$(f);f.name in u||(!n||t._isNullChecked(f))&&(u[f.name]=null);f.checked===!0&&(u[f.name]=t._isParamNullable(f))});for(f in u)t.element.find(".fr-paramname-"+f).hasClass("fr-usedefault")?t._pushParam(r,i,{Parameter:f,UseDefault:"true"}):t._pushParam(r,i,{Parameter:f,IsMultiple:"",Type:"Boolean",Value:u[f]});return r.length===0?null:(e={ParamsList:r},JSON.stringify(e))}return null},_isNullChecked:function(n){var t=$(".fr-null-checkbox",this.$params).filter("[name='"+n.name+"']").first();return t.length!==0&&t.prop("checked")},_isParamNullable:function(t){var r=this,i=$(".fr-paramname-"+t.name,this.$params).filter(".fr-param"),u;return r._isNullChecked(t)?null:i.hasClass("fr-param-tree-hidden-input")?i.attr("backendValue")===n&&i.attr("nullable")==="true"?null:i.attr("backendValue"):i.attr("allowblank")==="true"&&i.val()===""?"":forerunner.helper.hasAttr(i,"backendValue")?i.attr("backendValue")===n&&i.attr("nullable")==="true"?null:i.attr("backendValue"):i.attr("datatype").toLowerCase()==="datetime"?(u=moment(i.val(),forerunner.ssr._internal.getMomentDateFormat(r.options.$reportViewer.locData),!0),u.format("YYYY-MM-DD")):i.attr("datatype").toLowerCase()==="boolean"?i.filter(":checked").val():i.val()===n?null:i.val()},_hasValidValues:function(n){var t=!0;return n.ValidValues===""&&n.ValidValuesQueryBased===!1&&(t=!1),t},removeParameter:function(){var n=this;n._formInit=!1;n.$params=null;n._submittedParamsList=null;n._parameterDefinitions=null;n._dependencyList=null;$("."+i,n.element).remove()},_getDefaultHTMLTable:function(){return $("<Table cellspacing='0' cellpadding='0'/>")},_contains:function(n,t){for(var i=n.length;i--;)if(n[i]===t)return!0;return!1},_containsSome:function(n,t){for(var r=n.length,i;r--;)for(i=t.length;i--;)if(n[r]===t[i].Value)return!0;return!1},_hasDefaultValue:function(n){var t=this;return t._defaultValueExist&&$.isArray(n.DefaultValues)},_getDateTimeFromDefault:function(n){var r=this,i,t;return n?(i=forerunner.ssr._internal.getDateFormat().toUpperCase(),t=moment(n,forerunner.ssr._internal.getStandardMomentDateFormat()),t.isValid()||r._DebugLog("_getDateTimeFromDefault",{defaultDatetime:n,dateFormat:i}),t.isValid()?t.format(i):null):null},_DebugLog:function(n,t){var r=this,i;r.isDebug&&(forerunner.device.isiOS()&&(i=r.$form.find(".fr-param-debug-error"),i.length===0&&(i=$("<div class='fr-param-debug-error error'><\/dev>"),r.$form.append(i)),i.text(n+", "+JSON.stringify(t))),console.log(n,t))},_checkDependencies:function(n){var t=this,i=!1;return $.isArray(n.Dependencies)&&n.Dependencies.length&&$.each(n.Dependencies,function(n,i){var r=$(".fr-paramname-"+i,t.$params).not("[type='hidden']"),u;r.off("change");r.on("change",function(){t._refreshParameters(null,!0,i)});if(u=$(".fr-null-checkbox",r.parent().parent()).not("[type='hidden']"),u.length===1)u.on("change",function(){$(this).is(":checked")&&t._refreshParameters(null,!0,i)})}),n.State==="HasOutstandingDependencies"&&(i=!0),i},_dataPreprocess:function(n,t){var i=this,r;i._parameterDefinitions={};i._dependencyList=[];$.each(n,function(n,r){i._paramValidation=i._paramValidation||{};i._dependencyList[r.Name]||(i._dependencyList[r.Name]=[]);i._parameterDefinitions[r.Name]=r;t&&(i._paramValidation[r.Name]=[]);i._parameterDefinitions[r.Name].enableCascadingTree=i.enableCascadingTree===!1?!1:!0;i.options.RDLExt&&i.options.RDLExt[r.Name]&&i.options.RDLExt[r.Name].enableCascadingTree===!1?i._parameterDefinitions[r.Name].enableCascadingTree=!1:i.options.RDLExt&&i.options.RDLExt[r.Name]&&i.options.RDLExt[r.Name].enableCascadingTree===!0&&(i._parameterDefinitions[r.Name].enableCascadingTree=!0);$.isArray(r.Dependencies)&&r.Dependencies.length&&(r.Dependencies.length!==1&&(i._parameterDefinitions[r.Name].enableCascadingTree=!1),i._dependencyList=i._dependencyList||{},i._parameterDefinitions[r.Name].isChild=!0,i._hasValidValues(i._parameterDefinitions[r.Name])===!1&&(i._parameterDefinitions[r.Name].enableCascadingTree=!1),r.Prompt===""&&(i._parameterDefinitions[r.Name].enableCascadingTree=!1),$.each(r.Dependencies,function(n,t){i._parameterDefinitions[t].isParent=!0;i._hasValidValues(i._parameterDefinitions[t])===!1&&(i._parameterDefinitions[r.Name].enableCascadingTree=!1);i._dependencyList[t]||(i._dependencyList[t]=[]);i._contains(i._dependencyList[t],r.Name)||(i._dependencyList[t].push(r.Name),i._dependencyList[t].length>1&&(i._parameterDefinitions[t].enableCascadingTree=!1))}))});r=function(n,t){var u=!0,f,e;if(i._parameterDefinitions[n].enableCascadingTree===!1&&(u=!1),u===!0&&t==="down"&&i._dependencyList[n])for(f=0;f<i._dependencyList[n].length;f++)if(u=r(i._dependencyList[n][f],t),u===!1)break;if(u===!0&&t==="up")for(e=0;e<i._parameterDefinitions[n].Dependencies.length;e++)if(u=r(i._parameterDefinitions[n].Dependencies[e],t),u===!1)break;return u};$.each(i._parameterDefinitions,function(n,t){t.enableCascadingTree&&(t.enableCascadingTree=r(t.Name,"up"));t.enableCascadingTree&&(t.enableCascadingTree=r(t.Name,"down"))})},_refreshParameters:function(n,t,i){var u=this,r=n?n:u.getParamsList(!0);t&&i&&(r=u._removeChildParam(r,i));r&&u.options.$reportViewer.refreshParameters(r,!1,-1,!1,t)},_removeChildParam:function(n,t){var f=this,i=n,e=null,u=f._dependencyList[t],o,r;if(u)for(o=u.length,r=0;r<o;r++)e=new RegExp('{"Parameter":"'+u[r]+'".+?},?',["g"]),i=n.replace(e,""),i.slice(-3)===",]}"&&(i=i.substring(0,i.length-3)+"]}"),f._dependencyList[u[r]]&&(i=f._removeChildParam(i,u[r]));return i},_disabledSubSequenceControl:function(n){n.attr("disabled",!0).addClass("fr-param-disable")},_getDatePickerLoc:function(){var n=this;return n.options.$reportViewer.locData.getLocData().datepicker},_paramWindowResize:function(n){var t=n.data.me;forerunner.helper.delay(t,function(){t.$datepickers.filter(".datepicker-focus").datepicker("hide").datepicker("show")},100,"_parameterDelayId")},destroy:function(){var n=this;n.removeParameter();$(document).off("click",n._checkExternalClick);n.$datepickers.length&&$(window).off("resize",n._paramWindowResize);this._destroy()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants.widgets;$.widget(n.getFullname(n.reportDocumentMap),{options:{$reportViewer:null},_create:function(){},_init:function(){},write:function(n){var i=this,t;this.element.html("");t=new $("<div class='fr-docmap-panel fr-docmap-panel-layout fr-core-widget'/>");t.append(i._writeDocumentMapItem(n.DocumentMap,0));i.element.append(t)},_writeDocumentMapItem:function(n,t){var e=this,i=new $("<div />"),u,f,r,o;t!==0&&i.css("margin-left","34px");u=new $("<div />");u.addClass("fr-docmap-item").attr("title","Navigate to "+n.Label).html(n.Label);u.on("click",{UniqueName:n.UniqueName},function(n){e.options.$reportViewer.navigateDocumentMap(n.data.UniqueName)});if(n.Children){f=new $("<DIV />");f.addClass("fr-docmap-parent-container");e._setFocus(f);r=new $("<div class='fr-docmap-icon'/>");t===0?r.addClass("fr-docmap-icon-up"):r.addClass("fr-docmap-icon-down");r.on("click",function(){var n=i.find("[level='"+t+"']");n.is(":visible")?(i.find("[level='"+t+"']").slideUpHide(),r.removeClass("fr-docmap-icon-up").addClass("fr-docmap-icon-down")):(i.find("[level='"+t+"']").slideUpShow(),r.removeClass("fr-docmap-icon-down").addClass("fr-docmap-icon-up"))});u.addClass("fr-docmap-item-root");f.append(r);f.append(u);i.append(f);o=new $("<div level='"+t+"'>");$.each(n.Children,function(n,i){o.append(e._writeDocumentMapItem(i,t+1))});i.append(o);t!==0&&o.hide()}else i.addClass("fr-docmap-item-container"),e._setFocus(i),i.append(u);return i},_setFocus:function(n){n.hover(function(){$(this).addClass("fr-docmap-item-highlight")},function(){$(this).removeClass("fr-docmap-item-highlight")})}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants.widgets,n=forerunner.ssr.constants.events;$.widget(t.getFullname("settingsPairWidget"),{options:{label1:null,name1:null,text1:null,unit1:null,label2:null,name2:null,text2:null,unit2:null},_init:function(){var n=this,i="",t,r;n.options.name1&&(i="name='"+n.options.name1+"'");t="";n.options.name2&&(t="name='"+n.options.name2+"'");n.element.html("");r=new $("<table class=fr-print-settings><tr><td><label class='fr-print-label'>"+n.options.label1+"<\/label><\/td><td><input class='fr-core-input fr-print-text' "+i+" type='text' value='"+n.options.text1+"'/><\/td><td><label class='fr-print-unit-label'>"+n.options.unit1+"<\/label><\/td><\/tr><tr><td><label class='fr-print-label'>"+n.options.label2+"<\/label><\/td><td><input class='fr-core-input fr-print-text' "+t+" type='text' value='"+n.options.text2+"'/><\/td><td><label class='fr-print-unit-label'>"+n.options.unit2+"<\/label><\/td><\/tr><\/table>");n.element.append(r);n.element.addClass("fr-print-settings-pair-widget")}});$.widget(t.getFullname(t.reportPrint),{options:{$reportViewer:null,$appContainer:null},_printData:null,_create:function(){},_init:function(){var n=this;n.locData=forerunner.localize},_initBody:function(){var t=this,i=t.locData.getLocData().print,r,u;t.element.html("");t.element.off(n.modalDialogGenericSubmit);t.element.off(n.modalDialogGenericCancel);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-printreport",i.title,"fr-print-cancel",i.cancel);u=new $("<div class='fr-core-dialog-innerPage fr-core-center'>"+r+"<form class='fr-print-form fr-core-dialog-form'><div class='fr-print-options-label'>"+i.pageLayoutOptions+"<\/div><div class=fr-print-height-width-id><\/div><div class='fr-print-orientation-container'><div class='fr-print-portrait'><\/div><div class='fr-print-landscape'><\/div><\/div><div class='fr-print-margins-label'>"+i.margin+"<\/div><div class=fr-print-top-bottom-id><\/div><div class=fr-print-left-right-id><\/div><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input name='submit' type='button' class='fr-print-submit-id fr-core-dialog-submit fr-core-dialog-button' value='"+i.print+"'/><\/div><\/div><\/form><\/div>");t.element.append(u);t.$form=t.element.find(".fr-print-form");t.$form.on("submit",function(){return!1});t._resetValidateMessage();t.element.find(".fr-print-submit-id").on("click",function(){t._submitPrint()});t.element.find(".fr-print-cancel").on("click",function(){t.closeDialog();t._printData&&t._createItems()});t.element.on(n.modalDialogGenericSubmit,function(){t._submitPrint()});t.element.on(n.modalDialogGenericCancel,function(){t.closeDialog()})},setPrint:function(n){var t=this;t._initBody();t._printData=n||t._printData;t._printData&&t._createItems(t._printData)},_submitPrint:function(){var n=this,t=n._generatePrintProperty();t!==null&&(n.options.$reportViewer.reportViewer("printReport",t),n.closeDialog())},_createItems:function(n){var t=this,i=t.locData.getLocData().print,r=i.unit;n=n||t._printData;t.element.find(".fr-print-height-width-id").settingsPairWidget({label1:i.pageHeight,name1:"PageHeight",text1:t._unitConvert(n.PageHeight),unit1:r,label2:i.pageWidth,name2:"PageWidth",text2:t._unitConvert(n.PageWidth),unit2:r});t.element.find(".fr-print-top-bottom-id").settingsPairWidget({label1:i.marginTop,name1:"MarginTop",text1:t._unitConvert(n.MarginTop),unit1:r,label2:i.marginBottom,name2:"MarginBottom",text2:t._unitConvert(n.MarginBottom),unit2:r});t.element.find(".fr-print-left-right-id").settingsPairWidget({label1:i.marginLeft,name1:"MarginLeft",text1:t._unitConvert(n.MarginLeft),unit1:r,label2:i.marginRight,name2:"MarginRight",text2:t._unitConvert(n.MarginRight),unit2:r});t.element.find(".fr-print-text").each(function(){$(this).attr("required","true").attr("number","true");$(this).parent().addClass("fr-print-item").append($("<span class='fr-print-error-span'/>").clone())});t._validateForm(t.$form);t.$pageWidth=t.element.find("[name=PageWidth]");t.$pageHeight=t.element.find("[name=PageHeight]");t.$pageWidth.on("change",function(){t._setOrientationIconState.call(t)});t.$pageHeight.on("change",function(){t._setOrientationIconState.call(t)});t.$printPortrait=t.element.find(".fr-print-portrait");t.$printLandscape=t.element.find(".fr-print-landscape");t.$printPortrait.on("click",function(){t._isPortrait()||t._swapWidthHeight()});t.$printLandscape.on("click",function(){t._isPortrait()&&t._swapWidthHeight()});t._setOrientationIconState();$(":text",t.element).each(function(){var n=$(this);n.on("blur",function(){t.options.$reportViewer.reportViewer("onInputBlur")});n.on("focus",function(){t.options.$reportViewer.reportViewer("onInputFocus")})})},_isPortrait:function(){var n=this;return Number(n.$pageWidth.val())>Number(n.$pageHeight.val())?!1:!0},_swapWidthHeight:function(){var n=this,t=n.$pageWidth.val();n.$pageWidth.val(n.$pageHeight.val());n.$pageHeight.val(t);n._setOrientationIconState()},_setOrientationIconState:function(){var n=this;Number(n.$pageWidth.val())>Number(n.$pageHeight.val())?(n.$printLandscape.removeClass("fr-core-cursorpointer"),n.$printLandscape.removeClass("fr-print-landscape-icon"),n.$printLandscape.addClass("fr-print-landscape-icon-active"),n.$printPortrait.removeClass("fr-print-portrait-icon-active"),n.$printPortrait.addClass("fr-core-cursorpointer"),n.$printPortrait.addClass("fr-print-portrait-icon")):(n.$printLandscape.addClass("fr-core-cursorpointer"),n.$printLandscape.removeClass("fr-print-landscape-icon-active"),n.$printLandscape.addClass("fr-print-landscape-icon"),n.$printPortrait.removeClass("fr-print-portrait-icon"),n.$printPortrait.removeClass("fr-core-cursorpointer"),n.$printPortrait.addClass("fr-print-portrait-icon-active"))},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},_validateForm:function(n){n.validate({errorPlacement:function(n,t){n.appendTo($(t).parent().find("span"))},highlight:function(n){$(n).parent().find("span").addClass("fr-print-error-position");$(n).addClass("fr-print-error")},unhighlight:function(n){$(n).parent().find("span").removeClass("fr-print-error-position");$(n).removeClass("fr-print-error")}})},_generatePrintProperty:function(){var n=this,t=[],i;return n.$form.valid()===!0?(n.element.find(".fr-print-text").each(function(){t.push({key:this.name,value:n._generateUnitConvert(this.value)})}),i={PrintPropertyList:t},JSON.stringify(i)):null},_resetValidateMessage:function(){var t=this,n=t.locData.getLocData().validateError;jQuery.extend(jQuery.validator.messages,{required:n.required,number:n.number,digits:n.digits})},_unitConvert:function(n){var t=this;return t.locData.getLocData().print.unit==="in"?Math.round(n/25.4*100)/100:n},_generateUnitConvert:function(n){var t=this;return t.locData.getLocData().print.unit==="mm"?Math.round(n/25.4*100)/100:n},destroy:function(){var n=this;n._printData=null;this._destroy()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,r=forerunner.localize,n;$.widget(i.getFullname(i.manageParamSets),{options:{$reportViewer:null,$appContainer:null,model:null},_initTBody:function(){var n=this;(n.serverData=n.options.model.parameterModel("cloneServerData"),n.serverData!==null&&n.serverData!==undefined)&&(n._createRows(),n.lastAddedSetId=null)},_createRows:function(){var n=this,t;n.element.find(".fr-mps-default-id").off("click");n.element.find(".fr-mps-all-users-id").off("click");n.element.find(".fr-mps-delete-id").off("click");n.element.find(".fr-mps-text-input").off("change").off("click").off("focus").off("blur");n.$tbody.html("");t=n.options.model.parameterModel("getOptionArray",n.serverData.parameterSets);$.each(t,function(t,i){if(t>0){var r=n.serverData.parameterSets[i.id],u=n._createRow(t,r);n.$tbody.append(u)}});n._validateForm(n.$form)},_createRow:function(t,i){var r=this,s="",o;r.serverData.canEditAllUsersSet&&(s=" fr-core-cursorpointer");var e=i.name&&forerunner.helper.htmlEncode(i.name),h="<input type='text' required='true' name=name"+t+" class='fr-mps-text-input fr-core-input'/><span class='fr-mps-error-span'/>",c="fr-mps-all-users-check-id ",l=" class='ui-icon-circle-close ui-icon fr-core-center'";i.isAllUser&&(r.serverData.canEditAllUsersSet||(h=e,l=""),c="fr-mps-all-users-check-id ui-icon-check ui-icon ");o="fr-mps-default-check-id ";i.id===r.serverData.defaultSetId&&(o="fr-mps-default-check-id ui-icon-check ui-icon ");var a=t+1&1?" class='fr-mps-odd-row'":"",u=$("<tr"+a+" modelid='"+i.id+"'><td>"+h+"<\/td><td class='fr-mps-default-id fr-core-cursorpointer'><div class='"+o+"fr-core-center' /><\/td><td class='fr-mps-all-users-id"+s+"'><div class='"+c+"fr-core-center' /><\/td><td class='fr-mps-delete-id ui-state-error-text fr-core-cursorpointer'><div"+l+"/><\/td><\/tr>"),f=u.find("input");e?f.val(e).attr("title",e):f.watermark(n.newSet,forerunner.config.getWatermarkConfig());f.on("change",function(n){r._onChangeInput(n)});f.on("focus",function(){r.options.$reportViewer.reportViewer("onInputFocus")});f.on("blur",function(){r.options.$reportViewer.reportViewer("onInputBlur")});u.find(".fr-mps-default-id").on("click",function(n){r._onClickDefault(n)});if(r.serverData.canEditAllUsersSet)u.find("td.fr-mps-all-users-id").on("click",function(n){r._onClickAllUsers(n)});if(r.serverData.canEditAllUsersSet||!i.isAllUser)u.find("td.fr-mps-delete-id").on("click",function(n){r._onClickDelete(n)});return u},_init:function(){var i=this,u,f;n=r.getLocData().manageParamSets;i.element.html("");i.element.off(t.modalDialogGenericSubmit);i.element.off(t.modalDialogGenericCancel);u=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-parameterSets",n.manageSets,"fr-mps-cancel",n.cancel);f=$("<div class='fr-core-dialog-innerPage fr-core-center'>"+u+"<form class='fr-mps-form fr-core-dialog-form'><div class='fr-core-center'><input name='add' type='button' value='"+n.add+"' title='"+n.addNewSet+"' class='fr-mps-add-id fr-core-action-button'/><table class='fr-mps-main-table'><thead><tr><th class='fr-mps-name-header'>"+n.name+"<\/th><th class='fr-mps-property-header'>"+n.defaultHeader+"<\/th><th class='fr-mps-property-header'>"+n.allUsers+"<\/th><th class='fr-mps-property-header'>"+n.deleteHeader+"<\/th><\/tr><\/thead><tbody class='fr-mps-main-table-body-id'><\/tbody><\/table><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input type='button' class='fr-mps-submit-id fr-core-dialog-submit fr-core-dialog-button' value='"+n.apply+"' /><\/div><\/div><\/div><\/form><\/div>");i.element.append(f);i.$tbody=i.element.find(".fr-mps-main-table-body-id");i._initTBody();i.$form=i.element.find(".fr-mps-form");i.$form.on("submit",function(){return!1});i._resetValidateMessage();i.element.find(".fr-mps-cancel").on("click",function(){i.closeDialog()});i.element.find(".fr-mps-add-id").on("click",function(n){i._onAdd(n)});i.element.find(".fr-mps-submit-id").on("click",function(){i._submitParamSet()});i.element.on(t.modalDialogGenericSubmit,function(){i._submitParamSet()});i.element.on(t.modalDialogGenericCancel,function(){i.closeDialog()})},_submitParamSet:function(){var n=this;n.$form.valid()===!0&&(n.options.model.parameterModel("applyServerData",n.serverData,n.lastAddedSetId),n.closeDialog())},_findId:function(n){for(var i=$(n.target),t=i;!t.is("tr")&&!t.is("table");)t=t.parent();return t.is("tr")?t.attr("modelid"):null},_findRow:function(n){var t=this;return t.$tbody.find("[modelid='"+n+"']")},_onAdd:function(){var n=this,t=n.options.model.parameterModel("getNewSet",n.parameterList),i,r,u;n.serverData.parameterSets[t.id]=t;i=n.options.model.parameterModel("getSetCount",n.serverData);i===1&&(n.serverData.defaultSetId=t.id);r=n._createRow(i,t);n.$tbody.append(r);u=r.find("input");u.focus();n.lastAddedSetId=t.id;n._validateForm(n.$form)},_onChangeInput:function(n){var i=this,t=$(n.target),r;t.attr("title",t.val());r=i._findId(n);i.serverData.parameterSets[r].name=t.val()},_onClickDefault:function(n){var i=this,t;i.$tbody.find(".fr-mps-default-id div").removeClass("ui-icon-check ui-icon");t=$(n.target);t.hasClass("fr-mps-default-check-id")||(t=t.find(".fr-mps-default-check-id"));t.addClass("ui-icon-check ui-icon");i.serverData.defaultSetId=i._findId(n)},_onClickAllUsers:function(n){var r=this,t=$(n.target),u,i;t.hasClass("fr-mps-all-users-check-id")||(t=t.find(".fr-mps-all-users-check-id"));t.toggleClass("ui-icon-check ui-icon");u=r._findId(n);i=r.serverData.parameterSets[u];i.isAllUser=!i.isAllUser},_onClickDelete:function(n){var t=this,u=t.options.model.parameterModel("getSetCount",t.serverData),i=t._findId(n),f=t._findRow(i),r;f.remove();u===1?t.serverData.defaultSetId=null:i===t.serverData.defaultSetId&&(r=t.$tbody.find(".fr-mps-default-check-id").first(),t._onClickDefault({target:r}));i===t.lastAddedSetId&&(t.lastAddedSetId=t.serverData.defaultSetId);delete t.serverData.parameterSets[i]},openDialog:function(n){var t=this,i;n&&(t.parameterList=JSON.parse(n),forerunner.dialog.showModalDialog(t.options.$appContainer,t),i=t.options.model.parameterModel("getCurrentSet"),i&&!i.data&&(i.data=t.parameterList))},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},_validateForm:function(n){n.validate({errorPlacement:function(n,t){n.appendTo($(t).parent().find("span"))},highlight:function(n){$(n).parent().find("span").addClass("fr-mps-error-position");$(n).addClass("fr-mps-error")},unhighlight:function(n){$(n).parent().find("span").removeClass("fr-mps-error-position");$(n).removeClass("fr-mps-error")}})},_resetValidateMessage:function(){var t=this,n=r.getLocData().validateError;jQuery.extend(jQuery.validator.messages,{required:n.required,number:n.number,digits:n.digits})}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var r=forerunner.ssr,i=forerunner.ssr.constants,n=i.events,u=r.constants.toolTypes,t=i.widgets,f=forerunner.localize;r.ReportViewerInitializer=function(n){var t=this;t.options={$toolbar:null,$toolPane:null,$routeLink:null,$viewer:null,$nav:null,$paramarea:null,$lefttoolbar:null,$righttoolbar:null,$docMap:null,ReportViewerAPI:forerunner.config.forerunnerAPIBase()+"ReportViewer",ReportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager",toolbarHeight:null,navigateTo:null,isReportManager:!1,userSettings:null,$appContainer:null,rsInstance:null,useReportManagerSettings:!1,$unzoomtoolbar:null,toolbarConfigOption:i.toolbarConfigOption.full,dbConfig:{}};n&&$.extend(t.options,n);t.parameterModel=null;t.subscriptionModel=null};r.ReportViewerInitializer.prototype={getParameterModel:function(){var n=this;return n.parameterModel},render:function(){var t=this,r=t.options.$viewer,c=t.options.userSettings,u,e,l,o,b,p,w,a,s,h,v,y,f;if(t.options.dbConfig.UseMobilizerDB===!0&&(t.options.isReportManager||t.options.useReportManagerSettings)&&(t.parameterModel=$({}).parameterModel({rsInstance:t.options.rsInstance}),t.subscriptionModel=$({}).subscriptionModel({rsInstance:t.options.rsInstance})),r.reportViewer({reportViewerAPI:t.options.ReportViewerAPI,jsonPath:t.options.jsonPath,docMapArea:t.options.$docMap,parameterModel:t.parameterModel,userSettings:c,$appContainer:t.options.$appContainer,rsInstance:t.options.rsInstance,showSubscriptionUI:(t.options.isReportManager||t.options.useReportManagerSettings)&&forerunner.config.getCustomSettingsValue("showSubscriptionUI","on")==="on",zoom:t.options.zoom,showSubscriptionOnOpen:t.options.showSubscriptionOnOpen}),(t.options.isReportManager||t.options.useReportManagerSettings)&&!c&&(c=forerunner.ajax.getUserSetting(t.options.rsInstance)),t.options.$docMap.hide(),u=t.options.$toolbar,u.toolbar({dbConfig:t.options.dbConfig,$reportViewer:r,$ReportViewerInitializer:t,$appContainer:t.options.$appContainer}),e=forerunner.ssr.tools.mergedButtons,l=forerunner.ssr.tools.rightToolbar,t.options.isReportManager&&(o=[],forerunner.config.getCustomSettingsValue("showHomeButton","off")==="on"&&o.push(e.btnHome),t.options.dbConfig.UseMobilizerDB===!0&&(t.options.dbConfig.SeperateDB!==!0&&o.push(e.btnRecent),o.push(e.btnFavorite)),o.push(e.btnLogOff),u.toolbar("addTools",12,!0,o),forerunner.ajax.isFormsAuth(function(n){n||u.toolbar("hideTool",e.btnLogOff.selectorClass)}),t.options.dbConfig.UseMobilizerDB===!0&&(u.toolbar("addTools",4,!0,[e.btnFav]),u.toolbar("disableTools",[e.btnFav]))),t.options.toolbarConfigOption===i.toolbarConfigOption.hide?u.hide():(t.options.toolbarConfigOption&&t.options.toolbarConfigOption!==i.toolbarConfigOption.full&&u.toolbar("configure",t.options.toolbarConfigOption),b=u.outerHeight()+(t.options.$routeLink.is(":visible")?t.options.$routeLink.outerHeight():0),r.reportViewer("option","toolbarHeight",b),u.show()),p=t.options.$unzoomtoolbar,p!==null&&p.unzoomToolbar({$reportViewer:r,$ReportViewerInitializer:t,$appContainer:t.options.$appContainer}),w=t.options.$lefttoolbar,w!==null&&w.leftToolbar({$reportViewer:r,$ReportViewerInitializer:t,$appContainer:t.options.$appContainer}),a=t.options.$righttoolbar,a!==null&&a.rightToolbar({$reportViewer:r,$ReportViewerInitializer:t,$appContainer:t.options.$appContainer}),t.options.dbConfig.UseMobilizerDB===!0&&(t.options.isReportManager||t.options.useReportManagerSettings)&&a.rightToolbar("addTools",2,!0,[l.btnRTBManageSets,l.btnSelectSet,l.btnSavParam]),s=forerunner.ssr.tools.mergedItems,h=t.options.$toolPane.toolPane({dbConfig:t.options.dbConfig,$reportViewer:r,$ReportViewerInitializer:t,$appContainer:t.options.$appContainer}),t.favoriteInstance=null,t.favoriteInstance=$({}).favoriteModel({$toolbar:t.options.$toolbar,$toolpane:t.options.$toolPane,$appContainer:t.options.$appContainer,rsInstance:t.options.rsInstance}),t.options.isReportManager&&t.options.dbConfig.UseMobilizerDB===!0){h.toolPane("addTools",2,!0,[s.itemFolders]);h.toolPane("addTools",5,!0,[s.itemFav]);h.toolPane("disableTools",[s.itemFav]);r.on(n.reportViewerChangePage(),function(){h.toolPane("enableTools",[s.itemFav]);u.toolbar("enableTools",[e.btnFav])});r.on(n.reportViewerDrillThrough(),function(){t.favoriteInstance.favoriteModel("setFavoriteState",r.reportViewer("getReportPath"))});r.on(n.reportViewerChangeReport(),function(){t.favoriteInstance.favoriteModel("setFavoriteState",r.reportViewer("getReportPath"))});r.on(n.reportViewerPreLoadReport(),function(n,i){i.newPath&&t.favoriteInstance.favoriteModel("setFavoriteState",i.newPath)})}v=t.options.$nav;v!==null&&(v.pageNav({$reportViewer:r,$appContainer:t.options.$appContainer,rsInstance:t.options.rsInstance}),r.reportViewer("option","pageNavArea",v));y=t.options.$paramarea;y!==null&&(y.reportParameter({$reportViewer:r}),r.reportViewer("option","paramArea",y));f=t._findSection("fr-print-section");f.reportPrint({$appContainer:t.options.$appContainer,$reportViewer:r});t.options.dbConfig.UseMobilizerDB===!0&&(f=t._findSection("fr-managesubscription-section"),f.manageSubscription({$appContainer:t.options.$appContainer,$reportViewer:r,subscriptionModel:t.subscriptionModel}),f=t._findSection("fr-emailsubscription-section"),f.emailSubscription({$appContainer:t.options.$appContainer,$reportViewer:r,subscriptionModel:t.subscriptionModel,userSettings:c}),t.parameterModel&&(f=t._findSection("fr-mps-section"),f.manageParamSets({$appContainer:t.options.$appContainer,$reportViewer:r,$reportViewerInitializer:t,model:t.parameterModel}),t._manageParamSetsDialog=f));f=t._findSection("fr-dsc-section");f.dsCredential({$appContainer:t.options.$appContainer,$reportViewer:r})},_findSection:function(n){var i=this,t=i.options.$appContainer.find("."+n);return t.length===0&&(t=new $("<div class='fr-dialog-id fr-core-dialog-layout fr-core-widget'/>"),t.addClass(n),i.options.$appContainer.append(t)),t},showManageParamSetsDialog:function(n){var t=this,i=t.options.$viewer;t._manageParamSetsDialog.manageParamSets({$appContainer:t.options.$appContainer,$reportViewer:i,$reportViewerInitializer:t,model:t.parameterModel});t._manageParamSetsDialog.manageParamSets("openDialog",n)}};$.widget(t.getFullname(t.unzoomToolbar),$.forerunner.toolBase,{options:{$reportViewer:null,$ReportViewerInitializer:null,toolClass:"fr-toolbar-zoom",$appContainer:null},_init:function(){var n=this,t,i;n._super();t=forerunner.ssr.tools.unZoomToolbar;n.element.html("");i=new $("<div class='"+n.options.toolClass+" fr-core-widget' />");$(n.element).append(i);n.addTools(1,!0,[t.btnUnZoom])}});$.widget(t.getFullname(t.leftToolbar),$.forerunner.toolBase,{options:{$reportViewer:null,$ReportViewerInitializer:null,toolClass:"fr-toolbar-slide",$appContainer:null},_init:function(){var n=this,t,i;n._super();t=forerunner.ssr.tools.leftToolbar;n.element.html("");i=new $("<div class='"+n.options.toolClass+" fr-core-widget' />");$(n.element).append(i);n.addTools(1,!0,[t.btnLTBMenu])}});$.widget(t.getFullname(t.rightToolbar),$.forerunner.toolBase,{options:{$reportViewer:null,$ReportViewerInitializer:null,toolClass:"fr-toolbar-slide",$appContainer:null},_initCallbacks:function(){var t=this;if(t.parameterModel){t.parameterModel.on(n.parameterModelChanged(),function(n,i){t._onModelChange.call(t,n,i)});t.parameterModel.on(n.parameterModelSetChanged(),function(n,i){t._onModelChange.call(t,n,i)})}},_init:function(){var n=this,t,i;n._super();t=forerunner.ssr.tools.rightToolbar;n.parameterModel=n.options.$ReportViewerInitializer.getParameterModel();n.element.html("");i=new $("<div class='"+n.options.toolClass+" fr-core-widget' />");$(n.element).append(i);n.addTools(1,!0,[t.btnRTBParamarea]);n._initCallbacks()},_onModelChange:function(){var n=this,t=forerunner.ssr.tools.rightToolbar;n.parameterModel&&n.parameterModel.parameterModel("canUserSaveCurrentSet")?n.enableTools([t.btnSavParam]):n.disableTools([t.btnSavParam])}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants,n=i.widgets,t=i.events,u=forerunner.helper,r=forerunner.ssr.constants.properties;$.widget(n.getFullname(n.reportViewerEZ),$.forerunner.toolBase,{options:{DefaultAppTemplate:null,jsonPath:null,navigateTo:null,historyBack:null,isReportManager:!1,isFullScreen:!0,userSettings:null,rsInstance:null,useReportManagerSettings:!1,toolbarConfigOption:i.toolbarConfigOption.full,handleWindowResize:!0,showBreadCrumb:!1,showParameterArea:"Collapsed",zoom:"100",dbConfig:{}},_render:function(){var u=this,n=u.DefaultAppTemplate,f,e;n.$bottomdivspacer.addClass("fr-nav-spacer").hide();n.$bottomdiv.addClass("fr-nav-container").hide();n.$bottomdiv.css("position",u.options.isFullScreen?"fixed":"absolute");n.$mainsection.html(null);f=new $("<DIV />");f.addClass("fr-layout-reportviewer");n.$mainsection.append(f);u.$viewer=f;e=new forerunner.ssr.ReportViewerInitializer({$toolbar:n.$mainheadersection,$toolPane:n.$leftpanecontent,$routeLink:n.$linksection,$viewer:f,$nav:n.$bottomdiv,$paramarea:n.$rightpanecontent,$lefttoolbar:n.$leftheader,$righttoolbar:n.$rightheader,$docMap:n.$docmapsection,ReportViewerAPI:forerunner.config.forerunnerAPIBase()+"ReportViewer",jsonPath:u.options.jsonPath,navigateTo:u.options.navigateTo,isReportManager:u.options.isReportManager,userSettings:u.options.userSettings,$appContainer:n.$container,rsInstance:u.options.rsInstance,useReportManagerSettings:u.options.useReportManagerSettings,$unzoomtoolbar:n.$unzoomsection,toolbarConfigOption:u.options.toolbarConfigOption,zoom:u.options.zoom,showSubscriptionOnOpen:u.options.showSubscriptionOnOpen,dbConfig:u.options.dbConfig});e.render();f.on(t.reportViewerBack(),function(t,i){n._selectedItemPath=i.path;n.$viewer=void 0;u.options.historyBack&&u.options.historyBack()});f.on(t.reportViewerActionHistoryPop(),function(){u.options.historyBack||f.reportViewer("actionHistoryDepth")!==0||(n.$mainheadersection.toolbar("disableTools",[forerunner.ssr.tools.toolbar.btnReportBack]),n.$leftpanecontent.toolPane("disableTools",[forerunner.ssr.tools.toolpane.itemReportBack]))});f.on(t.reportViewerActionHistoryPush(),function(){u.options.historyBack||(n.$mainheadersection.toolbar("enableTools",[forerunner.ssr.tools.toolbar.btnReportBack]),n.$leftpanecontent.toolPane("enableTools",[forerunner.ssr.tools.toolpane.itemReportBack]))});f.on(t.reportViewerPreLoadReport(),function(t,i){u.options.DefaultAppTemplate===null&&i.viewer.dynamicReport!==!0&&(n.$propertySection.forerunnerProperties("option","rsInstance",u.options.rsInstance),n.$propertySection.forerunnerProperties("setProperties","viewer",i.newPath,[r.description,r.tags,r.rdlExtension,r.visibility]))});f.on(t.reportViewerChangePage(),function(){u.options.isFullScreen&&forerunner.device.isMobile()&&f.reportViewer("scrollReportBody")});u.options.historyBack&&(n.$mainheadersection.toolbar("enableTools",[forerunner.ssr.tools.toolbar.btnReportBack]),n.$leftpanecontent.toolPane("enableTools",[forerunner.ssr.tools.toolpane.itemReportBack]));u.DefaultAppTemplate.bindViewerEvents();u.options.toolbarConfigOption===i.toolbarConfigOption.hide&&n.removeTopDiv(!0)},_create:function(){var n=this;if(n.options.handleWindowResize)$(window).on("resize",function(){u.delay(n,function(){n.windowResize.call(n)})})},_init:function(){var n=this,t,i,u,r,f;forerunner.ssr._internal.init();n._super();n.DefaultAppTemplate=n.options.DefaultAppTemplate===null?new forerunner.ssr.DefaultAppTemplate({$container:n.element,isFullScreen:n.options.isFullScreen}).render():n.options.DefaultAppTemplate;n.options.showBreadCrumb===!1&&n.DefaultAppTemplate.$linksection.hide();n._render();n.options.isFullScreen&&forerunner.device.isWindowsPhone()&&!forerunner.device.isWindowsPhone81()&&(t=$("#fr-viewport-style"),t.length===0&&(i="fixed",sessionStorage.forerunner_zoomReload_userZoom&&(u=sessionStorage.forerunner_zoomReload_userZoom,delete sessionStorage.forerunner_zoomReload_userZoom,r=JSON.parse(u),r.userZoom&&(i=r.userZoom)),t=$("<style id=fr-viewport-style>@-ms-viewport {width:auto; user-zoom:"+i+";}<\/style>"),f=$("<style>ul.fr-nav-container, .fr-layout-leftpane, .fr-layout-rightpane { -ms-overflow-style: none; }<\/style>"),$("head").slice(0).append(t).append(f),i==="zoom"&&(forerunner.device.allowZoom(!0),n.DefaultAppTemplate.showUnZoomPane.call(n.DefaultAppTemplate))))},windowResize:function(){var t=this,i,r;t.$viewer&&t.$viewer.is(":visible")!==!1&&(t.DefaultAppTemplate!==null&&t.DefaultAppTemplate.windowResize.call(t.DefaultAppTemplate),i=t.getReportViewer(),n.hasWidget(i,n.reportViewer)&&i.reportViewer("windowResize"),t.options.isFullScreen&&forerunner.device.isiOS()&&n.hasWidget(i,n.reportViewer)&&i.reportViewer("scrollReportBody"),r=t.getToolbar(),n.hasWidget(r,n.toolbar)&&setInterval(function(){t.getToolbar().toolbar("windowResize")},100))},getPageNav:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$bottomdiv:null},getReportDocumentMap:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$docmapsection:null},getReportParameter:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$rightpanecontent:null},getReportViewer:function(){var t=this,n;return t.DefaultAppTemplate&&(n=t.DefaultAppTemplate.$mainsection.find(".fr-layout-reportviewer"),n.length!==0)?n:null},getToolbar:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$mainheadersection:null},getToolPane:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$leftpanecontent:null},getLeftToolbar:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$leftheader:null},getRightToolbar:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$rightheader:null}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,r=forerunner.localize,n;$.widget(i.getFullname(i.dsCredential),{options:{$reportViewer:null,$appContainer:null},_credentialData:null,_create:function(){},_init:function(){var n=this;n.dsCredential=r.getLocData().dsCredential},_initBody:function(){var i=this,r,u;i.element.html("");i.element.off(t.modalDialogGenericSubmit);i.element.off(t.modalDialogGenericCancel);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-dataSourceCred",n.title,"fr-dsc-cancel",n.cancel);u=$("<div class='fr-core-dialog-innerPage fr-core-center fr-dsc-innerPage'>"+r+"<form class='fr-core-dialog-form fr-dsc-form'><div class='fr-core-center'><div class='fr-dsc-main-container'><\/div><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input name='submit' type='button' class='fr-dsc-submit-id fr-dsc-button fr-core-dialog-button' value='"+n.submit+"' /><input name='reset' type='button' class='fr-dsc-reset-id fr-dsc-button fr-core-dialog-button' value='"+n.reset+"' /><\/div><\/div><\/div><\/form><\/div>");i.element.append(u);i.$container=i.element.find(".fr-dsc-main-container");i.$form=i.element.find(".fr-dsc-form");i.$form.on("submit",function(){return!1});i._resetValidateMessage();i.element.find(".fr-dsc-cancel").on("click",function(){i.closeDialog();i._credentialData&&i._createRows()});i.element.find(".fr-dsc-reset-id").on("click",function(){i._resetCredential()});i.element.find(".fr-dsc-submit-id").on("click",function(){i._submitCredential()});i.element.on(t.modalDialogGenericSubmit,function(){i._submitCredential()});i.element.on(t.modalDialogGenericCancel,function(){i.closeDialog()});i.options.$reportViewer&&i._initCallback()},_createRows:function(t){var i=this;t=t||i._credentialData;i.$container.html("");$.each(t,function(t,r){var u=$("<div class='fr-dsc-item-container' name='"+r.DataSourceID+"'><div class='fr-dsc-prompt'><div>"+r.Name+" - "+r.Prompt+"<\/div><\/div><div class='fr-dsc-username'><label class='fr-dsc-label' >"+n.username+"<\/label><div class='fr-dsc-input-container'><input type='text' autocomplete='off' name='"+r.Name+"-username' required='true' class='fr-core-input fr-dsc-text-input fr-dsc-username-input' /><span class='fr-dsc-error-span' /><\/div><\/div><div class='fr-dsc-password'><label class='fr-dsc-label' >"+n.password+"<\/label><div class='fr-dsc-input-container'><input type='password' autocomplete='off' name='"+r.Name+"-password' required='true' class='fr-core-input fr-dsc-text-input fr-dsc-password-input' /><span class='fr-dsc-error-span' /><\/div><\/div><\/div>");i.$container.append(u)});i._validateForm(i.$form)},_initCallback:function(){var n=this;n.options.$reportViewer.on(t.reportViewerRenderError(),function(t,i){var r=i.Exception.Message.match(/["']([^"']*)["']/),u;r&&n._credentialData&&(u=r[0].replace(/["']/g,""),n.element.find("[name='"+u+"']").find(".fr-dsc-label").addClass("fr-dsc-label-error"),n.openDialog())})},_submitCredential:function(){var n=this,t=n.getCredentialList();t&&(n.options.$reportViewer.reportViewer("loadReportWithCustomDSCredential",t),n.closeDialog(),n.element.find(".fr-dsc-label-error").removeClass("fr-dsc-label-error"))},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},writeDialog:function(n){var t=this;t._initBody();t._credentialData=n||t._credentialData;t._credentialData&&t._createRows(t._credentialData)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},resetSavedCredential:function(n,t){var i=this,r;n&&(i._initBody(),i._createRows(n));t&&(r=JSON.parse(t),$.each(r.CredentialList,function(n,t){var r=i.element.find("[name='"+t.DataSourceID+"']");r.find(".fr-dsc-username-input").val(t.Username);r.find(".fr-dsc-password-input").val(t.Password)}))},_resetCredential:function(){var n=this;n.element.find(".fr-dsc-text-input").val("")},getCredentialList:function(){var t=this,n,i;return t.$form.valid()?(n=[],i=t.options.$appContainer.find(".fr-dsc-item-container"),$.each(i,function(t,i){var r=$(i).attr("name"),u=$(i).find(".fr-dsc-username-input").val(),f=$(i).find(".fr-dsc-password-input").val();n.push({DataSourceID:r,Username:u,Password:f})}),JSON.stringify({CredentialList:n})):null},_validateForm:function(n){n.validate({errorPlacement:function(n,t){n.appendTo($(t).parent().find(".fr-dsc-error-span"))},highlight:function(n){$(n).parent().find(".fr-dsc-error-span").addClass("fr-dsc-error-position");$(n).addClass("fr-dsc-error")},unhighlight:function(n){$(n).parent().find(".fr-dsc-error-span").removeClass("fr-dsc-error-position");$(n).removeClass("fr-dsc-error")}})},_resetValidateMessage:function(){var t=this,n=r.getLocData().validateError;jQuery.extend(jQuery.validator.messages,{required:n.required,number:n.number,digits:n.digits})},destroy:function(){var n=this;n._credentialData=null;this._destroy()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.tools=forerunner.ssr.tools||{};forerunner.ssr.tools.reportExplorerToolbar=forerunner.ssr.tools.reportExplorerToolbar||{};$(function(){var n=forerunner.ssr.constants.widgets,t=forerunner.ssr.constants.events,f=forerunner.ssr.tools.reportExplorerToolbar,e=forerunner.ssr.tools.reportExplorerToolpane,h=forerunner.helper,o=forerunner.ssr.constants,i=forerunner.ssr.constants.properties,r=forerunner.localize,c={catalog:f.btnHome.selectorClass,favorites:f.btnFav.selectorClass,recent:f.btnRecent.selectorClass},l={catalog:e.itemHome.selectorClass,favorites:e.itemFav.selectorClass,recent:e.itemRecent.selectorClass},s=[i.description,i.tags,i.rdlExtension],u={normal:s,report:s,searchFolder:[i.description,i.searchFolder,i.rdlExtension]};$.widget(n.getFullname(n.reportExplorerEZ),{options:{navigateTo:null,historyBack:null,isFullScreen:!0,showBreadCrumb:!0,explorerSettings:null,dbConfig:null,rsInstance:null},_createReportExplorer:function(n){var t=this;forerunner.ajax.getUserSetting(t.options.rsInstance,function(i){var r=t.DefaultAppTemplate,u=r._selectedItemPath;r.$mainsection.html(null);n?r.$mainsection.show():r.$mainsection.hide();r.$docmapsection.hide();t.$reportExplorer=r.$mainsection.reportExplorer({reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager",forerunnerPath:forerunner.config.forerunnerFolder(),selectedItemPath:u,navigateTo:t.options.navigateTo,$appContainer:r.$container,explorerSettings:t.options.explorerSettings,dbConfig:t.options.dbConfig,rsInstance:t.options.rsInstance,onInputFocus:r.onInputFocus(),onInputBlur:r.onInputBlur(),userSettings:i});t.DefaultAppTemplate.bindExplorerEvents()})},_initNavigateTo:function(){var i=this;i.options.navigateTo=function(){i._navigateTo.apply(i,arguments)};i.router=$({}).router({routes:{"":"transitionToReportManager","explore/:path":"transitionToReportManager","browse/:path":"transitionToReportViewer","view/?:args":"transitionToReportViewerWithRSURLAccess","open/:path":"transitionToOpenResource","openDashboard/:path":"transitionToOpenDashboard","search/:keyword":"transitionToSearch",favorites:"transitionToFavorites",recent:"transitionToRecent","editDashboard/:path":"transitionToEditDashboard","searchfolder/:path":"transitionToSearchFolder"},id:n.reportExplorerEZ});i.router.on(t.routerRoute(),function(){i._generateRouteLink.apply(i,arguments);i._onRoute.apply(i,arguments)});i.options.historyBack||(i.options.historyBack=function(){window.history.back()});forerunner.history.history("start")},_onRoute:function(n,t){var i=this,s,r,e,c,l,f,o;if(forerunner.ajax.getBuildVersion(function(n){if(i.buildVersion&&i.buildVersion!==n){window.location.reload(!0);return}i.buildVersion=n}),r=e=c=l=t.args[0],t.name==="transitionToReportManager")i.transitionToReportManager(r,null);else if(t.name==="transitionToReportViewer")f=r.split("?"),r=f[0],t.args[0]=r,o=f.length>1?forerunner.ssr._internal.getParametersFromUrl(f[1]):null,s=f.length>1?forerunner.ssr._internal.getOptionsFromURL(f[1]):null,o&&(o=JSON.stringify({ParamsList:o})),i.transitionToReportViewer(r,o,s);else if(t.name==="transitionToReportViewerWithRSURLAccess"){var h=e.indexOf("&"),a=h>0?e.substring(0,h):e,u=h>0?e.substring(h+1):null;s=u?forerunner.ssr._internal.getOptionsFromURL(u):null;u&&(u=u.length>0?forerunner.ssr._internal.getParametersFromUrl(u):null);u&&(u=JSON.stringify({ParamsList:u}));i.transitionToReportViewer(a,u,s)}else t.name==="transitionToOpenResource"?i.transitionToReportManager(r,"resource"):t.name==="transitionToSearch"?i.transitionToReportManager(c,"search"):t.name==="transitionToFavorites"?i.transitionToReportManager(null,"favorites"):t.name==="transitionToRecent"?i.transitionToReportManager(null,"recent"):t.name==="transitionToSearchFolder"?i.transitionToReportManager(r,"searchfolder"):t.name==="transitionToEditDashboard"?i.transitionToEditDashboard(r):t.name==="transitionToOpenDashboard"&&i.transitionToOpenDashboard(r)},_lastAction:null,_navigateTo:function(n,t){var i=this,r;t!==null&&(t=encodeURIComponent(t));n==="home"?i.router.router("navigate","#",{trigger:!0,replace:!1}):n==="back"?i.options.historyBack():n==="favorites"?i.router.router("navigate","#favorites",{trigger:!0,replace:!1}):n==="recent"?i.router.router("navigate","#recent",{trigger:!0,replace:!1}):(r="#"+n+"/"+t,i.router.router("navigate",r,{trigger:!0,replace:!1}));i._lastAction=n},_generateRouteLink:function(n,t){var r=this,i=r.DefaultAppTemplate.$linksection,u;i.html("");u=t.args[0]?t.args[0].split("?")[0]:null;r._getLink(u,i,0,t.name);i.attr("data-name",t.name).attr("data-path",u);i.show();r._linkResize(i)},_getLink:function(n,t,i,u){var h=this,c=n==="/"?null:forerunner.helper.getParentPath(n),l=forerunner.helper.getCurrentItemName(n)||r.getLocData().toolbar.home,f=new $("<span />"),e,s,o;if(f.addClass("fr-location-link"),i++,c===null){f.text(r.getLocData().toolbar.home);f.on("click",function(){h._navigateTo("home")});t.append(f);switch(u){case"transitionToSearch":o=r.getLocData().toolbar.search;break;case"transitionToFavorites":o=r.getLocData().toolbar.favorites;break;case"transitionToRecent":o=r.getLocData().toolbar.recent}o&&(e=new $("<span/>"),e.text(" > "),t.append(e),s=new $("<span />"),s.addClass("fr-location-link-last"),s.text(o),t.append(s));return}if(h._getLink(c,t,i,u),e=new $("<span/>"),e.text(" > "),f.text(l),i!==1)f.on("click",function(){h._navigateTo("explore",n)});else f.addClass("fr-location-link-last");t.append(e).append(f)},_linkResize:function(n,t){var u=this,e,o,i,f,s,r;if(n||(n=u.DefaultAppTemplate.$linksection),t===!0&&(e=n.attr("data-path"),o=n.attr("data-name"),n.html(""),u._getLink(e,n,0,o)),i=n.find(".fr-location-link-last"),i.length&&i.offset().left+i.width()>n.width()){if(r=n.find(".fr-location-link:not(.fr-link-ellipsis):last"),r.length===0)return;f=r.text();f.length>10&&(s=f.substring(0,10)+"..");r.addClass("fr-link-ellipsis").text(s);u._linkResize(n)}},transitionToReportManager:function(n,i){var r=this,o=n,f=r.DefaultAppTemplate,e;f.$mainsection.html()!==""&&f.$mainsection.html()!==null&&(f.$mainsection.html(""),f.$mainsection.hide());f.cleanUp();forerunner.dialog.closeAllModalDialogs(f.$container);e=forerunner.device.isWindowsPhone()?500:forerunner.device.isTouch()?50:0;setTimeout(function(){n||(n="/");forerunner.ajax.getUserSetting(r.options.rsInstance,function(){var e,a,h,s;r._createReportExplorer(!0);e=f.$mainheadersection;e.addClass("fr-explorer-tb").removeClass("fr-viewer-tb");e.reportExplorerToolbar({path:n,navigateTo:r.options.navigateTo,dbConfig:r.options.dbConfig,$appContainer:f.$container,$reportExplorer:r.$reportExplorer});r._setLeftRightPaneStyle();e.reportExplorerToolbar("setFolderBtnActive",c[i]);i==="search"&&e.reportExplorerToolbar("setSearchKeyword",n);r.$reportExplorer.one(t.reportExplorerBeforeFetch(),function(){e.reportExplorerToolbar("disableAllTools")});r.$reportExplorer.one(t.reportExplorerAfterFetch(),function(){e.reportExplorerToolbar("enableAllTools")});a=f.$leftheader;a!==null&&a.leftToolbar({$appContainer:f.$container});r.options.showBreadCrumb===!1&&r.DefaultAppTemplate.$linksection.hide();f._selectedItemPath=o;h=$(".fr-report-explorer",r.$reportExplorer);r.options.isFullScreen?$("body").css("background-color",h.css("background-color")):h.css("background-color",h.css("background-color"));i?i==="searchfolder"?r._setPropertiesTabs(i,n,u.searchFolder):i==="resource"&&r._setPropertiesTabs(i,n,u.normal):(i="catalog",r._setPropertiesTabs(i,n,u.normal));r._setSecurity(n);r.$reportExplorer.reportExplorer("load",i,n);s=f.$leftpanecontent;s.reportExplorerToolpane({path:n,navigateTo:r.options.navigateTo,dbConfig:r.options.dbConfig,$appContainer:f.$container,$reportExplorer:r.$reportExplorer});s.reportExplorerToolpane("setFolderItemActive",l[i]);i==="search"&&s.reportExplorerToolpane("setSearchKeyword",n);r.favoriteInstance=$({}).favoriteModel({$toolbar:e,$toolpane:s,$appContainer:f.$container,rsInstance:r.options.rsInstance});r.favoriteInstance.favoriteModel("setFavoriteState",n);r._trigger(t.afterTransition,null,{type:"ReportManager",path:n,view:i})})},e)},_setLeftRightPaneStyle:function(){var r=this,n=r.DefaultAppTemplate,u=n.$linksection.is(":visible")?n.$linksection.outerHeight():0,t=n.$mainheadersection.height(),i=forerunner.device.isIEMobile9()?0:u,f=u+t;n.$topdiv.css({height:f});n.$topdivspacer.css({height:f});n.$rightheader.css({height:t});n.$leftheader.css({height:t});n.$rightheaderspacer.css({height:t});n.$leftheaderspacer.css({height:t});r.options.isFullScreen&&(n.$rightheader.css({top:i}),n.$leftheader.css({top:i}),n.$rightheaderspacer.css({top:i}),n.$leftheaderspacer.css({top:i}),n.$leftpanecontent.css({top:t+i}),n.$rightpanecontent.css({top:t+i}))},transitionToReportViewer:function(n,i,r){var f=this,e=f.DefaultAppTemplate,s,h;e.$mainsection.html("");e.$mainsection.hide();forerunner.dialog.closeAllModalDialogs(e.$container);f._setPropertiesTabs("viewer",n,u.report);s=e.$mainheadersection;s.addClass("fr-viewer-tb").removeClass("fr-explorer-tb");e._selectedItemPath=null;h=forerunner.device.isWindowsPhone()?500:forerunner.device.isTouch()?50:0;setTimeout(function(){forerunner.ajax.getUserSetting(f.options.rsInstance,function(u){var h=o.toolbarConfigOption.full,s;r&&!r.showToolbar&&(h=o.toolbarConfigOption.hide);e.$mainviewport.reportViewerEZ({DefaultAppTemplate:e,path:n,navigateTo:f.options.navigateTo,historyBack:f.options.historyBack,isFullScreen:f.options.isFullScreen,isReportManager:r?r.isReportManager:!0,useReportManagerSettings:r?r.useReportManagerSettings:!0,rsInstance:f.options.rsInstance,savedParameters:i,userSettings:u,handleWindowResize:!1,showBreadCrumb:r?r.showBreadCrumb:f.options.showBreadCrumb,showParameterArea:r?r.showParameterArea:"Collapsed",showSubscriptionOnOpen:r?r.showSubscriptionOnOpen:!1,toolbarConfigOption:h,zoom:r?r.zoom:"100",dbConfig:f.options.dbConfig});f._setLeftRightPaneStyle();s=e.$mainviewport.reportViewerEZ("getReportViewer");s&&n!==null&&(n=String(n).replace(/%2f/g,"/"),e.$mainsection.fadeIn("fast"),s.reportViewer("loadReport",n,r?r.section:1,i));e.$mainviewport.reportViewerEZ("windowResize");f._trigger(t.afterTransition,null,{type:"ReportViewer",path:n,params:i,urlOptions:r})})},h);f.options.isFullScreen?$("body").css("background-color",""):f.$reportExplorer&&f.$reportExplorer.css("background-color","")},_transitionToDashboard:function(n,i){var r=this,f=r.DefaultAppTemplate,e;f.$mainsection.html("");forerunner.dialog.closeAllModalDialogs(r.DefaultAppTemplate.$container);r.DefaultAppTemplate._selectedItemPath=null;r._setPropertiesTabs("dashboard",n,u.normal);e=forerunner.device.isWindowsPhone()?500:forerunner.device.isTouch()?50:0;setTimeout(function(){forerunner.ajax.getUserSetting(r.options.rsInstance,function(u){var e=f.$mainviewport.dashboardEZ({DefaultAppTemplate:f,navigateTo:r.options.navigateTo,historyBack:r.options.historyBack,isReportManager:!0,enableEdit:i,path:n,rsInstance:r.options.rsInstance,userSettings:u,handleWindowResize:!1,dbConfig:r.options.dbConfig,$appContainer:f.$container}),o;r._setLeftRightPaneStyle();f.$mainsection.fadeIn("fast");o=e.dashboardEZ("getDashboardEditor");o.dashboardEditor("openDashboard",n,i);e.dashboardEZ("enableEdit",i,!0);r._trigger(t.afterTransition,null,{type:"Dashboard",path:n,enableEdit:i})})},e);r.options.isFullScreen?$("body").css("background-color",""):r.$reportExplorer.css("background-color","")},transitionToOpenDashboard:function(n){var t=this;t._transitionToDashboard(n,!1)},transitionToEditDashboard:function(n){var t=this;t._transitionToDashboard(n,!0)},_create:function(){var t=this;forerunner.ssr._internal.init();$(window).on("resize",function(){h.delay(t,function(){var i=t.DefaultAppTemplate,r;n.hasWidget(i.$mainviewport,n.dashboardEZ)&&i.$mainviewport.dashboardEZ("windowResize");n.hasWidget(i.$mainviewport,n.reportViewerEZ)&&i.$mainviewport.reportViewerEZ("windowResize");t._linkResize(undefined,!0);t.$reportExplorer&&t.$reportExplorer.find(".fr-report-explorer").length&&(t.DefaultAppTemplate.windowResize.call(t.DefaultAppTemplate),r=t.getReportExplorerToolbar(),n.hasWidget(r,n.reportExplorerToolbar)&&r.reportExplorerToolbar("windowResize"))})})},_init:function(){var n=this;forerunner.config.getCustomSettings(function(t){n.options.explorerSettings===null&&(n.options.explorerSettings=t);forerunner.config.getDBConfiguration(function(t){n.options.dbConfig===null&&(n.options.dbConfig=t);n.DefaultAppTemplate=new forerunner.ssr.DefaultAppTemplate({$container:n.element,isFullScreen:n.options.isFullScreen}).render();n.DefaultAppTemplate.$propertySection.forerunnerProperties("option","rsInstance",n.options.rsInstance);n.options.navigateTo||n._initNavigateTo()})})},_setPropertiesTabs:function(n,t,i){var r=this;r.DefaultAppTemplate.$propertySection.forerunnerProperties("setProperties",n,t,i)},_setSecurity:function(n){var t=this;t.DefaultAppTemplate.$securitySection.forerunnerSecurity("setData",n,"Catalog")},getReportViewerEZ:function(){var n=this;return n.DefaultAppTemplate.$mainviewport?n.DefaultAppTemplate.$mainviewport:null},getReportExplorer:function(){var n=this;return n.$reportExplorer?n.$reportExplorer:null},getReportExplorerToolbar:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$mainheadersection:null},getReportExplorerToolpane:function(){var n=this;return n.DefaultAppTemplate?n.DefaultAppTemplate.$leftpanecontent:null}})});forerunner=forerunner||{};forerunner.ajax=forerunner.ajax||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.constants=forerunner.ssr.constants||{};forerunner.ssr.constants.events=forerunner.ssr.constants.events||{};$(function(){var r=forerunner.ssr,t=r.constants.events,i=forerunner.ssr.constants.widgets,n=forerunner.localize;$.widget(i.getFullname(i.manageMySubscriptions),{options:{$appContainer:null,$reportExplorer:null,subscriptionModel:null},_subscriptionModel:null,_createDiv:function(n){return forerunner.helper.createDiv(n)},_showDeletionFailure:function(){console.log("Deletion failed")},_createListItem:function(t){var i=this,r=new $("<DIV />"),u,f;r.addClass("fr-sub-listitem");r.append(t.Path+" ("+t.Description+")");u=i._createDiv(["fr-sub-icon18x18"]);f=i._createDiv(["fr-sub-icon18x18"]);r.append(u);u.addClass("fr-sub-delete-icon");u.attr("title",n.getLocData().subscription.deleteSubscription);u.on("click",function(){i.options.subscriptionModel.subscriptionModel("deleteSubscription",t.SubscriptionID,function(){i._renderList()},function(){i._showDeletionFailure()})});f.addClass("fr-sub-edit-icon");f.attr("title",n.getLocData().subscription.edit);f.on("click",function(){i._editSubscription(t.Path,t.SubscriptionID)});return r.append(f),r},_editSubscription:function(n,t){var i=this;i.options.$reportExplorer.reportExplorer("showSubscription",n,t);i.closeDialog()},_renderList:function(){var t=this,i;t.$listcontainer.html("");i=new $("<UL />");i.addClass("fr-sub-list");$.when(t.options.subscriptionModel.subscriptionModel("getMySubscriptionList",t.options.reportPath)).done(function(n){var r;if(n.length===0){t.$emptyPrompt.show();return}for(r=0;r<n.length;r++){var f=n[r],u=new $("<LI />"),e=t._createListItem(f);u.append(e);i.append(u)}t.$listcontainer.append(i)}).fail(function(){forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().messages.loadSubscriptionListFailed)})},listSubscriptions:function(){var i=this,r;i.element.html("");i.element.off(t.modalDialogGenericSubmit);i.element.off(t.modalDialogGenericCancel);i.$container=i._createDiv(["fr-core-dialog-innerPage","fr-core-center"]);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-managesubscription",n.getLocData().subscription.manageSubscription,"fr-managesubscription-cancel",n.getLocData().subscription.cancel);i.$container.append(r);i.options.subscriptionModel.subscriptionModel("getSchedules");i.options.subscriptionModel.subscriptionModel("getDeliveryExtensions");i.element.append(i.$container);i.$emptyPrompt=i._createDiv(["fr-sub-empty-prompt"]);i.$emptyPrompt.text(n.getLocData().subscription.emptyPrompt);i.$container.append(i.$emptyPrompt);i.$listcontainer=i._createDiv(["fr-sub-list-container"]);i.$container.append(i.$listcontainer);i.$theForm=i._createDiv(["fr-sub-form"]);i.$container.append(i.$theForm);i._renderList();i.element.find(".fr-managesubscription-cancel").on("click",function(){i.closeDialog()});i.element.on(t.modalDialogGenericSubmit,function(){i._submit()});i.element.on(t.modalDialogGenericCancel,function(){i.closeDialog()})},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},destroy:function(){var n=this;n.element.html("");this._destroy()}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,n=forerunner.ssr.constants.events,r=forerunner.helper,t=forerunner.localize,u=forerunner.ssr;$.widget(i.getFullname(i.createDashboard),{options:{$reportExplorer:null,$appContainer:null,parentFolder:null,reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager/",rsInstance:null},_createOptions:function(){var n=this,r,t,i,u;n.$select=n.element.find(".fr-cdb-template-name");r=forerunner.localize._getLocData(forerunner.config.forerunnerFolder()+"Dashboard/dashboards/dashboards","json");t=r.templates;for(i in t)u=$("<option value="+i+">"+t[i]+"<\/option>"),n.$select.append(u)},_init:function(){var n=this;n.$dashboardName.val("");n.$overwrite.prop({checked:!1})},_create:function(){var i=this,r,u;i.createDashboard=t.getLocData().createDashboard;i.element.html("");i.element.off(n.modalDialogGenericSubmit);i.element.off(n.modalDialogGenericCancel);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-createdashboard",i.createDashboard.title,"fr-cdb-cancel",i.createDashboard.cancel);u=$("<div class='fr-core-dialog-innerPage fr-core-center'>"+r+"<form class='fr-cdb-form fr-core-dialog-form'><table><tr><td><label class='fr-cdb-label'>"+i.createDashboard.dashboardName+"<\/label><\/td><td><input class='fr-cdb-dashboard-name fr-cdb-input' autofocus='autofocus' type='text' required='true'/><span class='fr-cdb-error-span'/><\/td><\/tr><tr><td><label class='fr-cdb-label'>"+i.createDashboard.dashboardTemplate+"<\/label><\/td><td><select class='fr-cdb-template-name fr-cdb-input'><\/select><\/td><\/tr><tr><td><label class='fr-cdb-label'>"+i.createDashboard.overwrite+"<\/label><\/td><td><input class='fr-cdb-overwrite-id fr-cdb-overwrite-checkbox' type='checkbox'/><\/td><\/tr><\/table><div class='fr-core-dialog-submit-container'><div class='fr-core-center'><input autofocus='autofocus' type='button' class='fr-cdb-submit-id fr-core-dialog-submit fr-core-dialog-button' value='"+i.createDashboard.submit+"' /><\/div><\/div><\/form><\/div>");i.element.append(u);i._createOptions();i.$form=i.element.find(".fr-cdb-form");i._validateForm(i.$form);i.$form.on("submit",function(){return!1});i.$dashboardName=i.element.find(".fr-cdb-dashboard-name");i.$overwrite=i.element.find(".fr-cdb-overwrite-id");i.$dashboardName.watermark(i.createDashboard.namePlaceholder,forerunner.config.getWatermarkConfig());i.element.find(".fr-cdb-cancel").on("click",function(){i.closeDialog()});i.element.find(".fr-cdb-submit-id").on("click",function(){i._submit()});i.element.on(n.modalDialogGenericSubmit,function(){i._submit()});i.element.on(n.modalDialogGenericCancel,function(){i.closeDialog()})},_submit:function(){var n=this,f,e,o,i,s,h;if(n.$form.valid()){if(f=n.$select.val(),e=n.$dashboardName.val(),n.model=new u.DashboardModel({$appContainer:n.options.$appContainer,reportManagerAPI:n.options.reportManagerAPI,rsInstance:n.options.rsInstance}),n.model.loadTemplate(f),o=n.$overwrite.prop("checked"),i=n.model.save(o,n.options.parentFolder,e),i.status){s=n.options.$reportExplorer.reportExplorer("option","navigateTo");h=r.combinePaths(n.options.parentFolder,i.resourceName);s("editDashboard",h);n.closeDialog();return}i.Exception&&i.Exception.DetailMessage.toLowerCase().indexOf("invalid resource name")>=0?forerunner.dialog.showMessageBox(n.options.$appContainer,t.getLocData().messages.invalidName+i.Exception.DetailMessage.substring(21),n.createDashboard.title):forerunner.dialog.showMessageBox(n.options.$appContainer,t.getLocData().messages.createFailed,n.createDashboard.title)}},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},_validateForm:function(n){n.validate({errorPlacement:function(n,t){n.appendTo($(t).parent().find("span"))},highlight:function(n){$(n).parent().find("span").addClass("fr-cdb-error-position");$(n).addClass("fr-cdb-error")},unhighlight:function(n){$(n).parent().find("span").removeClass("fr-cdb-error-position");$(n).removeClass("fr-cdb-error")}})},_resetValidateMessage:function(){var i=this,n=t.getLocData().validateError;jQuery.extend(jQuery.validator.messages,{required:n.required,number:n.number,digits:n.digits})}})});forerunner=forerunner||{};forerunner.ajax=forerunner.ajax||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.constants=forerunner.ssr.constants||{};forerunner.ssr.constants.events=forerunner.ssr.constants.events||{};$(function(){var r=forerunner.ssr,t=r.constants.events,i=forerunner.ssr.constants.widgets,n=forerunner.localize;$.widget(i.getFullname(i.emailSubscription),{options:{reportPath:null,$appContainer:null,subscriptionModel:null,paramList:null},_extensionSettings:null,_createDropDownForValidValues:function(n){return forerunner.helper.createDropDownForValidValues(n)},_createRadioButtonsForValidValues:function(n,t){return forerunner.helper.createRadioButtonsForValidValues(n,t)},_createDiv:function(n){for(var i=new $("<div />"),t=0;t<n.length;t++)i.addClass(n[t]);return i},_createDropDownWithLabel:function(n,t){var f=this,r=forerunner.helper.guidGen(),u=new $("<LABEL />"),i;return u.attr("for",r),u.append(n),i=f._createDropDownForValidValues(t),i.attr("id",r),i},_subscriptionData:null,_canEditComment:!1,getSubscriptionInfo:function(n){var t=this;return t.options.subscriptionModel.subscriptionModel("getSubscription",n)},_setSubscriptionOrSetDefaults:function(){var t=this,i=t._subscriptionID,r=$.Deferred(),u=$.Deferred();$.when(t._initExtensionOptions()).done(function(n){r.resolve(n)}).fail(function(){r.resolve()});$.when(t._initProcessingOptions()).done(function(n){u.resolve(n)}).fail(function(){u.resolve()});$.when(r,u).done(function(r,u){var o,e,f;if(r!==undefined)if(t._extensionSettings=r,t._initRenderFormat(r),t.$includeReport.prop("checked",!0),t.$includeLink.prop("checked",!0),i)for(o=t.options.subscriptionModel.subscriptionModel("getSubscription",i),t.$desc.val(o.Description),t._subscriptionData=o,e=o.ExtensionSettings,f=0;f<e.ParameterValues.length;f++)e.ParameterValues[f].Name==="TO"&&t.$to.val(e.ParameterValues[f].Value),e.ParameterValues[f].Name==="CC"&&t.$cc.val(e.ParameterValues[f].Value),e.ParameterValues[f].Name==="BCC"&&t.$bcc.val(e.ParameterValues[f].Value),e.ParameterValues[f].Name==="ReplyTo"&&t.$replyTo.val(e.ParameterValues[f].Value),e.ParameterValues[f].Name==="Subject"&&t.$subject.val(e.ParameterValues[f].Value),e.ParameterValues[f].Name==="Comment"&&t.$comment.val(e.ParameterValues[f].Value),e.ParameterValues[f].Name==="IncludeReport"&&(e.ParameterValues[f].Value==="True"?t.$includeReport.prop("checked",!0):t.$includeReport.prop("checked",!1)),e.ParameterValues[f].Name==="IncludeLink"&&(e.ParameterValues[f].Value==="True"?t.$includeLink.prop("checked",!0):t.$includeLink.prop("checked",!1)),e.ParameterValues[f].Name==="RenderFormat"&&t.$renderFormat.val(e.ParameterValues[f].Value);else forerunner.ajax.getUserName(t.options.subscriptionModel.subscriptionModel("option","rsInstance"),function(i){t.$to.val(i);t.$desc.val(n.getLocData().subscription.description.format(i));t.$subject.val(n.getLocData().subscription.subject)});u!==undefined&&t._initSharedSchedule(u,function(){i&&(o=t.options.subscriptionModel.subscriptionModel("getSubscription",i),t.$sharedSchedule.val(o.SubscriptionSchedule.ScheduleID))})})},_getSubscriptionInfo:function(){var n=this,t,u,i,r;if(n._subscriptionData)for(n._subscriptionData.Report=n.options.reportPath,n._subscriptionData.Description=n.$desc.val(),n._subscriptionData.SubscriptionSchedule={},n._subscriptionData.SubscriptionSchedule.ScheduleID=n.$sharedSchedule.val(),n._subscriptionData.SubscriptionSchedule.MatchData=n._sharedSchedule[n.$sharedSchedule.val()].MatchData,n._sharedSchedule[n.$sharedSchedule.val()].IsMobilizerSchedule&&(n._subscriptionData.SubscriptionSchedule.IsMobilizerSchedule=!0),t=0;t<n._subscriptionData.ExtensionSettings.ParameterValues.length;t++)n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="TO"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$to.val()),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="CC"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$cc.val()),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="BCC"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$bcc.val()),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="ReplyTo"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$replyTo.val()),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="Subject"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$subject.val()),n._canEditComment&&n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="Comment"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$comment.val()),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="IncludeLink"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$includeLink.is(":checked")?"True":"False"),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="IncludeReport"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$includeReport.is(":checked")?"True":"False"),n._subscriptionData.ExtensionSettings.ParameterValues[t].Name==="RenderFormat"&&(n._subscriptionData.ExtensionSettings.ParameterValues[t].Value=n.$renderFormat.val());else n._subscriptionData={},n._subscriptionData.SubscriptionID=null,n._subscriptionData.Report=n.options.reportPath,n._subscriptionData.SubscriptionSchedule={},n._subscriptionData.SubscriptionSchedule.ScheduleID=n.$sharedSchedule.val(),n._subscriptionData.SubscriptionSchedule.MatchData=n._sharedSchedule[n.$sharedSchedule.val()].MatchData,n._sharedSchedule[n.$sharedSchedule.val()].IsMobilizerSchedule&&(n._subscriptionData.SubscriptionSchedule.IsMobilizerSchedule=!0),n._subscriptionData.Description=n.$desc.val(),n._subscriptionData.EventType="TimedSubscription",n._subscriptionData.ExtensionSettings={},n._subscriptionData.ExtensionSettings.Extension="Report Server Email",n._subscriptionData.ExtensionSettings.ParameterValues=[],n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"TO",Value:n.$to.val()}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"CC",Value:n.$cc.val()}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"BCC",Value:n.$bcc.val()}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"ReplyTo",Value:n.$replyTo.val()}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"Subject",Value:n.$subject.val()}),n.$comment.val()&&n.$comment.val()!==""&&n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"Comment",Value:n.$comment.val()}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"IncludeLink",Value:n.$includeLink.is(":checked")?"True":"False"}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"IncludeReport",Value:n.$includeReport.is(":checked")?"True":"False"}),n._subscriptionData.ExtensionSettings.ParameterValues.push({Name:"RenderFormat",Value:n.$renderFormat.val()});if(n.options.paramList&&!n._subscriptionData.Parameters)for(n._subscriptionData.Parameters=[],u=JSON.parse(n.options.paramList),t=0;t<u.ParamsList.length;t++)if(i=u.ParamsList[t],!i.UseDefault||i.UseDefault.toLowerCase()!=="true")if(i.IsMultiple==="true")for(r=0;r<i.Value.length;r++)n._subscriptionData.Parameters.push({Name:i.Parameter,Value:i.Value[r]});else n._subscriptionData.Parameters.push({Name:i.Parameter,Value:i.Value});return n._subscriptionData},getParamsList:function(){var t=this,i={ParamsList:[]},n;if(t._subscriptionData)for(n=0;n<t._subscriptionData.Parameters.length;n++)i.ParamsList.push({Parameter:t._subscriptionData.Parameters[n].Name,Value:t._subscriptionData.Parameters[n].Value});return i.ParamsList.length>0?JSON.stringify(i):null},_initRenderFormat:function(t){for(var u,f,i=this,r=0;r<t.length;r++)u=t[r],u.Name==="RenderFormat"&&(i.$renderFormat=i._createDropDownForValidValues(u.ValidValues));f=forerunner.config.getCustomSettingsValue("DefaultSubscriptionFormat","MHTML");i.$renderFormat.val(f);i.$renderFormat.addClass(".fr-email-renderformat");i.$theTable.append(i._createTableRow(n.getLocData().subscription.format,i.$renderFormat))},_initExtensionOptions:function(){var n=this;return n.options.subscriptionModel.subscriptionModel("getExtensionSettings","Report Server Email")},_sharedSchedule:{},_initSharedSchedule:function(t,i){for(var u=this,f=[],r=0;r<t.length;r++)f.push({Value:t[r].ScheduleID,Label:t[r].Name}),u._sharedSchedule[t[r].ScheduleID]=t[r];forerunner.config.getMobilizerSharedSchedule(function(e){if(t=e,t)for(r=0;r<t.length;r++)f.push({Value:t[r].ScheduleID,Label:t[r].Name}),u._sharedSchedule[t[r].ScheduleID]=t[r];u.$sharedSchedule=u._createDropDownForValidValues(f);u.$theTable.append(u._createTableRow(n.getLocData().subscription.schedule,u.$sharedSchedule));u.$sharedSchedule.addClass("fr-email-schedule");i()})},_initProcessingOptions:function(){var n=this;return n.options.subscriptionModel.subscriptionModel("getSchedules")},_initSections:function(){var n=this;n._setSubscriptionOrSetDefaults()},_createInputWithPlaceHolder:function(n,t,i,r){var e=this,u=new $("<INPUT />"),f;for(u.attr("type",t),i&&u.attr("name",i),r&&u.watermark(r,forerunner.config.getWatermarkConfig()),f=0;f<n.length;f++)u.addClass(n[f]);return u},_createTextAreaWithPlaceHolder:function(n,t){var u=this,r=new $("<TEXTAREA />"),i;for(t&&r.watermark(t,forerunner.config.getWatermarkConfig()),i=0;i<n.length;i++)r.addClass(n[i]);return r},_createTableRow:function(n,t){var f=this,r=new $("<TR/>"),u=new $("<TD/>"),i;return u.addClass("fr-sub-left-col"),i=new $("<TD/>"),i.addClass("fr-sub-right-col"),r.append(u),r.append(i),n&&u.append(n),t&&i.append(t),r},_createCheckBox:function(n,t){var f=this,i=new $("<INPUT />"),u=forerunner.helper.guidGen(),r;return i.attr("type","checkbox"),i.attr("id",u),n&&t&&(r=new $("<LABEL />"),r.attr("for",u),r.append(t),n.append(i),n.append(r)),i},_init:function(){},_subscriptionID:null,getSubscriptionList:function(){var n=this;return n.options.subscriptionModel.subscriptionModel("getSubscriptionList",n.options.reportPath)},loadSubscription:function(i){var r=this,u;r.element.off(t.modalDialogGenericSubmit);r.element.off(t.modalDialogGenericCancel);r._subscriptionID=i;r._subscriptionData=null;r.element.html("");r.element.off(t.modalDialogGenericSubmit);r.element.off(t.modalDialogGenericCancel);r.$outerContainer=r._createDiv(["fr-core-dialog-innerPage","fr-core-center"]);u=i?forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-emailsubscription",n.getLocData().subscription.email,"fr-email-cancel",n.getLocData().subscription.cancel,"fr-core-dialog-button fr-email-create-id",n.getLocData().subscription.addNew):forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-emailsubscription",n.getLocData().subscription.email,"fr-email-cancel",n.getLocData().subscription.cancel);r.$theForm=new $("<FORM />");r.$theForm.addClass("fr-email-form");r.$theForm.addClass("fr-core-dialog-form");r.$outerContainer.append(u);r.$outerContainer.append(r.$theForm);r.$theTable=new $("<TABLE />");r.$theTable.addClass("fr-email-table");r.$theForm.append(r.$theTable);r.$desc=r._createInputWithPlaceHolder(["fr-email-description"],"text","desc","");r.$desc.attr("maxlength",forerunner.config.getCustomSettingsValue("SubscriptionInputSize","100"));r.$desc.prop("required",!0);r.$theTable.append(r._createTableRow(n.getLocData().subscription.descriptionPlaceholder,r.$desc));r.$to=r._createInputWithPlaceHolder(["fr-email-to"],"text","to","");r.$to.attr("maxlength",forerunner.config.getCustomSettingsValue("SubscriptionInputSize","100"));r.$to.prop("required",!0);r.$theTable.append(r._createTableRow(n.getLocData().subscription.toPlaceholder,r.$to));r.$cc=r._createInputWithPlaceHolder(["fr-email-cc"],"text","cc","");r.$cc.attr("maxlength",forerunner.config.getCustomSettingsValue("SubscriptionInputSize","100"));r.$theTable.append(r._createTableRow(n.getLocData().subscription.ccPlaceholder,r.$cc));r.$bcc=r._createInputWithPlaceHolder(["fr-email-bcc"],"text","bcc","");r.$bcc.attr("maxlength",forerunner.config.getCustomSettingsValue("SubscriptionInputSize","100"));r.$theTable.append(r._createTableRow(n.getLocData().subscription.bccPlaceholder,r.$bcc));r.$replyTo=r._createInputWithPlaceHolder(["fr-email-replyTo"],"text","replyTo","");r.$replyTo.attr("maxlength",forerunner.config.getCustomSettingsValue("SubscriptionInputSize","100"));r.$theTable.append(r._createTableRow(n.getLocData().subscription.replyToPlaceholder,r.$replyTo));r.$subject=r._createInputWithPlaceHolder(["fr-email-subject"],"text","subject","");r.$subject.attr("maxlength",forerunner.config.getCustomSettingsValue("SubscriptionInputSize","100"));r.$subject.prop("required",!0);r.$theTable.append(r._createTableRow(n.getLocData().subscription.subjectPlaceholder,r.$subject));r.$includeLink=r._createCheckBox();r.$includeLink.addClass("fr-email-include");r.$includeReport=r._createCheckBox();r.$includeReport.addClass("fr-email-include");r.$theTable.append(r._createTableRow(n.getLocData().subscription.includeLink,r.$includeLink));r.$theTable.append(r._createTableRow(n.getLocData().subscription.includeReport,r.$includeReport));r.$comment=r._createTextAreaWithPlaceHolder(["fr-email-comment"],"Comment",n.getLocData().subscription.commentPlaceholder);r.$theTable.append(r._createTableRow(n.getLocData().subscription.commentPlaceholder,r.$comment));r.options.userSettings&&r.options.userSettings.adminUI||(r.$to.prop("disabled",!0),r.$subject.parent().parent().hide(),r.$desc.parent().parent().hide(),r.$comment.parent().parent().hide(),r.$bcc.parent().parent().hide(),r.$cc.parent().parent().hide(),r.$replyTo.parent().parent().hide());forerunner.ajax.hasPermission(r.options.reportPath,"Create Any Subscription",r.options.subscriptionModel.subscriptionModel("option","rsInstance"),function(n){n&&r.$comment.parent().parent().hide()});r.$lastRow=r._createTableRow();r.$colOfLastRow=r.$lastRow.children(":first");r.$theTable.append(r.$lastRow);r.$submitContainer=r._createDiv(["fr-email-submit-container"]);r.$submitButton=r._createInputWithPlaceHolder(["fr-email-submit-id","fr-core-dialog-submit","fr-core-dialog-button"],"submit");r.$submitButton.val(n.getLocData().subscription.save);r.$submitContainer.append(r.$submitButton);i&&(r.$deleteButton=r._createInputWithPlaceHolder(["fr-email-delete-id","fr-core-dialog-delete"],"button"),r.$deleteButton.val(n.getLocData().subscription.deleteSubscription),r.$submitContainer.append(r.$deleteButton));r.$theForm.append(r.$submitContainer);r._initSections();r.element.append(r.$outerContainer);r.$theForm.on("submit",function(){return!1});r.$theForm.validate({errorPlacement:function(n,t){n.appendTo(t.siblings("span"))},highlight:function(n){$(n).addClass("fr-error")},unhighlight:function(n){$(n).removeClass("fr-error")}});r.element.find(".fr-email-submit-id").on("click",function(){r._submit()});r.element.find(".fr-email-create-id").on("click",function(){r._createNew()});r.element.find(".fr-email-delete-id").on("click",function(){r._deleteMe()});r.element.find(".fr-email-cancel").on("click",function(){r.closeDialog()});r.element.on(t.modalDialogGenericSubmit,function(){r._submit()});r.element.on(t.modalDialogGenericCancel,function(){r.closeDialog()});r.options.$appContainer.trigger(t.subscriptionFormInit)},_submit:function(){var t=this,i;t.$theForm.valid()&&t.$to.val()!==""&&t.$desc.val()!==""&&t.$subject.val()!==""&&t.$to.attr("data-invalid")!=="true"&&(i=t._getSubscriptionInfo(),t.options.subscriptionModel.subscriptionModel(t._subscriptionID?"updateSubscription":"createSubscription",i,function(){t.closeDialog()},function(i){forerunner.dialog.showMessageBox(t.options.$appContainer,i.Exception.Message?i.Exception.Message:n.getLocData().subscription.saveFailed)}))},_createNew:function(){var n=this;n.loadSubscription(null)},_deleteMe:function(){var t=this;t.options.subscriptionModel.subscriptionModel("deleteSubscription",t._subscriptionID,function(){t.closeDialog()},function(){forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().subscription.deleteFailed)})},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},destroy:function(){var n=this;n.element.off(t.modalDialogGenericSubmit);n.element.off(t.modalDialogGenericCancel);n.element.html("");this._destroy()}})});forerunner=forerunner||{};forerunner.ajax=forerunner.ajax||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.constants=forerunner.ssr.constants||{};forerunner.ssr.constants.events=forerunner.ssr.constants.events||{};$(function(){var r=forerunner.ssr,t=r.constants.events,i=forerunner.ssr.constants.widgets,n=forerunner.localize;$.widget(i.getFullname(i.manageSubscription),{options:{reportPath:null,$appContainer:null,$reportViewer:null,subscriptionModel:null},_subscriptionModel:null,_createDiv:function(n){return forerunner.helper.createDiv(n)},_showDeletionFailure:function(){console.log("Deletion failed")},_createListItem:function(t){var i=this,r=new $("<DIV />"),u,f;r.addClass("fr-sub-listitem");r.append(i._createDiv(["fr-sub-descr"]).text(t.Description));u=i._createDiv(["fr-sub-icon18x18"]);f=i._createDiv(["fr-sub-icon18x18"]);r.append(u);u.addClass("fr-sub-delete-icon");u.attr("title",n.getLocData().subscription.deleteSubscription);u.on("click",function(){i.options.subscriptionModel.subscriptionModel("deleteSubscription",t.SubscriptionID,function(){i._renderList()},function(){i._showDeletionFailure()})});f.addClass("fr-sub-edit-icon");f.attr("title",n.getLocData().subscription.edit);f.on("click",function(){i._editSubscription(t.SubscriptionID)});return r.append(f),r},_editSubscription:function(n){var t=this;t.options.$reportViewer.reportViewer("editEmailSubscription",n);t.closeDialog()},_createNew:function(){var n=this;n._editSubscription(null)},_renderList:function(){var t=this,i;t.$listcontainer.html("");i=new $("<UL />");i.addClass("fr-sub-list");$.when(t.options.subscriptionModel.subscriptionModel("getSubscriptionList",t.options.reportPath)).done(function(n){for(var r=0;r<n.length;r++){var f=n[r],u=new $("<LI />"),e=t._createListItem(f);u.append(e);i.append(u)}t.$listcontainer.append(i)}).fail(function(){forerunner.dialog.showMessageBox(t.options.$appContainer,n.getLocData().messages.loadSubscriptionListFailed)})},listSubscriptions:function(){var i=this,r;i.element.html("");i.element.off(t.modalDialogGenericSubmit);i.element.off(t.modalDialogGenericCancel);i.$container=i._createDiv(["fr-core-dialog-innerPage","fr-core-center"]);r=forerunner.dialog.getModalDialogHeaderHtml("fr-icons24x24-managesubscription",n.getLocData().subscription.manageSubscription,"fr-managesubscription-cancel",n.getLocData().subscription.cancel,"fr-core-dialog-button fr-email-create-id",n.getLocData().subscription.addNew);i.$container.append(r);i.options.subscriptionModel.subscriptionModel("getSchedules");i.options.subscriptionModel.subscriptionModel("getDeliveryExtensions");i.element.append(i.$container);i.$listcontainer=i._createDiv(["fr-sub-list-container"]);i.$container.append(i.$listcontainer);i.$theForm=i._createDiv(["fr-sub-form"]);i.$container.append(i.$theForm);i._renderList();i.element.find(".fr-managesubscription-cancel").on("click",function(){i.closeDialog()});i.element.find(".fr-email-create-id").on("click",function(){i._createNew()});i.element.on(t.modalDialogGenericSubmit,function(){i._submit()});i.element.on(t.modalDialogGenericCancel,function(){i.closeDialog()})},openDialog:function(){var n=this;forerunner.dialog.showModalDialog(n.options.$appContainer,n)},closeDialog:function(){var n=this;forerunner.dialog.closeModalDialog(n.options.$appContainer,n)},destroy:function(){var n=this;n.element.html("");this._destroy()}})});forerunner=forerunner||{};forerunner.ajax=forerunner.ajax||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.constants=forerunner.ssr.constants||{};forerunner.ssr.constants.events=forerunner.ssr.constants.events||{};$(function(){var t=forerunner.ssr,i=t.constants.events,n=forerunner.ssr.constants.widgets,r=forerunner.localize;$.widget(n.getFullname(n.subscriptionModel),{options:{rsInstance:null},subscriptionList:null,extensionList:null,extensionParameter:null,extensionSettings:{},schedules:null,_create:function(){},getMySubscriptionList:function(){var n=this,t=forerunner.config.forerunnerAPIBase()+"ReportManager/ListMySubscriptions";return forerunner.ajax.ajax({url:t,data:{instance:n.options.rsInstance},dataType:"json",async:!0}).done(function(){console.log("ListMySubscriptions succeeded.")}).fail(function(){console.log("ListMySubscriptions call failed.")})},getSubscriptionList:function(n){var t=this,i=forerunner.config.forerunnerAPIBase()+"ReportManager/ListSubscriptions";return forerunner.ajax.ajax({url:i,data:{reportPath:n,instance:t.options.rsInstance},dataType:"json",async:!0}).done(function(){console.log("ListSubscriptions succeeded.")}).fail(function(){console.log("ListSubscriptions call failed.")})},getSchedules:function(){var n=this,t,i;return n.schedules?n.schedules:(t=forerunner.config.forerunnerAPIBase()+"ReportManager/ListSchedules",i=forerunner.ajax.ajax({url:t,data:{instance:n.options.rsInstance},dataType:"json",async:!0}).done(function(t){n.schedules=t}).fail(function(){console.log("ListSchedules call failed.")}),n.schedules?n.schedules:i)},getDeliveryExtensions:function(){var n=this,t=forerunner.config.forerunnerAPIBase()+"ReportManager/ListDeliveryExtensions";return forerunner.ajax.ajax({url:t,data:{instance:n.options.rsInstance},dataType:"json",async:!0}).done(function(t){n.extensionList=t}).fail(function(){console.log("ListDeliveryExtensions call failed.")})},_extensionSettingsCount:0,_extensionSettingsJQXHR:{},getExtensionSettings:function(n){var t,i,r;if(n!=="NULL")return(t=this,t.extensionSettings[n])?t.extensionSettings[n]:(i=forerunner.config.forerunnerAPIBase()+"ReportManager/GetExtensionSettings",r=forerunner.ajax.ajax({url:i,data:{extension:n,instance:t.options.rsInstance},dataType:"json",async:!0}).done(function(i){t.extensionSettings[n]=i}).fail(function(){console.log("GetExtensionSettings call failed.")}).always(function(){t._extensionSettingsCount++}),t.extensionSettings[n]?t.extensionSettings[n]:r)},getSubscription:function(n){var i=this,r=forerunner.config.forerunnerAPIBase()+"ReportManager/GetSubscription",t;return forerunner.ajax.ajax({url:r,data:{subscriptionID:n,instance:i.options.rsInstance},dataType:"json",async:!1,success:function(n){t=n},error:function(n){console.log("getSubscription failed: "+n.status)}}),t},createSubscription:function(n,t,i){return this._saveSubscription("CreateSubscription",n,t,i)},updateSubscription:function(n,t,i){return this._saveSubscription("UpdateSubscription",n,t,i)},deleteSubscription:function(n,t,i){var r=this,u=forerunner.config.forerunnerAPIBase()+"ReportManager/DeleteSubscription";forerunner.ajax.ajax({url:u,data:{subscriptionID:n,instance:r.options.rsInstance},dataType:"json",async:!0,success:function(n){t&&typeof t=="function"&&t(n)},error:function(){i&&typeof i=="function"&&i()}})},_saveSubscription:function(n,t,i,r){var u=this,f=forerunner.config.forerunnerAPIBase()+"ReportManager/"+n;t.Instance=u.options.rsInstance;forerunner.ajax.post(f,t,function(n){var t=!0,u;try{u=JSON.parse(n);u.Exception&&(n=u)}catch(f){t=!1}!t&&i&&typeof i=="function"&&i(n);t&&r&&typeof r=="function"&&r(n)},function(n){r&&typeof r=="function"&&r(n)})}})});$(function(){"use strict";var c,s,r;if(!$.jstree){var a=0,i=!1,n=!1,u=!1,l=[],h=$("script:last").attr("src"),f=document,e=f.createElement("LI"),t,o;e.setAttribute("role","treeitem");t=f.createElement("I");t.className="jstree-icon jstree-ocl";e.appendChild(t);t=f.createElement("A");t.className="jstree-anchor";t.setAttribute("href","#");o=f.createElement("I");o.className="jstree-icon jstree-themeicon";t.appendChild(o);e.appendChild(t);t=o=null;$.jstree={version:"3.0.0",defaults:{plugins:[]},plugins:{},path:h&&h.indexOf("/")!==-1?h.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&'".,=\- \/]/g};$.jstree.create=function(n,t){var i=new $.jstree.core(++a),r=t;return t=$.extend(!0,{},$.jstree.defaults,t),r&&r.plugins&&(t.plugins=r.plugins),$.each(t.plugins,function(n,r){n!=="core"&&(i=i.plugin(r,t[r]))}),i.init(n,t),i};$.jstree.core=function(n){this._id=n;this._cnt=0;this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{}}}};$.jstree.reference=function(n){var i=null,t=null;if(n&&n.id&&(n=n.id),!t||!t.length)try{t=$(n)}catch(r){}if(!t||!t.length)try{t=$("#"+n.replace($.jstree.idregex,"\\$&"))}catch(r){}return t&&t.length&&(t=t.closest(".jstree")).length&&(t=t.data("jstree"))?i=t:$(".jstree").each(function(){var t=$(this).data("jstree");if(t&&t._model.data[n])return i=t,!1}),i};$.fn.jstree=function(n){var i=typeof n=="string",r=Array.prototype.slice.call(arguments,1),t=null;return this.each(function(){var u=$.jstree.reference(this),f=i&&u?u[n]:null;return t=i&&f?f.apply(u,r):null,u||i||n!==undefined&&!$.isPlainObject(n)||$(this).data("jstree",new $.jstree.create(this,n)),(u&&!i||n===!0)&&(t=u||!1),t!==null&&t!==undefined?!1:void 0}),t!==null&&t!==undefined?t:this};$.expr[":"].jstree=$.expr.createPseudo(function(){return function(n){return $(n).hasClass("jstree")&&$(n).data("jstree")!==undefined}});$.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:$.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!0},expand_selected_onload:!0};$.jstree.core.prototype={plugin:function(n,t){var i=$.jstree.plugins[n];return i?(this._data[n]={},i.prototype=this,new i(t,this)):this},init:function(n,t){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}};this.element=$(n).addClass("jstree jstree-"+this._id);this.settings=t;this.element.bind("destroyed",$.proxy(this.teardown,this));this._data.core.ready=!1;this._data.core.loaded=!1;this._data.core.rtl=this.element.css("direction")==="rtl";this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'><\/i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'><\/i>"+this.get_string("Loading ...")+"<\/a><\/li><\/ul>");this._data.core.li_height=this.get_container_ul().children("li:eq(0)").height()||18;this.trigger("loading");this.load_node("#")},destroy:function(){this.element.unbind("destroyed",this.teardown);this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function(){this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var n=window.getSelection();try{n.removeAllRanges();n.collapse()}catch(t){}}}).on("click.jstree",".jstree-ocl",$.proxy(function(n){this.toggle_node(n.target)},this)).on("click.jstree",".jstree-anchor",$.proxy(function(n){n.preventDefault();$(n.currentTarget).focus();this.activate_node(n.currentTarget,n)},this)).on("keydown.jstree",".jstree-anchor",$.proxy(function(n){if(n.target.tagName==="INPUT")return!0;var t=null;switch(n.which){case 13:case 32:n.type="click";$(n.currentTarget).trigger(n);break;case 37:n.preventDefault();this.is_open(n.currentTarget)?this.close_node(n.currentTarget):(t=this.get_prev_dom(n.currentTarget),t&&t.length&&t.children(".jstree-anchor").focus());break;case 38:n.preventDefault();t=this.get_prev_dom(n.currentTarget);t&&t.length&&t.children(".jstree-anchor").focus();break;case 39:n.preventDefault();this.is_closed(n.currentTarget)?this.open_node(n.currentTarget,function(n){this.get_node(n,!0).children(".jstree-anchor").focus()}):(t=this.get_next_dom(n.currentTarget),t&&t.length&&t.children(".jstree-anchor").focus());break;case 40:n.preventDefault();t=this.get_next_dom(n.currentTarget);t&&t.length&&t.children(".jstree-anchor").focus();break;case 46:n.preventDefault();t=this.get_node(n.currentTarget);t&&t.id&&t.id!=="#"&&(t=this.is_selected(t)?this.get_selected():t);break;case 113:n.preventDefault();t=this.get_node(n.currentTarget)}},this)).on("load_node.jstree",$.proxy(function(n,t){if(t.status&&(t.node.id!=="#"||this._data.core.loaded||(this._data.core.loaded=!0,this.trigger("loaded")),!this._data.core.ready&&!this.get_container_ul().find(".jstree-loading:eq(0)").length)){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var r=[],i=0,u=this._data.core.selected.length;i<u;i++)r=r.concat(this._model.data[this._data.core.selected[i]].parents);for(r=$.vakata.array_unique(r),i=0,u=r.length;i<u;i++)this.open_node(r[i],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}setTimeout($.proxy(function(){this.trigger("ready")},this),0)}},this)).on("init.jstree",$.proxy(function(){var n=this.settings.core.themes;this._data.core.themes.dots=n.dots;this._data.core.themes.stripes=n.stripes;this._data.core.themes.icons=n.icons;this.set_theme(n.name||"default",n.url);this.set_theme_variant(n.variant)},this)).on("loading.jstree",$.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("focus.jstree",".jstree-anchor",$.proxy(function(n){this.element.find(".jstree-hovered").not(n.currentTarget).mouseleave();$(n.currentTarget).mouseenter()},this)).on("mouseenter.jstree",".jstree-anchor",$.proxy(function(n){this.hover_node(n.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",$.proxy(function(n){this.dehover_node(n.currentTarget)},this))},unbind:function(){this.element.off(".jstree");$(document).off(".jstree-"+this._id)},trigger:function(n,t){t||(t={});t.instance=this;this.element.triggerHandler(n.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children("ul:eq(0)")},get_string:function(n){var t=this.settings.core.strings;return $.isFunction(t)?t.call(this,n):t&&t[n]?t[n]:n},_firstChild:function(n){for(n=n?n.firstChild:null;n!==null&&n.nodeType!==1;)n=n.nextSibling;return n},_nextSibling:function(n){for(n=n?n.nextSibling:null;n!==null&&n.nodeType!==1;)n=n.nextSibling;return n},_previousSibling:function(n){for(n=n?n.previousSibling:null;n!==null&&n.nodeType!==1;)n=n.previousSibling;return n},get_node:function(n,t){n&&n.id&&(n=n.id);var i;try{if(this._model.data[n])n=this._model.data[n];else if(((i=$(n,this.element)).length||(i=$("#"+n.replace($.jstree.idregex,"\\$&"),this.element)).length)&&this._model.data[i.closest("li").attr("id")])n=this._model.data[i.closest("li").attr("id")];else if((i=$(n,this.element)).length&&i.hasClass("jstree"))n=this._model.data["#"];else return!1;return t&&(n=n.id==="#"?this.element:$("#"+n.id.replace($.jstree.idregex,"\\$&"),this.element)),n}catch(r){return!1}},get_path:function(n,t,i){if(n=n.parents?n:this.get_node(n),!n||n.id==="#"||!n.parents)return!1;var u,f,r=[];for(r.push(i?n.id:n.text),u=0,f=n.parents.length;u<f;u++)r.push(i?n.parents[u]:this.get_text(n.parents[u]));return r=r.reverse().slice(1),t?r.join(t):r},get_next_dom:function(n,t){var i;return(n=this.get_node(n,!0),n[0]===this.element[0])?(i=this._firstChild(this.get_container_ul()[0]),i?$(i):!1):!n||!n.length?!1:t?(i=this._nextSibling(n[0]),i?$(i):!1):n.hasClass("jstree-open")?(i=this._firstChild(n.children("ul")[0]),i?$(i):!1):(i=this._nextSibling(n[0]))!==null?$(i):n.parentsUntil(".jstree","li").next("li").eq(0)},get_prev_dom:function(n,t){var i;if(n=this.get_node(n,!0),n[0]===this.element[0])return i=this.get_container_ul()[0].lastChild,i?$(i):!1;if(!n||!n.length)return!1;if(t)return i=this._previousSibling(n[0]),i?$(i):!1;if((i=this._previousSibling(n[0]))!==null){for(n=$(i);n.hasClass("jstree-open");)n=n.children("ul:eq(0)").children("li:last");return n}return i=n[0].parentNode.parentNode,i&&i.tagName==="LI"?$(i):!1},get_parent:function(n){return(n=this.get_node(n),!n||n.id==="#")?!1:n.parent},get_children_dom:function(n){return(n=this.get_node(n,!0),n[0]===this.element[0])?this.get_container_ul().children("li"):!n||!n.length?!1:n.children("ul").children("li")},is_parent:function(n){return n=this.get_node(n),n&&(n.state.loaded===!1||n.children.length>0)},is_loaded:function(n){return n=this.get_node(n),n&&n.state.loaded},is_loading:function(n){return n=this.get_node(n),n&&n.state&&n.state.loading},is_open:function(n){return n=this.get_node(n),n&&n.state.opened},is_closed:function(n){return n=this.get_node(n),n&&this.is_parent(n)&&!n.state.opened},is_leaf:function(n){return!this.is_parent(n)},load_node:function(n,t){var u,f,i,e,r,o,s;if($.isArray(n)){for(n=n.slice(),u=0,f=n.length;u<f;u++)this.load_node(n[u],t);return!0}if(n=this.get_node(n),!n)return t&&t.call(this,n,!1),!1;if(n.state.loaded){for(n.state.loaded=!1,i=0,e=n.children_d.length;i<e;i++){for(r=0,o=n.parents.length;r<o;r++)this._model.data[n.parents[r]].children_d=$.vakata.array_remove_item(this._model.data[n.parents[r]].children_d,n.children_d[i]);this._model.data[n.children_d[i]].state.selected&&(s=!0,this._data.core.selected=$.vakata.array_remove_item(this._data.core.selected,n.children_d[i]));delete this._model.data[n.children_d[i]]}n.children=[];n.children_d=[];s&&this.trigger("changed",{action:"load_node",node:n,selected:this._data.core.selected})}return n.state.loading=!0,this.get_node(n,!0).addClass("jstree-loading"),this._load_node(n,$.proxy(function(i){n.state.loading=!1;n.state.loaded=i;var r=this.get_node(n,!0);n.state.loaded&&!n.children.length&&r&&r.length&&!r.hasClass("jstree-leaf")&&r.removeClass("jstree-closed jstree-open").addClass("jstree-leaf");r.removeClass("jstree-loading");this.trigger("load_node",{node:n,status:i});t&&t.call(this,n,i)},this)),!0},_load_nodes:function(n,t,i){for(var u=!0,o=function(){this._load_nodes(n,t,!0)},f=this._model.data,r=0,e=n.length;r<e;r++)!f[n[r]]||f[n[r]].state.loaded&&i||(this.is_loading(n[r])||this.load_node(n[r],o),u=!1);u&&(t.done||(t.call(this,n),t.done=!0))},_load_node:function(n,t){var i=this.settings.core.data,r;return i?$.isFunction(i)?i.call(this,n,$.proxy(function(i){return i===!1?t.call(this,!1):t.call(this,this[typeof i=="string"?"_append_html_data":"_append_json_data"](n,typeof i=="string"?$(i):i))},this)):typeof i=="object"?i.url?(i=$.extend(!0,{},i),$.isFunction(i.url)&&(i.url=i.url.call(this,n)),$.isFunction(i.data)&&(i.data=i.data.call(this,n)),$.ajax(i).done($.proxy(function(i,r,u){var f=u.getResponseHeader("Content-Type");return f.indexOf("json")!==-1||typeof i=="object"?t.call(this,this._append_json_data(n,i)):f.indexOf("html")!==-1||typeof i=="string"?t.call(this,this._append_html_data(n,$(i))):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:n.id,xhr:u})},t.call(this,!1))},this)).fail($.proxy(function(i){t.call(this,!1);this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:n.id,xhr:i})};this.settings.core.error.call(this,this._data.core.last_error)},this))):(r=$.isArray(i)||$.isPlainObject(i)?JSON.parse(JSON.stringify(i)):i,n.id!=="#"&&(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:n.id})}),t.call(this,n.id==="#"?this._append_json_data(n,r):!1)):typeof i=="string"?(n.id!=="#"&&(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:n.id})}),t.call(this,n.id==="#"?this._append_html_data(n,$(i)):!1)):t.call(this,!1):t.call(this,n.id==="#"?this._append_html_data(n,this._data.core.original_container_html.clone(!0)):!1)},_node_changed:function(n){n=this.get_node(n);n&&this._model.changed.push(n.id)},_append_html_data:function(n,t){n=this.get_node(n);n.children=[];n.children_d=[];var c=t.is("ul")?t.children():t,f=n.id,s=[],i=[],e=this._model.data,r=e[f],l=this._data.core.selected.length,u,o,h;for(c.each($.proxy(function(n,t){u=this._parse_model_from_html($(t),f,r.parents.concat());u&&(s.push(u),i.push(u),e[u].children_d.length&&(i=i.concat(e[u].children_d)))},this)),r.children=s,r.children_d=i,o=0,h=r.parents.length;o<h;o++)e[r.parents[o]].children_d=e[r.parents[o]].children_d.concat(i);return this.trigger("model",{nodes:i,parent:f}),f!=="#"?(this._node_changed(f),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==l&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!0},_append_json_data:function(n,t){n=this.get_node(n);n.children=[];n.children_d=[];var r=t,h=n.id,c=[],s=[],u=this._model.data,f=u[h],l=this._data.core.selected.length,e,i,o;if(r.d&&(r=r.d,typeof r=="string"&&(r=JSON.parse(r))),$.isArray(r)||(r=[r]),r.length&&r[0].id!==undefined&&r[0].parent!==undefined){for(i=0,o=r.length;i<o;i++)r[i].children||(r[i].children=[]),u[r[i].id.toString()]=r[i];for(i=0,o=r.length;i<o;i++)u[r[i].parent.toString()].children.push(r[i].id.toString()),f.children_d.push(r[i].id.toString());for(i=0,o=f.children.length;i<o;i++)e=this._parse_model_from_flat_json(u[f.children[i]],h,f.parents.concat()),s.push(e),u[e].children_d.length&&(s=s.concat(u[e].children_d))}else{for(i=0,o=r.length;i<o;i++)e=this._parse_model_from_json(r[i],h,f.parents.concat()),e&&(c.push(e),s.push(e),u[e].children_d.length&&(s=s.concat(u[e].children_d)));for(f.children=c,f.children_d=s,i=0,o=f.parents.length;i<o;i++)u[f.parents[i]].children_d=u[f.parents[i]].children_d.concat(s)}return this.trigger("model",{nodes:s,parent:h}),h!=="#"?(this._node_changed(h),this.redraw()):this.redraw(!0),this._data.core.selected.length!==l&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!0},_parse_model_from_html:function(n,t,i){i=i?[].concat(i):[];t&&i.unshift(t);var e,o,h=this._model.data,r={id:!1,text:!1,icon:!0,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},f,u,s;for(f in this._model.default_state)this._model.default_state.hasOwnProperty(f)&&(r.state[f]=this._model.default_state[f]);if(u=$.vakata.attributes(n,!0),$.each(u,function(n,t){if(t=$.trim(t),!t.length)return!0;r.li_attr[n]=t;n==="id"&&(r.id=t.toString())}),u=n.children("a").eq(0),u.length&&(u=$.vakata.attributes(u,!0),$.each(u,function(n,t){t=$.trim(t);t.length&&(r.a_attr[n]=t)})),u=n.children("a:eq(0)").length?n.children("a:eq(0)").clone():n.clone(),u.children("ins, i, ul").remove(),u=u.html(),u=$("<div />").html(u),r.text=u.html(),u=n.data(),r.data=u?$.extend(!0,{},u):null,r.state.opened=n.hasClass("jstree-open"),r.state.selected=n.children("a").hasClass("jstree-clicked"),r.state.disabled=n.children("a").hasClass("jstree-disabled"),r.data&&r.data.jstree)for(f in r.data.jstree)r.data.jstree.hasOwnProperty(f)&&(r.state[f]=r.data.jstree[f]);u=n.children("a").children(".jstree-themeicon");u.length&&(r.icon=u.hasClass("jstree-themeicon-hidden")?!1:u.attr("rel"));r.state.icon&&(r.icon=r.state.icon);u=n.children("ul").children("li");do s="j"+this._id+"_"+ ++this._cnt;while(h[s]);return r.id=r.li_attr.id?r.li_attr.id.toString():s,u.length?(u.each($.proxy(function(n,t){e=this._parse_model_from_html($(t),r.id,i);o=this._model.data[e];r.children.push(e);o.children_d.length&&(r.children_d=r.children_d.concat(o.children_d))},this)),r.children_d=r.children_d.concat(r.children)):n.hasClass("jstree-closed")&&(r.state.loaded=!1),r.li_attr["class"]&&(r.li_attr["class"]=r.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),r.a_attr["class"]&&(r.a_attr["class"]=r.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),h[r.id]=r,r.state.selected&&this._data.core.selected.push(r.id),r.id},_parse_model_from_flat_json:function(n,t,i){i=i?i.concat():[];t&&i.unshift(t);var h=n.id.toString(),f=this._model.data,e=this._model.default_state,r,c,o,s,u={id:h,text:n.text||"",icon:n.icon!==undefined?n.icon:!0,parent:t,parents:i,children:n.children||[],children_d:n.children_d||[],data:n.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in e)e.hasOwnProperty(r)&&(u.state[r]=e[r]);if(n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(u.icon=n.data.jstree.icon),n&&n.data&&(u.data=n.data,n.data.jstree))for(r in n.data.jstree)n.data.jstree.hasOwnProperty(r)&&(u.state[r]=n.data.jstree[r]);if(n&&typeof n.state=="object")for(r in n.state)n.state.hasOwnProperty(r)&&(u.state[r]=n.state[r]);if(n&&typeof n.li_attr=="object")for(r in n.li_attr)n.li_attr.hasOwnProperty(r)&&(u.li_attr[r]=n.li_attr[r]);if(u.li_attr.id||(u.li_attr.id=h),n&&typeof n.a_attr=="object")for(r in n.a_attr)n.a_attr.hasOwnProperty(r)&&(u.a_attr[r]=n.a_attr[r]);for(n&&n.children&&n.children===!0&&(u.state.loaded=!1,u.children=[],u.children_d=[]),f[u.id]=u,r=0,c=u.children.length;r<c;r++)o=this._parse_model_from_flat_json(f[u.children[r]],u.id,i),s=f[o],u.children_d.push(o),s.children_d.length&&(u.children_d=u.children_d.concat(s.children_d));return delete n.data,delete n.children,f[u.id].original=n,u.state.selected&&this._data.core.selected.push(u.id),u.id},_parse_model_from_json:function(n,t,i){i=i?i.concat():[];t&&i.unshift(t);var f=!1,u,c,e,o,s=this._model.data,h=this._model.default_state,r;do f="j"+this._id+"_"+ ++this._cnt;while(s[f]);r={id:!1,text:typeof n=="string"?n:"",icon:typeof n=="object"&&n.icon!==undefined?n.icon:!0,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(u in h)h.hasOwnProperty(u)&&(r.state[u]=h[u]);if(n&&n.id&&(r.id=n.id.toString()),n&&n.text&&(r.text=n.text),n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(r.icon=n.data.jstree.icon),n&&n.data&&(r.data=n.data,n.data.jstree))for(u in n.data.jstree)n.data.jstree.hasOwnProperty(u)&&(r.state[u]=n.data.jstree[u]);if(n&&typeof n.state=="object")for(u in n.state)n.state.hasOwnProperty(u)&&(r.state[u]=n.state[u]);if(n&&typeof n.li_attr=="object")for(u in n.li_attr)n.li_attr.hasOwnProperty(u)&&(r.li_attr[u]=n.li_attr[u]);if(r.li_attr.id&&!r.id&&(r.id=r.li_attr.id.toString()),r.id||(r.id=f),r.li_attr.id||(r.li_attr.id=r.id),n&&typeof n.a_attr=="object")for(u in n.a_attr)n.a_attr.hasOwnProperty(u)&&(r.a_attr[u]=n.a_attr[u]);if(n&&n.children&&n.children.length){for(u=0,c=n.children.length;u<c;u++)e=this._parse_model_from_json(n.children[u],r.id,i),o=s[e],r.children.push(e),o.children_d.length&&(r.children_d=r.children_d.concat(o.children_d));r.children_d=r.children_d.concat(r.children)}return n&&n.children&&n.children===!0&&(r.state.loaded=!1,r.children=[],r.children_d=[]),delete n.data,delete n.children,r.original=n,s[r.id]=r,r.state.selected&&this._data.core.selected.push(r.id),r.id},_redraw:function(){for(var t=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),i=document.createElement("UL"),r,n=0,u=t.length;n<u;n++)r=this.redraw_node(t[n],!0,this._model.force_full_redraw),r&&this._model.force_full_redraw&&i.appendChild(r);this._model.force_full_redraw&&(i.className=this.get_container_ul()[0].className,this.element.empty().append(i));this._model.force_full_redraw=!1;this._model.changed=[];this.trigger("redraw",{nodes:t})},redraw:function(n){n&&(this._model.force_full_redraw=!0);this._redraw()},redraw_node:function(n,t,i){var r=this.get_node(n),u=!1,l=!1,a=!1,f=!1,o=!1,h=!1,s="",y=document,c=this._model.data,p=!1,v=!1;if(!r)return!1;if(r.id==="#")return this.redraw(!0);if(t=t||r.children.length===0,n=document.querySelector?this.element[0].querySelector("#"+("0123456789".indexOf(r.id[0])!==-1?"\\3"+r.id[0]+" "+r.id.substr(1).replace($.jstree.idregex,"\\$&"):r.id.replace($.jstree.idregex,"\\$&"))):document.getElementById(r.id),n)n=$(n),i||(u=n.parent().parent()[0],u===this.element[0]&&(u=null),l=n.index()),t||!r.children.length||n.children("ul").length||(t=!0),t||(a=n.children("UL")[0]),v=n.attr("aria-selected"),p=n.children(".jstree-anchor")[0]===document.activeElement,n.remove();else if(t=!0,!i){if(u=r.parent!=="#"?$("#"+r.parent.replace($.jstree.idregex,"\\$&"),this.element)[0]:null,u!==null&&(!u||!c[r.parent].state.opened))return!1;l=$.inArray(r.id,u===null?c["#"].children:c[r.parent].children)}n=e.cloneNode(!0);s="jstree-node ";for(f in r.li_attr)if(r.li_attr.hasOwnProperty(f)){if(f==="id")continue;f!=="class"?n.setAttribute(f,r.li_attr[f]):s+=r.li_attr[f]}v&&v!=="false"&&n.setAttribute("aria-selected",!0);r.state.loaded&&!r.children.length?s+=" jstree-leaf":(s+=r.state.opened&&r.state.loaded?" jstree-open":" jstree-closed",n.setAttribute("aria-expanded",r.state.opened&&r.state.loaded));r.parent!==null&&c[r.parent].children[c[r.parent].children.length-1]===r.id&&(s+=" jstree-last");n.id=r.id;n.className=s;s=(r.state.selected?" jstree-clicked":"")+(r.state.disabled?" jstree-disabled":"");for(o in r.a_attr)if(r.a_attr.hasOwnProperty(o)){if(o==="href"&&r.a_attr[o]==="#")continue;o!=="class"?n.childNodes[1].setAttribute(o,r.a_attr[o]):s+=" "+r.a_attr[o]}if(s.length&&(n.childNodes[1].className="jstree-anchor "+s),(r.icon&&r.icon!==!0||r.icon===!1)&&(r.icon===!1?n.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":r.icon.indexOf("/")===-1&&r.icon.indexOf(".")===-1?n.childNodes[1].childNodes[0].className+=" "+r.icon+" jstree-themeicon-custom":(n.childNodes[1].childNodes[0].style.backgroundImage="url("+r.icon+")",n.childNodes[1].childNodes[0].style.backgroundPosition="center center",n.childNodes[1].childNodes[0].style.backgroundSize="auto",n.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),n.childNodes[1].innerHTML+=r.text,t&&r.children.length&&r.state.opened&&r.state.loaded){for(h=y.createElement("UL"),h.setAttribute("role","group"),h.className="jstree-children",f=0,o=r.children.length;f<o;f++)h.appendChild(this.redraw_node(r.children[f],t,!0));n.appendChild(h)}return a&&n.appendChild(a),i||(u||(u=this.element[0]),u.getElementsByTagName("UL").length?u=u.getElementsByTagName("UL")[0]:(f=y.createElement("UL"),f.setAttribute("role","group"),f.className="jstree-children",u.appendChild(f),u=f),l<u.childNodes.length?u.insertBefore(n,u.childNodes[l]):u.appendChild(n),p&&n.childNodes[1].focus()),r.state.opened&&!r.state.loaded&&(r.state.opened=!1,setTimeout($.proxy(function(){this.open_node(r.id,!1,0)},this),0)),n},open_node:function(n,t,i){var u,f,r,e;if($.isArray(n)){for(n=n.slice(),u=0,f=n.length;u<f;u++)this.open_node(n[u],t,i);return!0}if(n=this.get_node(n),!n||n.id==="#")return!1;if(i=i===undefined?this.settings.core.animation:i,!this.is_closed(n))return t&&t.call(this,n,!1),!1;if(this.is_loaded(n))r=this.get_node(n,!0),e=this,r.length&&(n.children.length&&!this._firstChild(r.children("ul")[0])&&(n.state.opened=!0,this.redraw_node(n,!0),r=this.get_node(n,!0)),i?(this.trigger("before_open",{node:n}),r.children("ul").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children("ul").stop(!0,!0).slideDown(i,function(){this.style.display="";e.trigger("after_open",{node:n})})):(this.trigger("before_open",{node:n}),r[0].className=r[0].className.replace("jstree-closed","jstree-open"),r[0].setAttribute("aria-expanded",!0))),n.state.opened=!0,t&&t.call(this,n,!0),r.length||this.trigger("before_open",{node:n}),this.trigger("open_node",{node:n}),i&&r.length||this.trigger("after_open",{node:n});else{if(this.is_loading(n))return setTimeout($.proxy(function(){this.open_node(n,t,i)},this),500);this.load_node(n,function(n,r){return r?this.open_node(n,t,i):t?t.call(this,n,!1):!1})}},_open_to:function(n){if(n=this.get_node(n),!n||n.id==="#")return!1;for(var r=n.parents,t=0,i=r.length;t<i;t+=1)t!=="#"&&this.open_node(r[t],!1,0);return $("#"+n.id.replace($.jstree.idregex,"\\$&"),this.element)},close_node:function(n,t){var r,u,f,i;if($.isArray(n)){for(n=n.slice(),r=0,u=n.length;r<u;r++)this.close_node(n[r],t);return!0}if((n=this.get_node(n),!n||n.id==="#")||this.is_closed(n))return!1;t=t===undefined?this.settings.core.animation:t;f=this;i=this.get_node(n,!0);i.length&&(t?i.children("ul").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children("ul").stop(!0,!0).slideUp(t,function(){this.style.display="";i.children("ul").remove();f.trigger("after_close",{node:n})}):(i[0].className=i[0].className.replace("jstree-open","jstree-closed"),i.attr("aria-expanded",!1).children("ul").remove()));n.state.opened=!1;this.trigger("close_node",{node:n});t&&i.length||this.trigger("after_close",{node:n})},toggle_node:function(n){var t,i;if($.isArray(n)){for(n=n.slice(),t=0,i=n.length;t<i;t++)this.toggle_node(n[t]);return!0}return this.is_closed(n)?this.open_node(n):this.is_open(n)?this.close_node(n):void 0},open_all:function(n,t,i){if(n||(n="#"),n=this.get_node(n),!n)return!1;var r=n.id==="#"?this.get_container_ul():this.get_node(n,!0),u,f,e;if(!r.length){for(u=0,f=n.children_d.length;u<f;u++)this.is_closed(this._model.data[n.children_d[u]])&&(this._model.data[n.children_d[u]].state.opened=!0);return this.trigger("open_all",{node:n})}i=i||r;e=this;r=this.is_closed(n)?r.find("li.jstree-closed").addBack():r.find("li.jstree-closed");r.each(function(){e.open_node(this,function(n,r){r&&this.is_parent(n)&&this.open_all(n,t,i)},t||0)});i.find("li.jstree-closed").length===0&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(n,t){if(n||(n="#"),n=this.get_node(n),!n)return!1;var i=n.id==="#"?this.get_container_ul():this.get_node(n,!0),f=this,r,u;if(!i.length){for(r=0,u=n.children_d.length;r<u;r++)this._model.data[n.children_d[r]].state.opened=!1;return this.trigger("close_all",{node:n})}i=this.is_open(n)?i.find("li.jstree-open").addBack():i.find("li.jstree-open");$(i.get().reverse()).each(function(){f.close_node(this,t||0)});this.trigger("close_all",{node:n})},is_disabled:function(n){return n=this.get_node(n),n&&n.state&&n.state.disabled},enable_node:function(n){var t,i;if($.isArray(n)){for(n=n.slice(),t=0,i=n.length;t<i;t++)this.enable_node(n[t]);return!0}if(n=this.get_node(n),!n||n.id==="#")return!1;n.state.disabled=!1;this.get_node(n,!0).children(".jstree-anchor").removeClass("jstree-disabled");this.trigger("enable_node",{node:n})},disable_node:function(n){var t,i;if($.isArray(n)){for(n=n.slice(),t=0,i=n.length;t<i;t++)this.disable_node(n[t]);return!0}if(n=this.get_node(n),!n||n.id==="#")return!1;n.state.disabled=!0;this.get_node(n,!0).children(".jstree-anchor").addClass("jstree-disabled");this.trigger("disable_node",{node:n})},activate_node:function(n,t){if(this.is_disabled(n))return!1;if(this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==undefined?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&(!t.shiftKey||this._data.core.last_clicked&&this.get_parent(n)&&this.get_parent(n)===this._data.core.last_clicked.parent))if(t.shiftKey)for(var f=this.get_node(n).id,e=this._data.core.last_clicked.id,r=this.get_node(this._data.core.last_clicked.parent).children,u=!1,i=0,o=r.length;i<o;i+=1)r[i]===f&&(u=!u),r[i]===e&&(u=!u),u||r[i]===f||r[i]===e?this.select_node(r[i],!1,!1,t):this.deselect_node(r[i],!1,!1,t);else this.is_selected(n)?this.deselect_node(n,!1,!1,t):this.select_node(n,!1,!1,t);else!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(n)?this.deselect_node(n,!1,!1,t):(this.deselect_all(!0),this.select_node(n,!1,!1,t),this._data.core.last_clicked=this.get_node(n));this.trigger("activate_node",{node:this.get_node(n)})},hover_node:function(n){if(n=this.get_node(n,!0),!n||!n.length||n.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t);n.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(n)});setTimeout(function(){i.attr("aria-activedescendant",n[0].id);n.attr("aria-selected",!0)},0)},dehover_node:function(n){if(n=this.get_node(n,!0),!n||!n.length||!n.children(".jstree-hovered").length)return!1;n.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(n)})},select_node:function(n,t,i,r){var u,f,e;if($.isArray(n)){for(n=n.slice(),f=0,e=n.length;f<e;f++)this.select_node(n[f],t,i,r);return!0}if(n=this.get_node(n),!n||n.id==="#")return!1;u=this.get_node(n,!0);n.state.selected||(n.state.selected=!0,this._data.core.selected.push(n.id),i||(u=this._open_to(n)),u&&u.length&&u.children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:n,selected:this._data.core.selected,event:r}),t||this.trigger("changed",{action:"select_node",node:n,selected:this._data.core.selected,event:r}))},deselect_node:function(n,t,i){var r,f,u;if($.isArray(n)){for(n=n.slice(),r=0,f=n.length;r<f;r++)this.deselect_node(n[r],t,i);return!0}if(n=this.get_node(n),!n||n.id==="#")return!1;u=this.get_node(n,!0);n.state.selected&&(n.state.selected=!1,this._data.core.selected=$.vakata.array_remove_item(this._data.core.selected,n.id),u.length&&u.children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:n,selected:this._data.core.selected,event:i}),t||this.trigger("changed",{action:"deselect_node",node:n,selected:this._data.core.selected,event:i}))},select_all:function(n){var r=this._data.core.selected.concat([]),t,i;for(this._data.core.selected=this._model.data["#"].children_d.concat(),t=0,i=this._data.core.selected.length;t<i;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0);this.trigger("select_all",{selected:this._data.core.selected});n||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:r})},deselect_all:function(n){for(var i=this._data.core.selected.concat([]),t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked");this.trigger("deselect_all",{selected:this._data.core.selected,node:i});n||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(n){return(n=this.get_node(n),!n||n.id==="#")?!1:n.state.selected},get_selected:function(n){return n?$.map(this._data.core.selected,$.proxy(function(n){return this.get_node(n)},this)):this._data.core.selected},get_top_selected:function(n){for(var i=this.get_selected(!0),r={},u,e,t=0,f=i.length;t<f;t++)r[i[t].id]=i[t];for(t=0,f=i.length;t<f;t++)for(u=0,e=i[t].children_d.length;u<e;u++)r[i[t].children_d[u]]&&delete r[i[t].children_d[u]];i=[];for(t in r)r.hasOwnProperty(t)&&i.push(t);return n?$.map(i,$.proxy(function(n){return this.get_node(n)},this)):i},get_bottom_selected:function(n){for(var i=this.get_selected(!0),r=[],t=0,u=i.length;t<u;t++)i[t].children.length||r.push(i[t].id);return n?$.map(r,$.proxy(function(n){return this.get_node(n)},this)):r},get_state:function(){var t={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(var n in this._model.data)this._model.data.hasOwnProperty(n)&&n!=="#"&&(this._model.data[n].state.opened&&t.core.open.push(n),this._model.data[n].state.selected&&t.core.selected.push(n));return t},set_state:function(n,t){if(n){if(n.core){var r,u,i,f;if(n.core.open)return $.isArray(n.core.open)?(r=!0,u=!1,i=this,$.each(n.core.open.concat([]),function(f,e){u=i.get_node(e);u&&(i.is_loaded(e)?(i.is_closed(e)&&i.open_node(e,!1,0),n&&n.core&&n.core.open&&$.vakata.array_remove_item(n.core.open,e)):(i.is_loading(e)||i.open_node(e,$.proxy(function(i,r){!r&&n&&n.core&&n.core.open&&$.vakata.array_remove_item(n.core.open,i.id);this.set_state(n,t)},i),0),r=!1))}),r&&(delete n.core.open,this.set_state(n,t)),!1):(delete n.core.open,this.set_state(n,t),!1);if(n.core.scroll)return n.core.scroll&&n.core.scroll.left!==undefined&&this.element.scrollLeft(n.core.scroll.left),n.core.scroll&&n.core.scroll.top!==undefined&&this.element.scrollTop(n.core.scroll.top),delete n.core.scroll,this.set_state(n,t),!1;if(n.core.selected)return f=this,this.deselect_all(),$.each(n.core.selected,function(n,t){f.select_node(t)}),delete n.core.selected,this.set_state(n,t),!1;if($.isEmptyObject(n.core))return delete n.core,this.set_state(n,t),!1}return $.isEmptyObject(n)?(n=null,t&&t.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(n){this._data.core.state=this.get_state();this._cnt=0;this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}};var t=this.get_container_ul()[0].className;n||this.element.html("<ul class='jstree-container-ul'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'><\/i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'><\/i>"+this.get_string("Loading ...")+"<\/a><\/li><\/ul>");this.load_node("#",function(n,i){i&&(this.get_container_ul()[0].className=t,this.set_state($.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")}));this._data.core.state=null})},refresh_node:function(n){if(n=this.get_node(n),!n||n.id==="#")return!1;var t=[],i=this._data.core.selected.concat([]);n.state.opened===!0&&t.push(n.id);this.get_node(n,!0).find(".jstree-open").each(function(){t.push(this.id)});this._load_nodes(t,$.proxy(function(t){this.open_node(t,!1,0);this.select_node(this._data.core.selected);this.trigger("refresh_node",{node:n,nodes:t})},this))},set_id:function(n,t){if(n=this.get_node(n),!n||n.id==="#")return!1;var i,u,r=this._model.data;for(t=t.toString(),r[n.parent].children[$.inArray(n.id,r[n.parent].children)]=t,i=0,u=n.parents.length;i<u;i++)r[n.parents[i]].children_d[$.inArray(n.id,r[n.parents[i]].children_d)]=t;for(i=0,u=n.children.length;i<u;i++)r[n.children[i]].parent=t;for(i=0,u=n.children_d.length;i<u;i++)r[n.children_d[i]].parents[$.inArray(n.id,r[n.children_d[i]].parents)]=t;return i=$.inArray(n.id,this._data.core.selected),i!==-1&&(this._data.core.selected[i]=t),i=this.get_node(n.id,!0),i&&i.attr("id",t),delete r[n.id],n.id=t,r[t]=n,!0},get_text:function(n){return n=this.get_node(n),!n||n.id==="#"?!1:n.text},set_text:function(n,t){var r,u,i,f;if($.isArray(n)){for(n=n.slice(),r=0,u=n.length;r<u;r++)this.set_text(n[r],t);return!0}return(n=this.get_node(n),!n||n.id==="#")?!1:(n.text=t,i=this.get_node(n,!0),i.length&&(i=i.children(".jstree-anchor:eq(0)"),f=i.children("I").clone(),i.html(t).prepend(f),this.trigger("set_text",{obj:n,text:t})),!0)},get_json:function(n,t,i){if(n=this.get_node(n||"#"),!n)return!1;t&&t.flat&&!i&&(i=[]);var r={id:n.id,text:n.text,icon:this.get_icon(n),li_attr:n.li_attr,a_attr:n.a_attr,state:{},data:t&&t.no_data?!1:n.data},u,f;if(t&&t.flat?r.parent=n.parent:r.children=[],!t||!t.no_state)for(u in n.state)n.state.hasOwnProperty(u)&&(r.state[u]=n.state[u]);if(t&&t.no_id&&(delete r.id,r.li_attr&&r.li_attr.id&&delete r.li_attr.id),t&&t.flat&&n.id!=="#"&&i.push(r),!t||!t.no_children)for(u=0,f=n.children.length;u<f;u++)t&&t.flat?this.get_json(n.children[u],t,i):r.children.push(this.get_json(n.children[u],t));return t&&t.flat?i:n.id==="#"?r.children:r},create_node:function(n,t,i,r,u){if(n===null&&(n="#"),n=this.get_node(n),!n)return!1;if(i=i===undefined?"last":i,!i.toString().match(/^(before|after)$/)&&!u&&!this.is_loaded(n))return this.load_node(n,function(){this.create_node(n,t,i,r,!0)});t||(t={text:this.get_string("New node")});t.text===undefined&&(t.text=this.get_string("New node"));var f,o,e,s;n.id==="#"&&(i==="before"&&(i="first"),i==="after"&&(i="last"));switch(i){case"before":f=this.get_node(n.parent);i=$.inArray(n.id,f.children);n=f;break;case"after":f=this.get_node(n.parent);i=$.inArray(n.id,f.children)+1;n=f;break;case"inside":case"first":i=0;break;case"last":i=n.children.length;break;default:i||(i=0)}if(i>n.children.length&&(i=n.children.length),t.id||(t.id=!0),!this.check("create_node",t,n,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(t.id===!0&&delete t.id,t=this._parse_model_from_json(t,n.id,n.parents.concat()),!t)return!1;for(f=this.get_node(t),o=[],o.push(t),o=o.concat(f.children_d),this.trigger("model",{nodes:o,parent:n.id}),n.children_d=n.children_d.concat(o),e=0,s=n.parents.length;e<s;e++)this._model.data[n.parents[e]].children_d=this._model.data[n.parents[e]].children_d.concat(o);for(t=f,f=[],e=0,s=n.children.length;e<s;e++)f[e>=i?e+1:e]=n.children[e];return f[i]=t.id,n.children=f,this.redraw_node(n,!0),r&&r.call(this,this.get_node(t)),this.trigger("create_node",{node:this.get_node(t),parent:n.id,position:i}),t.id},rename_node:function(n,t){var i,r,u;if($.isArray(n)){for(n=n.slice(),i=0,r=n.length;i<r;i++)this.rename_node(n[i],t);return!0}return(n=this.get_node(n),!n||n.id==="#")?!1:(u=n.text,!this.check("rename_node",n,this.get_parent(n),t))?(this.settings.core.error.call(this,this._data.core.last_error),!1):(this.set_text(n,t),this.trigger("rename_node",{node:n,text:t,old:u}),!0)},delete_node:function(n){var e,h,r,t,u,f,c,i,o,s;if($.isArray(n)){for(n=n.slice(),e=0,h=n.length;e<h;e++)this.delete_node(n[e]);return!0}if(n=this.get_node(n),!n||n.id==="#")return!1;if(r=this.get_node(n.parent),t=$.inArray(n.id,r.children),s=!1,!this.check("delete_node",n,r,t))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(t!==-1&&(r.children=$.vakata.array_remove(r.children,t)),u=n.children_d.concat([]),u.push(n.id),i=0,o=u.length;i<o;i++){for(f=0,c=n.parents.length;f<c;f++)t=$.inArray(u[i],this._model.data[n.parents[f]].children_d),t!==-1&&(this._model.data[n.parents[f]].children_d=$.vakata.array_remove(this._model.data[n.parents[f]].children_d,t));this._model.data[u[i]].state.selected&&(s=!0,t=$.inArray(u[i],this._data.core.selected),t!==-1&&(this._data.core.selected=$.vakata.array_remove(this._data.core.selected,t)))}for(this.trigger("delete_node",{node:n,parent:r.id}),s&&this.trigger("changed",{action:"delete_node",node:n,selected:this._data.core.selected,parent:r.id}),i=0,o=u.length;i<o;i++)delete this._model.data[u[i]];return this.redraw_node(r,!0),!0},check:function(n,t,i,r,u){t=t&&t.id?t:this.get_node(t);i=i&&i.id?i:this.get_node(i);var f=n.match(/^move_node|copy_node|create_node$/i)?i:t,e=this.settings.core.check_callback;return(n==="move_node"||n==="copy_node")&&(!u||!u.is_multi)&&(t.id===i.id||$.inArray(t.id,i.children)===r||$.inArray(i.id,t.children_d)!==-1)?(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:n,pos:r,obj:t&&t.id?t.id:!1,par:i&&i.id?i.id:!1})},!1):(f&&f.data&&(f=f.data),f&&f.functions&&(f.functions[n]===!1||f.functions[n]===!0))?(f.functions[n]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+n,data:JSON.stringify({chk:n,pos:r,obj:t&&t.id?t.id:!1,par:i&&i.id?i.id:!1})}),f.functions[n]):e===!1||$.isFunction(e)&&e.call(this,n,t,i,r,u)===!1||e&&e[n]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+n,data:JSON.stringify({chk:n,pos:r,obj:t&&t.id?t.id:!1,par:i&&i.id?i.id:!1})},!1):!0},last_error:function(){return this._data.core.last_error},move_node:function(n,t,i,r,u){var y,p,l,e,o,w,h,s,f,c,v,b,a;if($.isArray(n)){for(n=n.reverse().slice(),y=0,p=n.length;y<p;y++)this.move_node(n[y],t,i,r,u);return!0}if(n=n&&n.id?n:this.get_node(n),t=this.get_node(t),i=i===undefined?0:i,!t||!n||n.id==="#")return!1;if(!i.toString().match(/^(before|after)$/)&&!u&&!this.is_loaded(t))return this.load_node(t,function(){this.move_node(n,t,i,r,!0)});if(l=(n.parent||"#").toString(),e=!i.toString().match(/^(before|after)$/)||t.id==="#"?t:this.get_node(t.parent),o=n.instance?n.instance:this._model.data[n.id]?this:$.jstree.reference(n.id),w=!o||!o._id||this._id!==o._id,w)return this.copy_node(n,t,i,r,u)?(o&&o.delete_node(n),!0):!1;e.id==="#"&&(i==="before"&&(i="first"),i==="after"&&(i="last"));switch(i){case"before":i=$.inArray(t.id,e.children);break;case"after":i=$.inArray(t.id,e.children)+1;break;case"inside":case"first":i=0;break;case"last":i=e.children.length;break;default:i||(i=0)}if(i>e.children.length&&(i=e.children.length),!this.check("move_node",n,e,i,{core:!0,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.parent===e.id){for(h=e.children.concat(),s=$.inArray(n.id,h),s!==-1&&(h=$.vakata.array_remove(h,s),i>s&&i--),s=[],f=0,c=h.length;f<c;f++)s[f>=i?f+1:f]=h[f];s[i]=n.id;e.children=s;this._node_changed(e.id);this.redraw(e.id==="#")}else{for(s=n.children_d.concat(),s.push(n.id),f=0,c=n.parents.length;f<c;f++){for(h=[],a=o._model.data[n.parents[f]].children_d,v=0,b=a.length;v<b;v++)$.inArray(a[v],s)===-1&&h.push(a[v]);o._model.data[n.parents[f]].children_d=h}for(o._model.data[l].children=$.vakata.array_remove_item(o._model.data[l].children,n.id),f=0,c=e.parents.length;f<c;f++)this._model.data[e.parents[f]].children_d=this._model.data[e.parents[f]].children_d.concat(s);for(h=[],f=0,c=e.children.length;f<c;f++)h[f>=i?f+1:f]=e.children[f];for(h[i]=n.id,e.children=h,e.children_d.push(n.id),e.children_d=e.children_d.concat(n.children_d),n.parent=e.id,s=e.parents.concat(),s.unshift(e.id),a=n.parents.length,n.parents=s,s=s.concat(),f=0,c=n.children_d.length;f<c;f++)this._model.data[n.children_d[f]].parents=this._model.data[n.children_d[f]].parents.slice(0,a*-1),Array.prototype.push.apply(this._model.data[n.children_d[f]].parents,s);this._node_changed(l);this._node_changed(e.id);this.redraw(l==="#"||e.id==="#")}return r&&r.call(this,n,e,i),this.trigger("move_node",{node:n,parent:e.id,position:i,old_parent:l,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id,old_instance:o,new_instance:this}),!0},copy_node:function(n,t,i,r,u){var l,v,s,h,o,a,c,y,f,e,p;if($.isArray(n)){for(n=n.reverse().slice(),l=0,v=n.length;l<v;l++)this.copy_node(n[l],t,i,r,u);return!0}if(n=n&&n.id?n:this.get_node(n),t=this.get_node(t),i=i===undefined?0:i,!t||!n||n.id==="#")return!1;if(!i.toString().match(/^(before|after)$/)&&!u&&!this.is_loaded(t))return this.load_node(t,function(){this.copy_node(n,t,i,r,!0)});y=(n.parent||"#").toString();f=!i.toString().match(/^(before|after)$/)||t.id==="#"?t:this.get_node(t.parent);e=n.instance?n.instance:this._model.data[n.id]?this:$.jstree.reference(n.id);p=!e||!e._id||this._id!==e._id;f.id==="#"&&(i==="before"&&(i="first"),i==="after"&&(i="last"));switch(i){case"before":i=$.inArray(t.id,f.children);break;case"after":i=$.inArray(t.id,f.children)+1;break;case"inside":case"first":i=0;break;case"last":i=f.children.length;break;default:i||(i=0)}if(i>f.children.length&&(i=f.children.length),!this.check("copy_node",n,f,i,{core:!0,is_multi:e&&e._id&&e._id!==this._id,is_foreign:!e||!e._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if((c=e?e.get_json(n,{no_id:!0,no_data:!0,no_state:!0}):n,!c)||(c.id===!0&&delete c.id,c=this._parse_model_from_json(c,f.id,f.parents.concat()),!c))return!1;for(h=this.get_node(c),n&&n.state&&n.state.loaded===!1&&(h.state.loaded=!1),s=[],s.push(c),s=s.concat(h.children_d),this.trigger("model",{nodes:s,parent:f.id}),o=0,a=f.parents.length;o<a;o++)this._model.data[f.parents[o]].children_d=this._model.data[f.parents[o]].children_d.concat(s);for(s=[],o=0,a=f.children.length;o<a;o++)s[o>=i?o+1:o]=f.children[o];return s[i]=h.id,f.children=s,f.children_d.push(h.id),f.children_d=f.children_d.concat(h.children_d),this._node_changed(f.id),this.redraw(f.id==="#"),r&&r.call(this,h,f,i),this.trigger("copy_node",{node:h,original:n,parent:f.id,position:i,old_parent:y,is_multi:e&&e._id&&e._id!==this._id,is_foreign:!e||!e._id,old_instance:e,new_instance:this}),h.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),$.isArray(t)||(t=[t]),!t.length)return!1;for(var e=[],r,f=0,o=t.length;f<o;f++)r=this.get_node(t[f]),r&&r.id&&r.id!=="#"&&e.push(r);if(!e.length)return!1;i=e;u=this;n="move_node";this.trigger("cut",{node:t})},copy:function(t){if(t||(t=this._data.core.selected.concat()),$.isArray(t)||(t=[t]),!t.length)return!1;for(var e=[],r,f=0,o=t.length;f<o;f++)r=this.get_node(t[f]),r&&r.id&&r.id!=="#"&&e.push(r);if(!e.length)return!1;i=e;u=this;n="copy_node";this.trigger("copy",{node:t})},get_buffer:function(){return{mode:n,node:i,inst:u}},can_paste:function(){return n!==!1&&i!==!1},paste:function(t,r){if(t=this.get_node(t),!t||!n||!n.match(/^(copy_node|move_node)$/)||!i)return!1;this[n](i,t,r)&&this.trigger("paste",{parent:t.id,node:i,mode:n});i=!1;n=!1;u=!1},edit:function(n,t){if(n=this._open_to(n),!n||!n.length)return!1;var h=this._data.core.rtl,o=this.element.width(),i=n.children(".jstree-anchor"),r=$("<span>"),u=typeof t=="string"?t:this.get_text(n),f=$("<div />",{css:{position:"absolute",top:"-200px",left:h?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),e=$("<input />",{value:u,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:$.proxy(function(){var e=r.children(".jstree-rename-input"),t=e.val();t===""&&(t=u);f.remove();r.replaceWith(i);r.remove();this.set_text(n,u);this.rename_node(n,t)===!1&&this.set_text(n,u)},this),keydown:function(n){var t=n.which;t===27&&(this.value=u);(t===27||t===13||t===37||t===38||t===39||t===40||t===32)&&n.stopImmediatePropagation();(t===27||t===13)&&(n.preventDefault(),this.blur())},click:function(n){n.stopImmediatePropagation()},mousedown:function(n){n.stopImmediatePropagation()},keyup:function(){e.width(Math.min(f.text("pW"+this.value).width(),o))},keypress:function(n){if(n.which===13)return!1}}),s={fontFamily:i.css("fontFamily")||"",fontSize:i.css("fontSize")||"",fontWeight:i.css("fontWeight")||"",fontStyle:i.css("fontStyle")||"",fontStretch:i.css("fontStretch")||"",fontVariant:i.css("fontVariant")||"",letterSpacing:i.css("letterSpacing")||"",wordSpacing:i.css("wordSpacing")||""};this.set_text(n,"");r.attr("class",i.attr("class")).append(i.contents().clone()).append(e);i.replaceWith(r);f.css(s);e.css(s).width(Math.min(f.text("pW"+e[0].value).width(),o))[0].select()},set_theme:function(n,t){if(!n)return!1;if(t===!0){var i=this.settings.core.themes.dir;i||(i=$.jstree.path+"/themes");t=i+"/"+n+"/style.css"}t&&$.inArray(t,l)===-1&&($("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />'),l.push(t));this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name);this._data.core.themes.name=n;this.element.addClass("jstree-"+n);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+n+"-responsive");this.trigger("set_theme",{theme:n})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(n){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant);this._data.core.themes.variant=n;n&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(n,t){var r,f,i,u;if($.isArray(n)){for(n=n.slice(),r=0,f=n.length;r<f;r++)this.set_icon(n[r],t);return!0}return(n=this.get_node(n),!n||n.id==="#")?!1:(u=n.icon,n.icon=t,i=this.get_node(n,!0).children(".jstree-anchor").children(".jstree-themeicon"),t===!1?this.hide_icon(n):t===!0?i.removeClass("jstree-themeicon-custom "+u).css("background","").removeAttr("rel"):t.indexOf("/")===-1&&t.indexOf(".")===-1?(i.removeClass(u).css("background",""),i.addClass(t+" jstree-themeicon-custom").attr("rel",t)):(i.removeClass(u).css("background",""),i.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat").attr("rel",t)),!0)},get_icon:function(n){return n=this.get_node(n),!n||n.id==="#"?!1:n.icon},hide_icon:function(n){var t,i;if($.isArray(n)){for(n=n.slice(),t=0,i=n.length;t<i;t++)this.hide_icon(n[t]);return!0}return(n=this.get_node(n),!n||n==="#")?!1:(n.icon=!1,this.get_node(n,!0).children("a").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(n){var t,r,i;if($.isArray(n)){for(n=n.slice(),t=0,r=n.length;t<r;t++)this.show_icon(n[t]);return!0}return(n=this.get_node(n),!n||n==="#")?!1:(i=this.get_node(n,!0),n.icon=i.length?i.children("a").children(".jstree-themeicon").attr("rel"):!0,n.icon||(n.icon=!0),i.children("a").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}};$.vakata={};$.vakata.attributes=function(n,t){n=$(n)[0];var i=t?{}:[];return n&&n.attributes&&$.each(n.attributes,function(n,r){$.inArray(r.nodeName.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])===-1&&r.nodeValue!==null&&$.trim(r.nodeValue)!==""&&(t?i[r.nodeName]=r.nodeValue:i.push(r.nodeName))}),i};$.vakata.array_unique=function(n){for(var r=[],i,t=0,u=n.length;t<u;t++){for(i=0;i<=t;i++)if(n[t]===n[i])break;i===t&&r.push(n[t])}return r};$.vakata.array_remove=function(n,t,i){var r=n.slice((i||t)+1||n.length);return n.length=t<0?n.length+t:t,n.push.apply(n,r),n};$.vakata.array_remove_item=function(n,t){var i=$.inArray(t,n);return i!==-1?$.vakata.array_remove(n,i):n},function(){var n={},i=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}},t=i(window.navigator.userAgent);t.browser&&(n[t.browser]=!0,n.version=t.version);n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0);$.vakata.browser=n}();$.vakata.browser.msie&&$.vakata.browser.version<8&&($.jstree.defaults.core.animation=0);c=document.createElement("I");c.className="jstree-icon jstree-checkbox";$.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0};$.jstree.plugins.checkbox=function(n,t){this.bind=function(){t.bind.call(this);this._data.checkbox.uto=!1;this.element.on("init.jstree",$.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked")},this)).on("loading.jstree",$.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.three_state)this.element.on("changed.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",$.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto);this._data.checkbox.uto=setTimeout($.proxy(this._undetermined,this),50)},this)).on("model.jstree",$.proxy(function(n,t){var u=this._model.data,r=u[t.parent],e=t.nodes,s=[],l,i,f,o,h,c;if(r.state.selected){for(i=0,f=e.length;i<f;i++)u[e[i]].state.selected=!0;this._data.core.selected=this._data.core.selected.concat(e)}else for(i=0,f=e.length;i<f;i++)if(u[e[i]].state.selected){for(o=0,h=u[e[i]].children_d.length;o<h;o++)u[u[e[i]].children_d[o]].state.selected=!0;this._data.core.selected=this._data.core.selected.concat(u[e[i]].children_d)}for(i=0,f=r.children_d.length;i<f;i++)u[r.children_d[i]].children.length||s.push(u[r.children_d[i]].parent);for(s=$.vakata.array_unique(s),o=0,h=s.length;o<h;o++)for(r=u[s[o]];r&&r.id!=="#";){for(l=0,i=0,f=r.children.length;i<f;i++)l+=u[r.children[i]].state.selected;if(l===f)r.state.selected=!0,this._data.core.selected.push(r.id),c=this.get_node(r,!0),c&&c.length&&c.children(".jstree-anchor").addClass("jstree-clicked");else break;r=this.get_node(r.parent)}this._data.core.selected=$.vakata.array_unique(this._data.core.selected)},this)).on("select_node.jstree",$.proxy(function(n,t){var f=t.node,s=this._model.data,r=this.get_node(f.parent),h=this.get_node(f,!0),u,e,o,i;for(this._data.core.selected=$.vakata.array_unique(this._data.core.selected.concat(f.children_d)),u=0,e=f.children_d.length;u<e;u++)i=s[f.children_d[u]],i.state.selected=!0,i&&i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=!1);while(r&&r.id!=="#"){for(o=0,u=0,e=r.children.length;u<e;u++)o+=s[r.children[u]].state.selected;if(o===e)r.state.selected=!0,this._data.core.selected.push(r.id),i=this.get_node(r,!0),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-clicked");else break;r=this.get_node(r.parent)}h.length&&h.find(".jstree-anchor").addClass("jstree-clicked")},this)).on("deselect_all.jstree",$.proxy(function(){for(var i=this.get_node("#"),u=this._model.data,n,t=0,r=i.children_d.length;t<r;t++)n=u[i.children_d[t]],n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1)},this)).on("deselect_node.jstree",$.proxy(function(n,t){var u=t.node,e=this.get_node(u,!0),r,f,i;for(u&&u.original&&u.original.state&&u.original.state.undetermined&&(u.original.state.undetermined=!1),r=0,f=u.children_d.length;r<f;r++)i=this._model.data[u.children_d[r]],i.state.selected=!1,i&&i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=!1);for(r=0,f=u.parents.length;r<f;r++)i=this._model.data[u.parents[r]],i.state.selected=!1,i&&i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=!1),i=this.get_node(u.parents[r],!0),i&&i.length&&i.children(".jstree-anchor").removeClass("jstree-clicked");for(i=[],r=0,f=this._data.core.selected.length;r<f;r++)$.inArray(this._data.core.selected[r],u.children_d)===-1&&$.inArray(this._data.core.selected[r],u.parents)===-1&&i.push(this._data.core.selected[r]);this._data.core.selected=$.vakata.array_unique(i);e.length&&e.find(".jstree-anchor").removeClass("jstree-clicked")},this)).on("delete_node.jstree",$.proxy(function(n,t){for(var i=this.get_node(t.parent),o=this._model.data,r,f,e,u;i&&i.id!=="#";){for(e=0,r=0,f=i.children.length;r<f;r++)e+=o[i.children[r]].state.selected;if(e===f)i.state.selected=!0,this._data.core.selected.push(i.id),u=this.get_node(i,!0),u&&u.length&&u.children(".jstree-anchor").addClass("jstree-clicked");else break;i=this.get_node(i.parent)}},this)).on("move_node.jstree",$.proxy(function(n,t){var s=t.is_multi,h=t.old_parent,c=this.get_node(t.parent),o=this._model.data,i,f,u,e,r;if(!s)for(i=this.get_node(h);i&&i.id!=="#";){for(f=0,u=0,e=i.children.length;u<e;u++)f+=o[i.children[u]].state.selected;if(f===e)i.state.selected=!0,this._data.core.selected.push(i.id),r=this.get_node(i,!0),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-clicked");else break;i=this.get_node(i.parent)}for(i=c;i&&i.id!=="#";){for(f=0,u=0,e=i.children.length;u<e;u++)f+=o[i.children[u]].state.selected;if(f===e)i.state.selected||(i.state.selected=!0,this._data.core.selected.push(i.id),r=this.get_node(i,!0),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-clicked"));else if(i.state.selected)i.state.selected=!1,this._data.core.selected=$.vakata.array_remove_item(this._data.core.selected,i.id),r=this.get_node(i,!0),r&&r.length&&r.children(".jstree-anchor").removeClass("jstree-clicked");else break;i=this.get_node(i.parent)}},this))};this._undetermined=function(){for(var u=this._model.data,i=this._data.core.selected,t=[],f=this,n=0,r=i.length;n<r;n++)u[i[n]]&&u[i[n]].parents&&(t=t.concat(u[i[n]].parents));for(this.element.find(".jstree-closed").not(":has(ul)").each(function(){var i=f.get_node(this),e;if(i.state.loaded)for(n=0,r=i.children_d.length;n<r;n++)e=u[i.children_d[n]],!e.state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&e.original.state.undetermined===!0&&(t.push(e.id),t=t.concat(e.parents));else i.original&&i.original.state&&i.original.state.undetermined&&i.original.state.undetermined===!0&&(t.push(i.id),t=t.concat(i.parents))}),t=$.vakata.array_unique(t),t=$.vakata.array_remove_item(t,"#"),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),n=0,r=t.length;n<r;n++)u[t[n]].state.selected||(i=this.get_node(t[n],!0),i&&i.length&&i.children("a").children(".jstree-checkbox").addClass("jstree-undetermined"))};this.redraw_node=function(n,i,r){if(n=t.redraw_node.call(this,n,i,r),n){var u=n.getElementsByTagName("A")[0];u.insertBefore(c.cloneNode(!1),u.childNodes[0])}return!r&&this.settings.checkbox.three_state&&(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout($.proxy(this._undetermined,this),50)),n};this.activate_node=function(n,i){return(this.settings.checkbox.whole_node||$(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),t.activate_node.call(this,n,i)};this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0;this.element.children("ul").removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1;this.element.children("ul").addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()}};$.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(n){var t=$.jstree.reference(n.reference),i=t.get_node(n.reference);t.create_node(i,{},"last",function(n){setTimeout(function(){t.edit(n)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(n){var t=$.jstree.reference(n.reference),i=t.get_node(n.reference);t.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(n){var t=$.jstree.reference(n.reference),i=t.get_node(n.reference);t.is_selected(i)?t.delete_node(t.get_selected()):t.delete_node(i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(n){var t=$.jstree.reference(n.reference),i=t.get_node(n.reference);t.is_selected(i)?t.cut(t.get_selected()):t.cut(i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(n){var t=$.jstree.reference(n.reference),i=t.get_node(n.reference);t.is_selected(i)?t.copy(t.get_selected()):t.copy(i)}},paste:{separator_before:!1,icon:!1,_disabled:function(n){return!$.jstree.reference(n.reference).can_paste()},separator_after:!1,label:"Paste",action:function(n){var t=$.jstree.reference(n.reference),i=t.get_node(n.reference);t.paste(i)}}}}}}};$.jstree.plugins.contextmenu=function(n,t){this.bind=function(){t.bind.call(this);var n=0;this.element.on("contextmenu.jstree",".jstree-anchor",$.proxy(function(t){t.preventDefault();n=t.ctrlKey?t.timeStamp:0;this.is_loading(t.currentTarget)||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY,t)},this)).on("click.jstree",".jstree-anchor",$.proxy(function(t){this._data.contextmenu.visible&&(!n||t.timeStamp-n>250)&&$.vakata.context.hide()},this));$(document).on("context_hide.vakata",$.proxy(function(){this._data.contextmenu.visible=!1},this))};this.teardown=function(){this._data.contextmenu.visible&&$.vakata.context.hide();t.teardown.call(this)};this.show_contextmenu=function(n,t,i,r){if(n=this.get_node(n),!n||n.id==="#")return!1;var e=this.settings.contextmenu,o=this.get_node(n,!0),s=o.children(".jstree-anchor"),f=!1,u=!1;(e.show_at_node||t===undefined||i===undefined)&&(f=s.offset(),t=f.left,i=f.top+this._data.core.li_height);this.settings.contextmenu.select_node&&!this.is_selected(n)&&(this.deselect_all(),this.select_node(n,!1,!1,r));u=e.items;$.isFunction(u)&&(u=u.call(this,n,$.proxy(function(r){this._show_contextmenu(n,t,i,r)},this)));$.isPlainObject(u)&&this._show_contextmenu(n,t,i,u)};this._show_contextmenu=function(n,t,i,r){var u=this.get_node(n,!0),f=u.children(".jstree-anchor");$(document).one("context_show.vakata",$.proxy(function(n,t){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";$(t.element).addClass(i)},this));this._data.contextmenu.visible=!0;$.vakata.context.show(f,{x:t,y:i},r);this.trigger("show_contextmenu",{node:n,x:t,y:i})}},function(n){var i=!1,t={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};n.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(i){n(document).triggerHandler("context_"+i+".vakata",{reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}})},_execute:function(i){return i=t.items[i],i&&(!i._disabled||n.isFunction(i._disabled)&&!i._disabled({item:i,reference:t.reference,element:t.element}))&&i.action?i.action.call(null,{item:i,reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}}):!1},_parse:function(i,r){if(!i)return!1;r||(t.html="",t.items=[]);var u="",f=!1,e;return r&&(u+="<ul>"),n.each(i,function(i,r){if(!r)return!0;t.items.push(r);!f&&r.separator_before&&(u+="<li class='vakata-context-separator'><a href='#' "+(n.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<\/a><\/li>");f=!1;u+="<li class='"+(r._class||"")+(r._disabled===!0||n.isFunction(r._disabled)&&r._disabled({item:r,reference:t.reference,element:t.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">";u+="<a href='#' rel='"+(t.items.length-1)+"'>";n.vakata.context.settings.icons&&(u+="<i ",r.icon&&(u+=r.icon.indexOf("/")!==-1||r.icon.indexOf(".")!==-1?" style='background:url(\""+r.icon+"\") center center no-repeat' ":" class='"+r.icon+"' "),u+="><\/i><span class='vakata-contextmenu-sep'>&#160;<\/span>");u+=(n.isFunction(r.label)?r.label({item:i,reference:t.reference,element:t.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"<\/span>":"")+"<\/a>";r.submenu&&(e=n.vakata.context._parse(r.submenu,!0),e&&(u+=e));u+="<\/li>";r.separator_after&&(u+="<li class='vakata-context-separator'><a href='#' "+(n.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<\/a><\/li>",f=!0)}),u=u.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(u+="<\/ul>"),r||(t.html=u,n.vakata.context._trigger("parse")),u.length>10?u:!1},_show_submenu:function(t){if(t=n(t),t.length&&t.children("ul").length){var r=t.children("ul"),u=t.offset().left+t.outerWidth(),e=t.offset().top,f=r.width(),o=r.height(),s=n(window).width()+n(window).scrollLeft(),h=n(window).height()+n(window).scrollTop();i?t[u-(f+10+t.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):t[u+f+10>s?"addClass":"removeClass"]("vakata-context-right");e+o+10>h&&r.css("bottom","-1px");r.show()}},show:function(r,u,f){var h,o,e,s,c,l,a,v;t.element&&t.element.length&&t.element.width("");switch(!0){case!u&&!r:return!1;case!!u&&!!r:t.reference=r;t.position_x=u.x;t.position_y=u.y;break;case!u&&!!r:t.reference=r;h=r.offset();t.position_x=h.left+r.outerHeight();t.position_y=h.top;break;case!!u&&!r:t.position_x=u.x;t.position_y=u.y}!r||f||!n(r).data("vakata_contextmenu")||(f=n(r).data("vakata_contextmenu"));n.vakata.context._parse(f)&&t.element.html(t.html);t.items.length&&(o=t.element,e=t.position_x,s=t.position_y,c=o.width(),l=o.height(),a=n(window).width()+n(window).scrollLeft(),v=n(window).height()+n(window).scrollTop(),i&&(e-=o.outerWidth(),e<n(window).scrollLeft()+20&&(e=n(window).scrollLeft()+20)),e+c+20>a&&(e=a-(c+20)),s+l+20>v&&(s=v-(l+20)),t.element.css({left:e,top:s}).show().find("a:eq(0)").focus().parent().addClass("vakata-context-hover"),t.is_visible=!0,n.vakata.context._trigger("show"))},hide:function(){t.is_visible&&(t.element.hide().find("ul").hide().end().find(":focus").blur(),t.is_visible=!1,n.vakata.context._trigger("hide"))}};n(function(){i=n("body").css("direction")==="rtl";var r=!1;t.element=n("<ul class='vakata-context'><\/ul>");t.element.on("mouseenter","li",function(i){(i.stopImmediatePropagation(),n.contains(this,i.relatedTarget))||(r&&clearTimeout(r),t.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),n(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),n.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){n.contains(this,t.relatedTarget)||n(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){n(this).find(".vakata-context-hover").removeClass("vakata-context-hover");n.vakata.context.settings.hide_onmouseleave&&(r=setTimeout(function(){return function(){n.vakata.context.hide()}}(this),n.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(n){n.preventDefault()}).on("mouseup","a",function(){n(this).blur().parent().hasClass("vakata-context-disabled")||n.vakata.context._execute(n(this).attr("rel"))===!1||n.vakata.context.hide()}).on("keydown","a",function(i){var r=null;switch(i.which){case 13:case 32:i.type="mouseup";i.preventDefault();n(i.currentTarget).trigger(i);break;case 37:t.is_visible&&(t.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 38:t.is_visible&&(r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),r.length||(r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),r.addClass("vakata-context-hover").children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 39:t.is_visible&&(t.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 40:t.is_visible&&(r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),r.length||(r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),r.addClass("vakata-context-hover").children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 27:n.vakata.context.hide();i.preventDefault()}}).on("keydown",function(n){n.preventDefault();var i=t.element.find(".vakata-contextmenu-shortcut-"+n.which).parent();i.parent().not(".vakata-context-disabled")&&i.mouseup()}).appendTo("body");n(document).on("mousedown",function(i){t.is_visible&&!n.contains(t.element[0],i.target)&&n.vakata.context.hide()}).on("context_show.vakata",function(){t.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");i&&t.element.addClass("vakata-context-rtl").css("direction","rtl");t.element.find("ul").hide().end()})})}($);$.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1};$.jstree.plugins.dnd=function(n,t){this.bind=function(){t.bind.call(this);this.element.on("mousedown.jstree touchstart.jstree",".jstree-anchor",$.proxy(function(n){var t=this.get_node(n.target),i=this.is_selected(t)?this.get_selected().length:1;if(t&&t.id&&t.id!=="#"&&(n.which===1||n.type==="touchstart")&&(this.settings.dnd.is_draggable===!0||$.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_selected(!0):[t])))return this.element.trigger("mousedown.jstree"),$.vakata.dnd.start(n,{jstree:!0,origin:this,obj:this.get_node(t,!0),nodes:i>1?this.get_selected():[t.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+'"><i class="jstree-icon jstree-er"><\/i>'+(i>1?i+" "+this.get_string("nodes"):this.get_text(n.currentTarget,!0))+'<ins class="jstree-copy" style="display:none;">+<\/ins><\/div>')},this))}};$(function(){var n=!1,t=!1,r=!1,i=$('<div id="jstree-marker">&#160;<\/div>').hide().appendTo("body");$(document).bind("dnd_start.vakata",function(){n=!1}).bind("dnd_move.vakata",function(u,f){if((r&&clearTimeout(r),f.data.jstree)&&(!f.event.target.id||f.event.target.id!=="jstree-marker")){var e=$.jstree.reference(f.event.target),o=!1,c=!1,y=!1,p,w,l,a,v,b,h,s,k,g,d,nt;if(e&&e._data&&e._data.dnd)if(i.attr("class","jstree-"+e.get_theme()),f.helper.children().attr("class","jstree-"+e.get_theme()).find(".jstree-copy:eq(0)")[f.data.origin&&(f.data.origin.settings.dnd.always_copy||f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey))?"show":"hide"](),(f.event.target===e.element[0]||f.event.target===e.get_container_ul()[0])&&e.get_container_ul().children().length===0){for(h=!0,s=0,k=f.data.nodes.length;s<k;s++)if(h=h&&e.check(f.data.origin&&(f.data.origin.settings.dnd.always_copy||f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey))?"copy_node":"move_node",f.data.origin&&f.data.origin!==e?f.data.origin.get_node(f.data.nodes[s]):f.data.nodes[s],"#","last",{dnd:!0,ref:e.get_node("#"),pos:"i",is_multi:f.data.origin&&f.data.origin!==e,is_foreign:!f.data.origin}),!h)break;if(h){n={ins:e,par:"#",pos:"last"};i.hide();f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok");return}}else if(o=$(f.event.target).closest("a"),o&&o.length&&o.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(c=o.offset(),y=f.event.pageY-c.top,l=o.height(),b=y<l/3?["b","i","a"]:y>l-l/3?["a","i","b"]:y>l/2?["i","a","b"]:["i","b","a"],$.each(b,function(u,y){switch(y){case"b":p=c.left-6;w=c.top-5;a=e.get_parent(o);v=o.parent().index();break;case"i":p=c.left-2;w=c.top-5+l/2+1;a=e.get_node(o.parent()).id;v=0;break;case"a":p=c.left-6;w=c.top-5+l;a=e.get_parent(o);v=o.parent().index()+1}for(h=!0,s=0,k=f.data.nodes.length;s<k;s++)if(g=f.data.origin&&(f.data.origin.settings.dnd.always_copy||f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey))?"copy_node":"move_node",d=v,g==="move_node"&&y==="a"&&f.data.origin&&f.data.origin===e&&a===e.get_parent(f.data.nodes[s])&&(nt=e.get_node(a),d>$.inArray(f.data.nodes[s],nt.children)&&(d-=1)),h=h&&(e&&e.settings&&e.settings.dnd&&e.settings.dnd.check_while_dragging===!1||e.check(g,f.data.origin&&f.data.origin!==e?f.data.origin.get_node(f.data.nodes[s]):f.data.nodes[s],a,d,{dnd:!0,ref:e.get_node(o.parent()),pos:y,is_multi:f.data.origin&&f.data.origin!==e,is_foreign:!f.data.origin})),!h){e&&e.last_error&&(t=e.last_error());break}if(h)return y==="i"&&o.parent().is(".jstree-closed")&&e.settings.dnd.open_timeout&&(r=setTimeout(function(n,t){return function(){n.open_node(t)}}(e,o),e.settings.dnd.open_timeout)),n={ins:e,par:a,pos:v},i.css({left:p+"px",top:w+"px"}).show(),f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),t={},b=!0,!1}),b===!0))return;n=!1;f.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");i.hide()}}).bind("dnd_scroll.vakata",function(t,r){r.data.jstree&&(i.hide(),n=!1,r.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er"))}).bind("dnd_stop.vakata",function(u,f){if(r&&clearTimeout(r),f.data.jstree){i.hide();var e,s,o=[];if(n){for(e=0,s=f.data.nodes.length;e<s;e++)o[e]=f.data.origin?f.data.origin.get_node(f.data.nodes[e]):f.data.nodes[e],f.data.origin&&(o[e].instance=f.data.origin);n.ins[f.data.origin&&(f.data.origin.settings.dnd.always_copy||f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey))?"copy_node":"move_node"](o,n.par,n.pos)}else e=$(f.event.target).closest(".jstree"),e.length&&t&&t.error&&t.error==="check"&&(e=e.jstree(!0),e&&e.settings.core.error.call(this,t))}}).bind("keyup keydown",function(n,t){t=$.vakata.dnd._get();t.data&&t.data.jstree&&t.helper.find(".jstree-copy:eq(0)")[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(n.metaKey||n.ctrlKey))?"show":"hide"]()})}),function(n){var t={element:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1};n.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5},_trigger:function(t,i){var r=n.vakata.dnd._get();r.event=i;n(document).triggerHandler("dnd_"+t+".vakata",r)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove();t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1);t={element:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1};n(document).off("mousemove touchmove",n.vakata.dnd.drag);n(document).off("mouseup touchend",n.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(n.vakata.dnd._scroll,100),!1;if(i===!0)return!1;var r=t.scroll_e.scrollTop(),u=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(r+t.scroll_t*n.vakata.dnd.settings.scroll_speed);t.scroll_e.scrollLeft(u+t.scroll_l*n.vakata.dnd.settings.scroll_speed);(r!==t.scroll_e.scrollTop()||u!==t.scroll_e.scrollLeft())&&n.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(i,r,u){i.type==="touchstart"&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset));t.is_drag&&n.vakata.dnd.stop({});try{i.currentTarget.unselectable="on";i.currentTarget.onselectstart=function(){return!1};i.currentTarget.style&&(i.currentTarget.style.MozUserSelect="none")}catch(f){}return t.init_x=i.pageX,t.init_y=i.pageY,t.data=r,t.is_down=!0,t.element=i.currentTarget,u!==!1&&(t.helper=n("<div id='vakata-dnd'><\/div>").html(u).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),n(document).bind("mousemove touchmove",n.vakata.dnd.drag),n(document).bind("mouseup touchend",n.vakata.dnd.stop),!1},drag:function(i){if(i.type==="touchmove"&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag)if(Math.abs(i.pageX-t.init_x)>n.vakata.dnd.settings.threshold||Math.abs(i.pageY-t.init_y)>n.vakata.dnd.settings.threshold)t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,n.vakata.dnd._trigger("start",i);else return;var r=!1,c=!1,u=!1,e=!1,f=!1,o=!1,l=!1,a=!1,s=!1,h=!1;t.scroll_t=0;t.scroll_l=0;t.scroll_e=!1;n(n(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(n(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var u=n(this),r=u.offset();return this.scrollHeight>this.offsetHeight&&(r.top+u.height()-i.pageY<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),i.pageY-r.top<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(r.left+u.width()-i.pageX<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),i.pageX-r.left<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=n(this),!1):void 0});t.scroll_e||(r=n(document),c=n(window),u=r.height(),e=c.height(),f=r.width(),o=c.width(),l=r.scrollTop(),a=r.scrollLeft(),u>e&&i.pageY-l<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),u>e&&e-(i.pageY-l)<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),f>o&&i.pageX-a<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),f>o&&o-(i.pageX-a)<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=r));t.scroll_e&&n.vakata.dnd._scroll(!0);t.helper&&(s=parseInt(i.pageY+n.vakata.dnd.settings.helper_top,10),h=parseInt(i.pageX+n.vakata.dnd.settings.helper_left,10),u&&s+25>u&&(s=u-50),f&&h+t.helper_w>f&&(h=f-(t.helper_w+2)),t.helper.css({left:h+"px",top:s+"px"}));n.vakata.dnd._trigger("move",i)}},stop:function(i){i.type==="touchend"&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset));t.is_drag&&n.vakata.dnd._trigger("stop",i);n.vakata.dnd._clean()}}}(jQuery);$.jstree.defaults.search={ajax:!1,fuzzy:!0,case_sensitive:!1,show_only_matches:!1,close_opened_onclear:!0,search_leaves_only:!1};$.jstree.plugins.search=function(n,t){this.bind=function(){t.bind.call(this);this._data.search.str="";this._data.search.dom=$();this._data.search.res=[];this._data.search.opn=[];this.element.on("before_open.jstree",$.proxy(function(){var n,f,i,r=this._data.search.res,t=[],u=$();if(r&&r.length){for(this._data.search.dom=$(),n=0,f=r.length;n<f;n++)t=t.concat(this.get_node(r[n]).parents),i=this.get_node(r[n],!0),i&&(this._data.search.dom=this._data.search.dom.add(i));for(t=$.vakata.array_unique(t),n=0,f=t.length;n<f;n++)t[n]!=="#"&&(i=this.get_node(t[n],!0),i&&(u=u.add(i)));this._data.search.dom.children(".jstree-anchor").addClass("jstree-search");this.settings.search.show_only_matches&&this._data.search.res.length&&(this.element.find("li").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),u=u.add(this._data.search.dom),u.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){$(this).children("li:visible").eq(-1).addClass("jstree-last")}))}},this));if(this.settings.search.show_only_matches)this.element.on("search.jstree",function(n,t){t.nodes.length&&($(this).find("li").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),t.nodes.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){$(this).children("li:visible").eq(-1).addClass("jstree-last")}))}).on("clear_search.jstree",function(n,t){t.nodes.length&&$(this).find("li").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")})};this.search=function(n,t){if(n===!1||$.trim(n)==="")return this.clear_search();var r=this.settings.search,i=r.ajax?r.ajax:!1,u=null,f=[],e=[],o,s;if(this._data.search.res.length&&this.clear_search(),!t&&i!==!1)return $.isFunction(i)?i.call(this,n,$.proxy(function(t){t&&t.d&&(t=t.d);this._load_nodes($.isArray(t)?t:[],function(){this.search(n,!0)})},this)):(i=$.extend({},i),i.data||(i.data={}),i.data.str=n,$.ajax(i).fail($.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(i)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done($.proxy(function(t){t&&t.d&&(t=t.d);this._load_nodes($.isArray(t)?t:[],function(){this.search(n,!0)})},this)));if(this._data.search.str=n,this._data.search.dom=$(),this._data.search.res=[],this._data.search.opn=[],u=new $.vakata.search(n,!0,{caseSensitive:r.case_sensitive,fuzzy:r.fuzzy}),$.each(this._model.data,function(n,t){t.text&&u.search(t.text).isMatch&&(!r.search_leaves_only||t.state.loaded&&t.children.length===0)&&(f.push(n),e=e.concat(t.parents))}),f.length){for(e=$.vakata.array_unique(e),this._search_open(e),o=0,s=f.length;o<s;o++)u=this.get_node(f[o],!0),u&&(this._data.search.dom=this._data.search.dom.add(u));this._data.search.res=f;this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:n,res:this._data.search.res})};this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search");this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0);this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=$()};this._search_open=function(n){var t=this;$.each(n.concat([]),function(i,r){if(r==="#")return!0;try{r=$("#"+r.replace($.jstree.idregex,"\\$&"),t.element)}catch(u){}r&&r.length&&t.is_closed(r)&&(t._data.search.opn.push(r[0].id),t.open_node(r,function(){t._search_open(n)},0))})}},function(n){n.vakata.search=function(n,t,i){i=i||{};i.fuzzy!==!1&&(i.fuzzy=!0);n=i.caseSensitive?n:n.toLowerCase();var u=i.location||0,o=i.distance||100,c=i.threshold||.6,r=n.length,s,h,f,e;return r>32&&(i.fuzzy=!1),i.fuzzy&&(s=1<<r-1,h=function(){for(var i={},t=0,t=0;t<r;t++)i[n.charAt(t)]=0;for(t=0;t<r;t++)i[n.charAt(t)]|=1<<r-t-1;return i}(),f=function(n,t){var i=n/r,f=Math.abs(u-t);return o?i+f/o:f?1:i}),e=function(t){if(t=i.caseSensitive?t:t.toLowerCase(),n===t||t.indexOf(n)!==-1)return{isMatch:!0,score:0};if(!i.fuzzy)return{isMatch:!1,score:1};var a,e,tt=t.length,v=c,o=t.indexOf(n,u),p,l,w=r+tt,b,g,k,y,nt,d=1,it=[];for(o!==-1&&(v=Math.min(f(0,o),v),o=t.lastIndexOf(n,u+r),o!==-1&&(v=Math.min(f(0,o),v))),o=-1,a=0;a<r;a++){for(p=0,l=w;p<l;)f(a,u+l)<=v?p=l:w=l,l=Math.floor((w-p)/2+p);for(w=l,g=Math.max(1,u-l+1),k=Math.min(u+l,tt)+r,y=new Array(k+2),y[k+1]=(1<<a)-1,e=k;e>=g;e--)if(nt=h[t.charAt(e-1)],y[e]=a===0?(y[e+1]<<1|1)&nt:(y[e+1]<<1|1)&nt|(b[e+1]|b[e])<<1|1|b[e+1],y[e]&s&&(d=f(a,e-1),d<=v))if(v=d,o=e-1,it.push(o),o>u)g=Math.max(1,2*u-o);else break;if(f(a+1,u)>v)break;b=y}return{isMatch:o>=0,score:d}},t===!0?{search:e}:e(t)}}(jQuery);$.jstree.defaults.sort=function(n,t){return this.get_text(n)>this.get_text(t)?1:-1};$.jstree.plugins.sort=function(n,t){this.bind=function(){t.bind.call(this);this.element.on("model.jstree",$.proxy(function(n,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",$.proxy(function(n,t){this.sort(t.parent||t.node.parent,!1);this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",$.proxy(function(n,t){this.sort(t.parent,!1);this.redraw_node(t.parent,!0)},this))};this.sort=function(n,t){var i,r;if(n=this.get_node(n),n&&n.children&&n.children.length&&(n.children.sort($.proxy(this.settings.sort,this)),t))for(i=0,r=n.children_d.length;i<r;i++)this.sort(n.children_d[i],!1)}};s=!1;$.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree",ttl:!1,filter:!1};$.jstree.plugins.state=function(n,t){this.bind=function(){t.bind.call(this);var n=$.proxy(function(){this.element.on(this.settings.state.events,$.proxy(function(){s&&clearTimeout(s);s=setTimeout($.proxy(function(){this.save_state()},this),100)},this))},this);this.element.on("ready.jstree",$.proxy(function(){this.element.one("restore_state.jstree",n);this.restore_state()||n()},this))};this.save_state=function(){var n={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};$.vakata.storage.set(this.settings.state.key,JSON.stringify(n))};this.restore_state=function(){var n=$.vakata.storage.get(this.settings.state.key);if(!!n)try{n=JSON.parse(n)}catch(t){return!1}if(!!n&&n.ttl&&n.sec&&+new Date-n.sec>n.ttl)return!1;if(!!n&&n.state&&(n=n.state),!!n&&$.isFunction(this.settings.state.filter)&&(n=this.settings.state.filter.call(this,n)),!!n){this.element.one("set_state.jstree",function(t,i){i.instance.trigger("restore_state",{state:$.extend(!0,{},n)})});return this.set_state(n),!0}return!1};this.clear_state=function(){return $.vakata.storage.del(this.settings.state.key)}},function(n){n.vakata.storage={set:function(n,t){return window.localStorage.setItem(n,t)},get:function(n){return window.localStorage.getItem(n)},del:function(n){return window.localStorage.removeItem(n)}}}(jQuery);$.jstree.defaults.types={"#":{},"default":{}};$.jstree.plugins.types=function(n,t){this.init=function(n,i){var r,u;if(i&&i.types&&i.types["default"])for(r in i.types)if(r!=="default"&&r!=="#"&&i.types.hasOwnProperty(r))for(u in i.types["default"])i.types["default"].hasOwnProperty(u)&&i.types[r][u]===undefined&&(i.types[r][u]=i.types["default"][u]);t.init.call(this,n,i);this._model.data["#"].type="#"};this.refresh=function(n){t.refresh.call(this,n);this._model.data["#"].type="#"};this.bind=function(){this.element.on("model.jstree",$.proxy(function(n,t){for(var u=this._model.data,r=t.nodes,e=this.settings.types,f="default",i=0,o=r.length;i<o;i++)f="default",u[r[i]].original&&u[r[i]].original.type&&e[u[r[i]].original.type]&&(f=u[r[i]].original.type),u[r[i]].data&&u[r[i]].data.jstree&&u[r[i]].data.jstree.type&&e[u[r[i]].data.jstree.type]&&(f=u[r[i]].data.jstree.type),u[r[i]].type=f,u[r[i]].icon===!0&&e[f].icon!==undefined&&(u[r[i]].icon=e[f].icon)},this));t.bind.call(this)};this.get_json=function(n,i,r){var f,o,e=this._model.data,s=i?$.extend(!0,{},i,{no_id:!1}):{},u=t.get_json.call(this,n,s,r);if(u===!1)return!1;if($.isArray(u))for(f=0,o=u.length;f<o;f++)u[f].type=u[f].id&&e[u[f].id]&&e[u[f].id].type?e[u[f].id].type:"default",i&&i.no_id&&(delete u[f].id,u[f].li_attr&&u[f].li_attr.id&&delete u[f].li_attr.id);else u.type=u.id&&e[u.id]&&e[u.id].type?e[u.id].type:"default",i&&i.no_id&&(u=this._delete_ids(u));return u};this._delete_ids=function(n){if($.isArray(n)){for(var t=0,i=n.length;t<i;t++)n[t]=this._delete_ids(n[t]);return n}return delete n.id,n.li_attr&&n.li_attr.id&&delete n.li_attr.id,n.children&&$.isArray(n.children)&&(n.children=this._delete_ids(n.children)),n};this.check=function(n,i,r,u,f){if(t.check.call(this,n,i,r,u,f)===!1)return!1;i=i&&i.id?i:this.get_node(i);r=r&&r.id?r:this.get_node(r);var s=i&&i.id?$.jstree.reference(i.id):null,e,o,h,c;s=s&&s._model&&s._model.data?s._model.data:null;switch(n){case"create_node":case"move_node":case"copy_node":if(n!=="move_node"||$.inArray(i.id,r.children)===-1){if(e=this.get_rules(r),e.max_children!==undefined&&e.max_children!==-1&&e.max_children===r.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+n,data:JSON.stringify({chk:n,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1;if(e.valid_children!==undefined&&e.valid_children!==-1&&$.inArray(i.type,e.valid_children)===-1)return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+n,data:JSON.stringify({chk:n,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1;if(s&&i.children_d&&i.parents){for(o=0,h=0,c=i.children_d.length;h<c;h++)o=Math.max(o,s[i.children_d[h]].parents.length);o=o-i.parents.length+1}(o<=0||o===undefined)&&(o=1);do{if(e.max_depth!==undefined&&e.max_depth!==-1&&e.max_depth<o)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+n,data:JSON.stringify({chk:n,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1;r=this.get_node(r.parent);e=this.get_rules(r);o++}while(r)}}return!0};this.get_rules=function(n){if(n=this.get_node(n),!n)return!1;var t=this.get_type(n,!0);return t.max_depth===undefined&&(t.max_depth=-1),t.max_children===undefined&&(t.max_children=-1),t.valid_children===undefined&&(t.valid_children=-1),t};this.get_type=function(n,t){return n=this.get_node(n),n?t?$.extend({type:n.type},this.settings.types[n.type]):n.type:!1};this.set_type=function(n,t){var i,r,e,u,f;if($.isArray(n)){for(n=n.slice(),r=0,e=n.length;r<e;r++)this.set_type(n[r],t);return!0}return(i=this.settings.types,n=this.get_node(n),!i[t]||!n)?!1:(u=n.type,f=this.get_icon(n),n.type=t,(f===!0||i[u]&&i[u].icon&&f===i[u].icon)&&this.set_icon(n,i[t].icon!==undefined?i[t].icon:!0),!0)}};$.jstree.plugins.unique=function(n,t){this.check=function(n,i,r,u,f){if(t.check.call(this,n,i,r,u,f)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),r=r&&r.id?r:this.get_node(r),!r||!r.children)return!0;for(var o=n==="rename_node"?u:i.text,s=[],c=this._model.data,e=0,h=r.children.length;e<h;e++)s.push(c[r.children[e]].text);switch(n){case"delete_node":return!0;case"rename_node":case"copy_node":return e=$.inArray(o,s)===-1,e||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+o+" already exists. Preventing: "+n,data:JSON.stringify({chk:n,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})}),e;case"move_node":return e=i.parent===r.id||$.inArray(o,s)===-1,e||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+o+" already exists. Preventing: "+n,data:JSON.stringify({chk:n,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})}),e}return!0}};r=document.createElement("DIV");r.setAttribute("unselectable","on");r.className="jstree-wholerow";r.innerHTML="&#160;";$.jstree.plugins.wholerow=function(n,t){this.bind=function(){t.bind.call(this);this.element.on("loading",$.proxy(function(){r.style.height=this._data.core.li_height+"px"},this)).on("ready.jstree set_state.jstree",$.proxy(function(){this.hide_dots()},this)).on("ready.jstree",$.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",$.proxy(function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",$.proxy(function(n,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var i=!1,r=0,u=t.selected.length;r<u;r++)i=this.get_node(t.selected[r],!0),i&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",$.proxy(function(n,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",$.proxy(function(n,t){this.get_node(t.node,!0).children(".jstree-wholerow")[n.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",$.proxy(function(n){n.preventDefault();var t=$.Event("contextmenu",{metaKey:n.metaKey,ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,pageX:n.pageX,pageY:n.pageY});$(n.currentTarget).closest("li").children("a:eq(0)").trigger(t)},this)).on("click.jstree",".jstree-wholerow",function(n){n.stopImmediatePropagation();var t=$.Event("click",{metaKey:n.metaKey,ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey});$(n.currentTarget).closest("li").children("a:eq(0)").trigger(t).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",$.proxy(function(n){n.stopImmediatePropagation();var t=$.Event("click",{metaKey:n.metaKey,ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey});$(n.currentTarget).closest("li").children("a:eq(0)").trigger(t).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",$.proxy(function(n){return n.stopImmediatePropagation(),this.hover_node(n.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",$.proxy(function(n){this.dehover_node(n.currentTarget)},this))};this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove();t.teardown.call(this)};this.redraw_node=function(n,i,u){if(n=t.redraw_node.call(this,n,i,u),n){var f=r.cloneNode(!0);$.inArray(n.id,this._data.core.selected)!==-1&&(f.className+=" jstree-wholerow-clicked");n.insertBefore(f,n.childNodes[0])}return n}}}});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants.widgets,t=forerunner.ssr.tools.dashboardToolbar,i=forerunner.ssr.tools.dashboardToolPane,r=forerunner.ssr.tools.groups,u=forerunner.helper;$.widget(n.getFullname(n.dashboardEZ),{options:{DefaultAppTemplate:null,navigateTo:null,historyBack:null,isFullScreen:!0,isReportManager:!1,enableEdit:!0,rsInstance:null,userSettings:null,path:null,handleWindowResize:!0,dbConfig:{},$appContainer:null},getUserSettings:function(){var n=this;return n.options.userSettings},enableEdit:function(n,t){var i=this,r;(i.options.enableEdit=n,i.$toolbar.dashboardToolbar("enableEdit",n),i.$toolpane.dashboardToolPane("enableEdit",n),t)||(r=i.getDashboardEditor(),r.dashboardEditor("openDashboard",null,n))},_create:function(){var n=this;if(n.options.handleWindowResize)$(window).on("resize",function(){u.delay(n,function(){n.windowResize.call(n)})})},windowResize:function(){var t=this,i,r;t.$dashboardContainer&&t.$dashboardContainer.is(":visible")!==!1&&(t.options.DefaultAppTemplate===null&&t.layout.windowResize.call(t.layout),i=t.getDashboardEditor(),n.hasWidget(i,n.dashboardEditor)&&i.dashboardEditor("windowResize"),r=t.getDashboardToolbar(),n.hasWidget(r,n.dashboardToolbar)&&r.dashboardToolbar("windowResize"))},_init:function(){var n=this;n._super();n.layout=n.options.DefaultAppTemplate===null?new forerunner.ssr.DefaultAppTemplate({$container:n.element,isFullScreen:n.options.isFullScreen}).render():n.options.DefaultAppTemplate;n._checkPermission(function(){var f,u;forerunner.device.allowZoom(!1);n.layout.$mainsection.html(null);n.$dashboardContainer=$("<div class='fr-dashboard'><\/div>");n.layout.$mainsection.append(n.$dashboardContainer);n.$dashboardContainer.dashboardEditor({$appContainer:n.layout.$container,navigateTo:n.options.navigateTo,historyBack:n.options.historyBack,rsInstance:n.options.rsInstance,handleWindowResize:!1});n.$toolbar=n.layout.$mainheadersection;n.$toolbar.dashboardToolbar({navigateTo:n.options.navigateTo,$appContainer:n.layout.$container,$dashboardEZ:n.element,$dashboardEditor:n.getDashboardEditor(),enableEdit:n.options.enableEdit});f=n.layout.$leftheader;f!==null&&f.leftToolbar({$appContainer:n.layout.$container});n.$toolpane=n.layout.$leftpanecontent;n.$toolpane.dashboardToolPane({navigateTo:n.options.navigateTo,$appContainer:n.layout.$container,$dashboardEZ:n.element,$dashboardEditor:n.getDashboardEditor(),enableEdit:n.options.enableEdit});n.favoriteInstance=$({}).favoriteModel({$toolbar:n.$toolbar,$toolpane:n.$toolpane,$appContainer:n.options.$appContainer,rsInstance:n.options.rsInstance});n.favoriteInstance.favoriteModel("setFavoriteState",n.options.path);n.options.isReportManager&&(u=[],forerunner.config.getCustomSettingsValue("showHomeButton","off")==="on"&&u.push(t.btnHome),n.options.dbConfig.UseMobilizerDB===!0&&(n.options.dbConfig.SeperateDB!==!0&&u.push(t.btnRecent),u.push(t.btnFavorite)),u.push(t.btnLogOff),n.$toolbar.dashboardToolbar("addTools",4,!0,u),n.$toolpane.dashboardToolPane("addTools",1,!0,[i.itemFolders,r.dashboardItemFolderGroup]),forerunner.ajax.isFormsAuth(function(i){i||n.$toolbar.dashboardToolbar("hideTool",t.btnLogOff.selectorClass)}));n.options.historyBack&&(n.$toolbar.dashboardToolbar("addTools",2,!0,[t.btnBack]),n.$toolpane.dashboardToolPane("addTools",3,!0,[i.itemBack]));n.layout.$rightheaderspacer.height(n.layout.$topdiv.height());n.layout.$leftheaderspacer.height(n.layout.$topdiv.height())})},_checkPermission:function(n){var t=this;t.permissions=forerunner.ajax.hasPermission(t.options.path,"Update Content,Update Properties",function(i){t.permissions=i;n&&n()})},getPermission:function(){var n=this;return n.permissions},getDashboardEditor:function(){var t=this,n;return t.layout&&(n=t.layout.$mainsection.find(".fr-dashboard"),n.length!==0)?n:null},getDashboardToolbar:function(){var n=this;return n.layout?n.layout.$mainheadersection:null},getDashboardToolPane:function(){var n=this;return n.layout?n.layout.$leftpanecontent:null}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};forerunner.ssr.tools=forerunner.ssr.tools||{};forerunner.ssr.tools.toolbar=forerunner.ssr.tools.dashboardToolbar||{};$(function(){var t=forerunner.ssr.constants.widgets,r=forerunner.ssr.constants.events,n=forerunner.ssr.tools.dashboardToolbar,i=forerunner.ssr.tools.mergedButtons,u=forerunner.localize;$.widget(t.getFullname(t.dashboardToolbar),$.forerunner.toolBase,{options:{navigateTo:null,$appContainer:null,$dashboardEZ:null,enableEdit:!0,toolClass:"fr-dashboard-toolbar"},enableEdit:function(t){var i=this,r,u,f;if(i.hideTool(n.btnEdit.selectorClass),i.hideTool(n.btnView.selectorClass),i._isAdmin())if(t)i.showTool(n.btnView.selectorClass);else if(r=i.options.$dashboardEZ.dashboardEZ("getDashboardEditor"),u=r.dashboardEditor("getPath"),u&&(f=i.options.$dashboardEZ.dashboardEZ("getPermission"),f["Update Content"]===!0)){i.showTool(n.btnEdit.selectorClass);return}},_isAdmin:function(){var t=this,n=t.options.$dashboardEZ.dashboardEZ("getUserSettings");return n&&n.adminUI&&n.adminUI===!0?!0:!1},_init:function(){var t=this;t._super();t.element.html("<div class='"+t.options.toolClass+" fr-core-toolbar fr-core-widget'/>");t.removeAllTools();t.addTools(1,!0,[n.btnMenu,i.btnFav,n.btnEdit,n.btnView]);t.enableEdit(t.options.enableEdit);t.windowResize()},_destroy:function(){},_create:function(){}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var i=forerunner.ssr.constants.widgets,r=forerunner.ssr.constants.events,n=forerunner.ssr.tools.dashboardToolPane,t=forerunner.ssr.tools.mergedItems,u=forerunner.localize;$.widget(i.getFullname(i.dashboardToolPane),$.forerunner.toolBase,{options:{navigateTo:null,$appContainer:null,$dashboardEZ:null,enableEdit:!0,toolClass:"fr-dashboard-toolpane"},enableEdit:function(t){var i=this,r,u,f;if(i.hideTool(n.itemEdit.selectorClass),i.hideTool(n.itemView.selectorClass),i._isAdmin())if(t)i.showTool(n.itemView.selectorClass);else if(r=i.options.$dashboardEZ.dashboardEZ("getDashboardEditor"),u=r.dashboardEditor("getPath"),u&&(f=i.options.$dashboardEZ.dashboardEZ("getPermission"),f["Update Content"]===!0)){i.showTool(n.itemEdit.selectorClass);return}},_isAdmin:function(){var t=this,n=t.options.$dashboardEZ.dashboardEZ("getUserSettings");return n&&n.adminUI&&n.adminUI===!0?!0:!1},_init:function(){var i=this,r,u;i._super();i.element.html("<div class='"+i.options.toolClass+" fr-core-widget' />");i.removeAllTools();r=[n.itemEdit,n.itemView,t.itemFav];i._isAdmin()&&r.push(t.itemProperty);i.addTools(2,!0,r);i.enableEdit(i.options.enableEdit);u=new $("<div />");u.attr("style","height:65px");i.element.append(u);i._updateBtnStates()},_updateBtnStates:function(){var n=this,i;n._isAdmin()&&(n.disableTools([t.itemProperty]),i=n.options.$dashboardEZ.dashboardEZ("getPermission"),i["Update Properties"]&&(n.enableTools([t.itemProperty]),n.removeHideDisable([t.itemProperty])))}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var t=forerunner.ssr.constants,n=t.widgets,i=t.events,r=forerunner.localize;$.widget(n.getFullname(n.dashboardViewer),{options:{$appContainer:null,navigateTo:null,historyBack:null,reportManagerAPI:forerunner.config.forerunnerAPIBase()+"ReportManager/",rsInstance:null},_create:function(){var n=this;n.model=new forerunner.ssr.DashboardModel({$appContainer:n.options.$appContainer,reportManagerAPI:n.options.reportManagerAPI,rsInstance:n.options.rsInstance});n.enableEdit=!1},_setWidths:function(n){var t=!1;return $.each(arguments,function(i,r){i>0&&r.css&&r.css("width")!==n&&(t=!0,r.css("width",n))}),t},windowResize:function(){var t=this,r=forerunner.config.getCustomSettingsValue("MaxResponsiveResolution",1280),u=forerunner.ajax.getUserSetting(t.options.rsInstance),f=u.responsiveUI&&$(window).width()<r&&!t.enableEdit,i=!1;t.element.find(".fr-dashboard-report-id").each(function(r,u){var e=$(u),o=e.css("display");f?(o!=="inline-block"&&(e.css("display","inline-block"),i=!0),i=t.element.width()<e.width()?t._setWidths(t.element.width(),e):t._setWidths("",e)):(o&&(e.css("display",""),i=!0),i=t._setWidths("",e));i&&n.hasWidget(e,n.reportViewerEZ)&&e.reportViewerEZ("windowResize")});i&&!forerunner.device.isMSIE8()&&t.element.hide().show(0)},_init:function(){var n=this;n.toolbar=r.getLocData().toolbar;n.messages=r.getLocData().messages;n.model.clearState();n.element.html("")},loadDefinition:function(n,t){var i=this,r;(i.element.html(""),!n||(r=i._loadResource(n),r))&&(i.element.html(i.model.dashboardDef.template),i.element.find(".fr-dashboard-report-id").each(function(n,r){i._loadReport(r.id,t)}))},getParentFolder:function(){var n=this;return n.parentFolder},getDashboardName:function(){var n=this;return n.dashboardName},getReportProperties:function(n){var t=this;return t.model.dashboardDef.reports[n]||(t.model.dashboardDef.reports[n]={}),t.model.dashboardDef.reports[n]},setReportProperties:function(n,t){var i=this,r=i.getReportProperties(n);$.extend(r,t)},_loadReport:function(n,r){var u=this,e=u.getReportProperties(n),f=u.element.find("#"+n),o,s,h,c;if(f.css("display",""),f.html(""),f.addClass("fr-dashboard-placeholder-size"),e&&e.catalogItem){f.reportViewerEZ({navigateTo:u.options.navigateTo,historyBack:null,isReportManager:!1,isFullScreen:!1,handleWindowResize:!1,userSettings:forerunner.ajax.getUserSetting(),toolbarConfigOption:u.enableEdit?t.toolbarConfigOption.dashboardEdit:e.toolbarConfigOption});o=f.reportViewerEZ("getReportViewer");o.one(i.reportViewerAfterLoadReport(),function(t,i){f.removeClass("fr-dashboard-placeholder-size");i.reportId=n;i.$reportViewerEZ=f;u._onAfterReportLoaded.apply(u,arguments)});u.outerToolbarHeight=u.outerToolbarHeight||u.options.$appContainer.find(".fr-layout-topdiv:first").height();o.reportViewer("option","toolbarHeight",u.outerToolbarHeight);s=e.catalogItem;h=e.parameters;o.reportViewer("loadReport",s.Path,1,h);c=f.reportViewerEZ("getReportParameter");c.one(i.reportParameterSubmit(),function(){u._onReportParameterSubmit.apply(u,arguments)})}else r&&(f.removeClass("fr-dashboard-placeholder-size"),f.css("display","none"))},_onReportParameterSubmit:function(){},_onAfterReportLoaded:function(n,t){t.$reportViewerEZ&&t.$reportViewerEZ.reportViewerEZ("windowResize")},_loadResource:function(n){var t=this;return t.dashboardName=forerunner.helper.getCurrentItemName(n),t.parentFolder=forerunner.helper.getParentPath(n),t.parentFolder||(t.parentFolder="/"),t.model.fetch(n)},_destroy:function(){}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants.widgets,r=forerunner.ssr.constants.events,t=forerunner.localize,u,f,i=forerunner.device.isWindowsPhone()?500:forerunner.device.isTouch()?50:50;$.widget(n.getFullname(n.dashboardEditor),$.forerunner.dashboardViewer,{options:{},openDashboard:function(n,t){var r=this;r.enableEdit=t;t?setTimeout(function(){r.loadDefinition(n,!1);r._showUI(!0)},i):r.loadDefinition(n,!0)},getPath:function(){var n=this;return!n.parentFolder||!n.dashboardName?null:n.parentFolder+n.dashboardName},_save:function(t){var i=this,e=i.element.find(".fr-dashboard-report-id"),r;e.each(function(t,r){var s=r.id,e=$(r),f,u,o;i._hasReport(e)&&(f=i.getReportProperties(s),f.parameters=null,u=e.reportViewerEZ("getReportParameter"),n.hasWidget(u,n.reportParameter)&&(o=u.reportParameter("getNumOfVisibleParameters"),o>0&&(f.parameters=u.reportParameter("getParamsList",!0))))});r=i.model.save(t,i.parentFolder,i.dashboardName);r.status?i.dashboardName=r.resourceName:forerunner.dialog.showMessageBox(i.options.$appContainer,f.saveDashboardFailed,u.saveDashboard)},_onReportParameterSubmit:function(){var n=this;n.enableEdit===!0&&n._save(!0)},_onAfterReportLoaded:function(n,t){var i=this;i._super(n,t);i._showUI(i.enableEdit)},_onClickProperties:function(n){var t=this,i=t.options.$appContainer.find(".fr-rp-section");if(i.length===0){i=$("<div class='fr-rp-section fr-dialog-id fr-core-dialog-layout fr-core-widget'/>");t.options.$appContainer.append(i);i.on(r.reportPropertiesClose(),function(){t._onReportPropertiesClose.apply(t,arguments)})}i.reportProperties({reportManagerAPI:t.options.reportManagerAPI,$appContainer:t.options.$appContainer,$dashboardEditor:t,reportId:n.target.name});i.reportProperties("openDialog")},_onReportPropertiesClose:function(n,t){var r=this;t.isSubmit&&setTimeout(function(){r._loadReport(t.reportId,!1);r._renderButtons();r._makeOpaque(!0);r._save(!0)},i)},_showUI:function(n){var t=this;n?t._renderButtons():t._removeButtons();t._makeOpaque(n)},_renderButtons:function(){var n=this;n._removeButtons();n.element.find(".fr-dashboard-report-id").each(function(t,i){n._renderButton(i)})},_hasReport:function(t){return n.hasWidget(t,n.reportViewerEZ)},_renderButton:function(n){var r=this,t=$(n),i,u,f;r._hasReport(t)?t.height(""):t.height("320px");i=$("<input type=button class='fr-dashboard-btn' name='"+n.id+"'/>");t.append(i);i.on("click",function(){r._onClickProperties.apply(r,arguments)});u=t.width()/2-i.width()/2;f=t.height()/2-i.height()/2;i.css({position:"absolute",left:u+"px",top:f+"px"})},_removeButtons:function(){var n=this;n.element.find(".fr-dashboard-btn").remove()},_makeOpaque:function(n){var t=this;n?t.element.find(".fr-report-container").addClass("fr-dashboard-mask"):t.element.find(".fr-report-container").removeClass("fr-dashboard-mask")},_create:function(){var n=this;n._super()},_init:function(){var n=this;n.toolbar=t.getLocData().toolbar;n.messages=t.getLocData().messages;n._super()},_destroy:function(){}})});forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{};$(function(){var n=forerunner.ssr.constants,i=n.widgets,t=n.events,r=forerunner.localize;$.widget(i.getFullname(i.reportProperties),$.forerunner.dialogBase,{options:{reportManagerAPI:null,$appContainer:null,$dashboardEditor:null,reportId:null,iconClass:"fr-rp-icon-edit"},_init:function(){var i=this,u;i.reportProperties=r.getLocData().reportProperties;i._super();i.options.title||(i.options.title=i.reportProperties.title);i.$form.addClass("fr-rp-form");u=$("<input name='add' type='button' value='"+i.reportProperties.removeReport+"' title='"+i.reportProperties.removeReport+"' class='fr-rp-remove-report-id fr-rp-action-button fr-core-dialog-button'/><div class='fr-rp-dropdown-container'><input type='text' class='fr-rp-report-input-id fr-rp-text-input fr-core-input fr-core-cursorpointer' autofocus='autofocus' readonly='readonly' allowblank='false' nullable='false'/><span class='fr-dlb-error-span'/><div class='fr-rp-dropdown-iconcontainer fr-core-cursorpointer'><div class='fr-rp-dropdown-icon'><\/div><\/div><\/div><table><tr><td><h3><label class='fr-rp-label fr-rp-section-separator'>"+i.reportProperties.toolbar+"<\/label><\/h3><\/td><\/tr><td><label class='fr-rp-label fr-rp-separator'>"+i.reportProperties.hideToolbar+"<\/label><input class='fr-rp-hide-toolbar-id fr-rp-checkbox' name='hideToolbar' type='checkbox'/><\/td><td><label class='fr-rp-label fr-rp-separator'>"+i.reportProperties.minimal+"<\/label><input class='fr-rp-minimal-toolbar-id fr-rp-checkbox' name='hideToolbar' type='checkbox'/><\/td><td><label class='fr-rp-label fr-rp-separator'>"+i.reportProperties.full+"<\/label><input class='fr-rp-full-toolbar-id fr-rp-checkbox' name='hideToolbar' type='checkbox'/><\/td><tr><\/table>");i.$formMain.html("");i.$formMain.append(u);i.$removeReport=i.element.find(".fr-rp-remove-report-id");i.$removeReport.off("click");i.$removeReport.on("click",function(){i._onRemoveReport.apply(i,arguments)});i.$hideToolbar=i.element.find(".fr-rp-hide-toolbar-id");i.$hideToolbar.off("change");i.$hideToolbar.on("change",function(){i._onChangeToolbarOption.apply(i,arguments)});i.$minimalToolbar=i.element.find(".fr-rp-minimal-toolbar-id");i.$minimalToolbar.off("change");i.$minimalToolbar.on("change",function(){i._onChangeToolbarOption.apply(i,arguments)});i.$fullToolbar=i.element.find(".fr-rp-full-toolbar-id");i.$fullToolbar.off("change");i.$fullToolbar.on("change",function(){i._onChangeToolbarOption.apply(i,arguments)});i.$dropdown=i.element.find(".fr-rp-dropdown-container");i.$dropdown.find(".fr-rp-dropdown-icon").off("click");i.$dropdown.find(".fr-rp-dropdown-icon").on("click",function(){i._onClickTreeDropdown.apply(i,arguments)});i.$reportInput=i.element.find(".fr-rp-report-input-id");i.$reportInput.watermark(i.reportProperties.selectReport,forerunner.config.getWatermarkConfig());i.$reportInput.off("click");i.$reportInput.on("click",function(){i._onClickTreeDropdown.apply(i,arguments)});i.properties=i.options.$dashboardEditor.getReportProperties(i.options.reportId)||{};i.properties.catalogItem&&i.properties.catalogItem.Name?i.$reportInput.val(i.properties.catalogItem.Name):i.$reportInput.val("");i._setCheckbox(!1,i.$hideToolbar);i._setCheckbox(!1,i.$minimalToolbar);i._setCheckbox(!1,i.$fullToolbar);i.properties.toolbarConfigOption?i.properties.toolbarConfigOption===n.toolbarConfigOption.hide?i._setCheckbox(!0,i.$hideToolbar):i.properties.toolbarConfigOption===n.toolbarConfigOption.minimal?i._setCheckbox(!0,i.$minimalToolbar):i._setCheckbox(!0,i.$fullToolbar):i._setCheckbox(!0,i.$hideToolbar);i.$reportInput.catalogTree({rootPath:"/",type:"fullCatalog",allowFolderSelection:!1,$appContainer:i.options.$appContainer,reportManagerAPI:i.options.reportManagerAPI,containerClass:"fr-rp-popup-container",catalogTreeClass:"fr-report-tree-id fr-rp-tree-container"});i.showLoadingIndictator();i.$reportInput.off(t.catalogTreeGetCatalogComplete());i.$reportInput.on(t.catalogTreeGetCatalogComplete(),function(){i.removeLoadingIndicator()});i.$reportInput.off(t.catalogTreeCatalogSelected());i.$reportInput.on(t.catalogTreeCatalogSelected(),function(n,t){var r=t.path;t.item.Type===forerunner.ssr.constants.itemType.report&&(i.$reportInput.attr("title",r).val(r).valid(),i.properties.catalogItem=t.item,i.properties.parameters=null)});i._validateForm(i.$form)},_onRemoveReport:function(){var n=this;n.$reportInput.val("");n.properties.catalogItem=null},_onChangeToolbarOption:function(n){var t=this;t.$hideToolbar.prop("checked",!1);t.$minimalToolbar.prop("checked",!1);t.$fullToolbar.prop("checked",!1);$(n.target).prop("checked",!0)},_onClickTreeDropdown:function(){var n=this,t=n.$dropdown.width()-2;n.$reportInput.catalogTree("toggleCatalog",t)},_setCheckbox:function(n,t){n===!0?t.prop("checked",!0):t.prop("checked",!1)},_triggerClose:function(n){var i=this,r={reportId:i.options.reportId,isSubmit:n};i._trigger(t.close,null,r)},_submit:function(){var t=this;t.$form.valid()===!0&&(t.properties.toolbarConfigOption=n.toolbarConfigOption.hide,t.$minimalToolbar.prop("checked")?t.properties.toolbarConfigOption=n.toolbarConfigOption.minimal:t.$fullToolbar.prop("checked")&&(t.properties.toolbarConfigOption=n.toolbarConfigOption.full),t.options.$dashboardEditor.setReportProperties(t.options.reportId,t.properties),t._triggerClose(!0),forerunner.dialog.closeModalDialog(t.options.$appContainer,t))},closeDialog:function(){var n=this;n._triggerClose(!1);forerunner.dialog.closeModalDialog(n.options.$appContainer,n)}})});
/*
//# sourceMappingURL=Forerunner-widgets.min.js.map
*/