var forerunner=forerunner||{};forerunner.ssr=forerunner.ssr||{},$(function(){function n(n,t,i,r,u,f,e){this.RS=n,this.CurrObj=t,this.CurrObjIndex=i,this.CurrObjParent=r,this.$HTMLParent=u,this.Style=f,this.CurrLocation=e}function i(){this.ReportItems={},this.Height=0,this.LowestIndex=null}function r(n,t){this.Height=n,this.Width=t}function u(n){this.TopDelta=0,this.Height=0,this.Index=n,this.IndexAbove=null,this.NewHeight=null,this.NewTop=null}function f(n,t,i){this.$tablix=n,this.$rowHeader=t,this.$colHeader=i}var t=forerunner.ssr.constants.widgets;$.widget(t.getFullname(t.reportRender),{options:{reportViewer:null},_create:function(){},render:function(t){var i=this,r=i.element,u=i.options.reportViewer;i._writeExportPanel(),r.attr("Style",i._getStyle(u,t.ReportContainer.Report.PageContent.PageStyle)),$.each(t.ReportContainer.Report.PageContent.Sections,function(f,e){i._writeSection(new n(u,e,f,t.ReportContainer.Report.PageContent,r,""))})},writeError:function(n){var i=this,r=i.options.reportViewer.locData.errorTag,t;if(i.element.html($("<div class='fr-render-error-message'><\/div><div class='fr-render-error-details'>"+r.moreDetail+"<\/div><div class='fr-render-error'><h3>"+r.serverError+"<\/h3><div class='fr-render-error fr-render-error-type'><\/div><div class='fr-render-error fr-render-error-targetsite'><\/div><div class='fr-render-error fr-render-error-source'><\/div><div class='fr-render-error fr-render-error-stacktrace'><\/div><\/div>")),i.options.reportViewer){t=i.element.find(".fr-render-error"),t.hide(),t=i.element.find(".fr-render-error-details");t.on("click",{$Detail:i.element.find(".fr-render-error")},function(n){n.data.$Detail.show(),$(n.target).hide()});t=i.element.find(".fr-render-error-type"),t.append("<h4>"+r.type+":<\/h4>"+n.Exception.Type),t=i.element.find(".fr-render-error-targetsite"),t.html("<h4>"+r.targetSite+":<\/h4>"+n.Exception.TargetSite),t=i.element.find(".fr-render-error-source"),t.html("<h4>"+r.source+":<\/h4>"+n.Exception.Source),t=i.element.find(".fr-render-error-message"),t.html("<h4>"+r.message+":<\/h4>"+n.Exception.Message),t=i.element.find(".fr-render-error-stacktrace"),t.html("<h4>"+r.stackTrace+":<\/h4>"+n.Exception.StackTrace)}},_writeSection:function(t){var i=this,r=i._getDefaultHTMLTable(),s=$("<TR/>"),v=i._getMeasurmentsObj(t.CurrObjParent,t.CurrObjIndex),u,f,e,h,c,o,l,a;t.CurrObj.PageFooter?(f=t.CurrObj.Columns.length,u=f+1):u=t.CurrObj.Columns.length,t.CurrObj.PageHeader&&(e=$("<TR/>"),h=$("<TD/>"),e.append(h),c=i._getMeasurmentsObj(t.CurrObj,u),e.attr("Style","width:"+c.Width+"mm;"),h.append(i._writeRectangle(new n(t.RS,t.CurrObj.PageHeader,u,t.CurrObj,new $("<DIV/>"),null,c))),r.append(e)),s.attr("Style","width:"+v.Width+"mm;"),r.append(s),$.each(t.CurrObj.Columns,function(r,u){var f=new $("<TD/>");f.append(i._writeRectangle(new n(t.RS,u,r,t.CurrObj,new $("<Div/>"),null,v))),s.append(f)}),t.CurrObj.PageFooter&&(o=$("<TR/>"),l=$("<TD/>"),o.append(l),a=i._getMeasurmentsObj(t.CurrObj,f),o.attr("Style","width:"+a.Width+"mm;"),l.append(i._writeRectangle(new n(t.RS,t.CurrObj.PageFooter,f,t.CurrObj,new $("<DIV/>"),"",a))),r.append(o)),t.$HTMLParent.append(r)},_writeRectangle:function(t){var o,e,u,i,r,f=this,s;return u=t.CurrObj.Measurement.Measurements,i=f._getRectangleLayout(u),$.each(t.CurrObj.ReportItems,function(s,h){r="",h.Type!=="Line"&&(r="display:table;border-collapse:collapse;"+f._getFullBorderStyle(h)),o=f._writeReportItems(new n(t.RS,h,s,t.CurrObj,new $("<Div/>"),r,u[s])),e=new $("<Div/>"),e.append(o),r="",i.ReportItems[s].NewHeight=h.Type==="Image"||h.Type==="Chart"||h.Type==="Gauge"||h.Type==="Map"||h.Type==="Line"?u[s].Height:f._getHeight(o),i.ReportItems[s].NewTop=i.ReportItems[s].IndexAbove===null?u[s].Top:parseFloat(i.ReportItems[i.ReportItems[s].IndexAbove].NewTop)+parseFloat(i.ReportItems[i.ReportItems[s].IndexAbove].NewHeight)+parseFloat(i.ReportItems[s].TopDelta),r+="position:absolute;top:"+i.ReportItems[s].NewTop+"mm;left:"+u[s].Left+"mm;",t.CurrObj.ReportItems[s].Element&&t.CurrObj.ReportItems[s].Elements.SharedElements.Style&&t.CurrObj.ReportItems[s].Elements.SharedElements.Style.BackgroundColor?r+="background-color:"+t.CurrObj.ReportItems[s].Elements.SharedElements.Style.BackgroundColor+";":t.CurrObj.ReportItems[s].Element&&t.CurrObj.ReportItems[s].Elements.NonSharedElements.Style&&t.CurrObj.ReportItems[s].Elements.NonSharedElements.Style.BackgroundColor&&(r+="background-color:"+t.CurrObj.ReportItems[s].Elements.NonSharedElements.Style.BackgroundColor+";"),e.attr("Style",r),e.append(o),t.$HTMLParent.append(e)}),r="position:relative;"+f._getElementsStyle(t.RS,t.CurrObj.Elements),r+=f._getFullBorderStyle(t.CurrObj),t.CurrLocation&&(r+="width:"+t.CurrLocation.Width+"mm;",t.CurrObj.ReportItems.length===0?r+="height:"+t.CurrLocation.Height+"mm;":(s=parseFloat(i.ReportItems[i.LowestIndex].NewTop)+parseFloat(i.ReportItems[i.LowestIndex].NewHeight)+(parseFloat(t.CurrLocation.Height)-(parseFloat(u[i.LowestIndex].Top)+parseFloat(u[i.LowestIndex].Height))),r+="height:"+s+"mm;")),t.$HTMLParent.attr("Style",r),t.$HTMLParent},_getRectangleLayout:function(n){var t=new i,r=this;return $.each(n,function(i,f){var e,o,s;for(t.ReportItems[i]=new u(i),e=t.ReportItems[i],r.isNull(t.LowestIndex)?t.LowestIndex=i:f.Top+f.Height>n[t.LowestIndex].Top+n[t.LowestIndex].Height&&(t.LowestIndex=i),o=0;o<n.length;o++)s=n[o].Top+n[o].Height,f.Top>s&&(e.IndexAbove?s>n[e.IndexAbove].Top+n[e.IndexAbove].Height&&(e.IndexAbove=o,e.TopDelta=f.Top-s):(e.IndexAbove=o,e.TopDelta=f.Top-s))}),t},_writeReportItems:function(n){var t=this;switch(n.CurrObj.Type){case"RichTextBox":return t._writeRichText(n);case"Image":case"Chart":case"Gauge":case"Map":return t._writeImage(n);case"Tablix":return t._writeTablix(n);case"Rectangle":return t._writeRectangle(n);case"SubReport":return t._writeSubreport(n);case"Line":return t._writeLine(n)}},_writeRichText:function(n){var u=n.Style,f=$("<div/>"),i=null,t=this,r,o,s;if(u+="display:table;",t._getMeasurements(t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),!0)!==""&&(u+=t._getMeasurements(t._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),!0)),u+=t._getElementsNonTextStyle(n.RS,n.CurrObj.Elements),n.$HTMLParent.attr("Style",u),n.CurrObj.Elements.SharedElements.IsToggleParent===!0||n.CurrObj.Elements.NonSharedElements.IsToggleParent===!0){r=$("<div/>"),r.attr("id",n.CurrObj.Elements.NonSharedElements.UniqueName),r.html("&nbsp"),n.CurrObj.Elements.NonSharedElements.ToggleState!==undefined&&n.CurrObj.Elements.NonSharedElements.ToggleState===!0?r.addClass("fr-render-drilldown-collapse"):r.addClass("fr-render-drilldown-expand");r.on("click",{ToggleID:n.CurrObj.Elements.NonSharedElements.UniqueName},function(n){t.options.reportViewer.toggleItem(n.data.ToggleID)});r.addClass("fr-core-cursorpointer"),n.$HTMLParent.append(r)}if(n.CurrObj.Elements.SharedElements.CanSort!==undefined){i=$("<div/>"),i.html("&nbsp"),o="None",s=forerunner.ssr.constants.sortDirection,n.CurrObj.Elements.NonSharedElements.SortState===2?(i.attr("class","fr-render-sort-descending"),o=s.desc):n.CurrObj.Elements.NonSharedElements.SortState===1?(i.attr("class","fr-render-sort-ascending"),o=s.asc):i.attr("class","fr-render-sort-unsorted");i.on("click",{Viewer:n.RS,SortID:n.CurrObj.Elements.NonSharedElements.UniqueName,Direction:o},function(n){n.data.Viewer.sort(n.data.Direction,n.data.SortID)});n.$HTMLParent.append(i)}if(t._writeActions(n,n.CurrObj.Elements.NonSharedElements,f),u="display: table-cell;white-space:pre-wrap;word-break:break-word;word-wrap:break-word;",u+=t._getElementsTextStyle(n.CurrObj.Elements),f.attr("Style",u),n.CurrObj.Paragraphs.length===0)n.CurrObj.Elements.SharedElements.Value?f.html(n.CurrObj.Elements.SharedElements.Value):n.CurrObj.Elements.NonSharedElements.Value?f.html(n.CurrObj.Elements.NonSharedElements.Value):f.html("&nbsp");else{var h=null,c={},e={};e.Root="",$.each(n.CurrObj.Paragraphs,function(n,t){h===null&&(h=t.Paragraph.SharedElements.ListLevel),e[t.Paragraph.SharedElements.ListLevel]||(e[t.Paragraph.SharedElements.ListLevel]=[]),c[t.Paragraph.SharedElements.ListLevel]=t.Paragraph.NonSharedElements.UniqueName;var i;i=c[t.Paragraph.SharedElements.ListLevel-1]?c[t.Paragraph.SharedElements.ListLevel-1]:"Root",i={Parent:i,Value:t},e[t.Paragraph.SharedElements.ListLevel].push(i)}),t._writeRichTextItem(n,e,h,"Root",f)}return t._writeBookMark(n),n.$HTMLParent.append(f),i&&n.$HTMLParent.append(i),n.$HTMLParent},_writeRichTextItem:function(n,t,i,r,u){var f=null,e=this;$.each(t[i],function(o,s){var l,a,h,c,y,v;if(s.Parent===r){for(s=s.Value,s.Paragraph.SharedElements.ListStyle===1?(f&&f.is("ol")||(f=new $("<OL />")),f.addClass(e._getListStyle(1,s.Paragraph.SharedElements.ListLevel)),l=new $("<LI />")):s.Paragraph.SharedElements.ListStyle===2?(f&&f.is("ul")||(f=new $("<UL />")),f.addClass(e._getListStyle(2,s.Paragraph.SharedElements.ListLevel)),l=new $("<LI />")):(f&&f.is("div")||(f=new $("<DIV />")),l=new $("<DIV />")),a="",a+=e._getMeasurements(e._getMeasurmentsObj(s,i)),a+=e._getElementsStyle(n.RS,s.Paragraph),l.attr("Style",a),l.attr("name",s.Paragraph.NonSharedElements.UniqueName),h=0;h<s.TextRunCount;h++)y=!0,s.TextRuns[h].Elements.NonSharedElements.ActionInfo?(c=new $("<A />"),e._writeActions(n,s.TextRuns[h].Elements.NonSharedElements,c)):c=new $("<SPAN />"),s.TextRuns[h].Elements.SharedElements.Value&&s.TextRuns[h].Elements.SharedElements.Value!==""?c.html(s.TextRuns[h].Elements.SharedElements.Value):s.TextRuns[h].Elements.NonSharedElements.Value&&s.TextRuns[h].Elements.NonSharedElements.Value!==""?c.html(s.TextRuns[h].Elements.NonSharedElements.Value):(c.html("&nbsp"),y=!1),c.attr("Name",s.TextRuns[h].Elements.NonSharedElements.UniqueName),y&&(v="",v+=e._getMeasurements(e._getMeasurmentsObj(s.TextRuns[h],h)),v+=e._getElementsStyle(n.RS,s.TextRuns[h].Elements),c.attr("Style",v)),l.append(c);t[i+1]&&e._writeRichTextItem(n,t,i+1,s.Paragraph.NonSharedElements.UniqueName,l),f.append(l),u.append(f)}})},_getImageURL:function(n,t){var i=this,r=i.options.reportViewer.options.reportViewerAPI+"/GetImage/?";return r+="ReportServerURL="+i.options.reportViewer.options.reportServerURL,r+="&SessionID="+i.options.reportViewer.sessionID,r+("&ImageID="+t)},_writeImage:function(n){var t=new Image,i=this,r=n.Style+"display:block;max-height:100%;max-width:100%;"+i._getElementsStyle(n.RS,n.CurrObj.Elements),u,f;return r+=i._getMeasurements(i._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),!0),r+="overflow:hidden;",f=n.CurrObj.Elements.SharedElements.Sizing,u=n.CurrObj.Type==="Image"?n.CurrObj.Elements.NonSharedElements.ImageDataProperties.ImageName:n.CurrObj.Elements.NonSharedElements.StreamName,n.CurrObj.Elements.NonSharedElements.ActionImageMapAreas&&(t.useMap="#Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName),t.onload=function(){i._writeActionImageMapAreas(n,$(t).width(),$(t).height());var r=i._getNatural(this);i._resizeImage(this,f,r.height,r.width,n.CurrLocation.Height,n.CurrLocation.Width)},t.alt=i.options.reportViewer.locData.messages.imageNotDisplay,$(t).attr("style","display:block;"),t.src=this._getImageURL(n.RS,u),this._writeActions(n,n.CurrObj.Elements.NonSharedElements,$(t)),this._writeBookMark(n),n.$HTMLParent.attr("style",r),n.$HTMLParent.append(t),n.$HTMLParent},_writeActions:function(n,t,i){if(t.ActionInfo)for(var r=0;r<t.ActionInfo.Count;r++)this._writeAction(n,t.ActionInfo.Actions[r],i)},_writeAction:function(n,t,i){var r=this;if(t.HyperLink)i.attr("href",t.HyperLink);else if(t.BookmarkLink){i.attr("href","#"),i.addClass("fr-core-cursorpointer");i.on("click",{BookmarkID:t.BookmarkLink},function(n){r._stopDefaultEvent(n),r.options.reportViewer.navigateBookmark(n.data.BookmarkID)})}else{i.addClass("fr-core-cursorpointer"),i.attr("href","#");i.on("click",{DrillthroughId:t.DrillthroughId},function(n){r._stopDefaultEvent(n),r.options.reportViewer.navigateDrillthrough(n.data.DrillthroughId)})}},_writeActionImageMapAreas:function(n,t,i){var l=n.CurrObj.Elements.NonSharedElements.ActionImageMapAreas,v=v,s,h,r,u,f,c,o,a,e;if(l){for(s=$("<MAP/>"),s.attr("name","Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName),s.attr("id","Map_"+n.RS.sessionID+"_"+n.CurrObj.Elements.NonSharedElements.UniqueName),h=0;h<l.Count;h++)for(r=l.ActionInfoWithMaps[h],u=0;u<r.ImageMapAreas.Count;u++){f=$("<AREA />"),f.attr("tabindex",h+1),f.attr("style","text-decoration:none"),f.attr("alt",r.ImageMapAreas.ImageMapArea[u].Tooltip),r.Actions&&this._writeAction(n,r.Actions[0],f),o="";switch(r.ImageMapAreas.ImageMapArea[u].ShapeType){case 0:c="rect",o=parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[0]*t/100,10)+","+parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[1]*i/100,10)+","+parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[2]*t/100,10)+","+parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[3]*i/100,10);break;case 1:for(c="poly",a=r.ImageMapAreas.ImageMapArea[u].CoorCount,e=0;e<a;e++)o+=e%2==0?parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[e]*t/100,10):parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[e]*i/100,10),e<a-1&&(o+=",");break;case 2:c="circ",o=parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[0]*t/100,10)+","+parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[1]*i/100,10)+","+parseInt(r.ImageMapAreas.ImageMapArea[u].Coordinates[2]*t/100,10)}f.attr("shape",c),f.attr("coords",o),s.append(f)}n.$HTMLParent.append(s)}},_resizeImage:function(n,t,i,r,u,f){var e=0,o=this,s;if(i=o._convertToMM(i+"px"),r=o._convertToMM(r+"px"),i!==0&&r!==0)switch(t){case 0:$(n).css("height",i+"mm"),$(n).css("width",r+"mm");break;case 1:$(n).css("height",u+"mm"),$(n).css("width",f+"mm");break;case 2:(i/u>1||r/f>1)&&(i/u>=r/f?(e=u/i,$(n).css("height",u+"mm"),$(n).css("width",r*e+"mm"),$(n).css("max-height",u+"mm"),$(n).css("max-width",r*e+"mm"),$(n).css("min-height",u+"mm"),$(n).css("min-width",r*e+"mm")):(e=f/r,$(n).css("width",f+"mm"),$(n).css("height",i*e+"mm"),$(n).css("max-width",f+"mm"),$(n).css("max-height",i*e+"mm"),$(n).css("min-width",f+"mm"),$(n).css("min-height",i*e+"mm")));break;case 3:s=o._getNatural(n),$(n).css("height",o._convertToMM(s.height+"px")+"mm"),$(n).css("width",o._convertToMM(s.width+"px")+"mm"),$(n).css("max-height",o._convertToMM(s.height+"px")+"mm"),$(n).css("max-width",o._convertToMM(s.width+"px")+"mm")}},_writeBookMark:function(n){var t=$("<a/>");n.CurrObj.Elements.SharedElements.Bookmark?(t.attr("name",n.CurrObj.Elements.SharedElements.Bookmark),t.attr("id",n.CurrObj.Elements.SharedElements.Bookmark)):n.CurrObj.Elements.NonSharedElements.Bookmark&&(t.attr("name",n.CurrObj.Elements.NonSharedElements.Bookmark),t.attr("id",n.CurrObj.Elements.NonSharedElements.Bookmark)),t.attr("id")&&n.$HTMLParent.append(t)},_writeTablixCell:function(t,i,u,f){var o=new $("<TD/>"),e="",s,h,c=this,l,a;return e="vertical-align:top;padding:0;margin:0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-ms-box-sizing: border-box;",e+=c._getFullBorderStyle(i.Cell.ReportItem),l=i.ColumnIndex,a=c.isNull(f)?i.RowIndex:f,s=t.CurrObj.ColumnWidths.Columns[l].Width,h=t.CurrObj.RowHeights.Rows[a].Height,e+="overflow:hidden;width:"+s+"mm;max-width:"+s+"mm;height:"+h+"mm;",i.RowSpan!==undefined&&o.attr("rowspan",i.RowSpan),i.ColSpan!==undefined&&o.attr("colspan",i.ColSpan),i.Cell.ReportItem.Elements.SharedElements.Style&&i.Cell.ReportItem.Elements.SharedElements.Style.BackgroundColor?e+="background-color:"+i.Cell.ReportItem.Elements.SharedElements.Style.BackgroundColor+";":i.Cell.ReportItem.Elements.NonSharedElements.Style&&i.Cell.ReportItem.Elements.NonSharedElements.Style.BackgroundColor&&(e+="background-color:"+i.Cell.ReportItem.Elements.NonSharedElements.Style.BackgroundColor+";"),o.attr("Style",e),o.append(c._writeReportItems(new n(t.RS,i.Cell.ReportItem,u,t.CurrObj,new $("<Div/>"),"margin:0;overflow:hidden;width:100%;height:100%;",new r(h,s)))),o},_writeTablix:function(n){var r=this,o=r._getDefaultHTMLTable(),s="border-collapse:collapse;padding:0;margin:0;",t,c=0,e=new $("<DIV/>").css({display:"table",position:"absolute",top:"0px",left:"0px",padding:"0",margin:"0","border-collapse":"collapse"}),i=new $("<TABLE/>").css({position:"absolute",top:"0px",left:"0px",padding:"0",margin:"0","border-collapse":"collapse"}),u;i.attr("CELLSPACING",0),i.attr("CELLPADDING",0);var h="",l=!1,a=!1;return s+=r._getMeasurements(r._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex)),s+=r._getElementsStyle(n.RS,n.CurrObj.Elements),o.attr("Style",s),t=new $("<TR/>"),$.each(n.CurrObj.TablixRows,function(u,f){f.RowIndex!==c&&(o.append(t),n.CurrObj.RowHeights.Rows[f.RowIndex-1].FixRows===1&&e.append(t.clone(!0,!0)),t=new $("<TR/>"),c=f.RowIndex),f.Type!=="Corner"&&h==="Corner"&&i.append(t.clone(!0,!0)),f.Type!=="RowHeader"&&h==="RowHeader"&&i.append(t.clone(!0,!0)),n.CurrObj.RowHeights.Rows[f.RowIndex].FixRows===1&&(l=!0),f.Type!=="BodyRow"&&n.CurrObj.ColumnWidths.Columns[f.ColumnIndex].FixColumn===1&&(a=!0),f.Type==="BodyRow"?$.each(f.Cells,function(i,u){t.append(r._writeTablixCell(n,u,i,f.RowIndex))}):f.Cell&&t.append(r._writeTablixCell(n,f,u)),h=f.Type}),o.append(t),l?e.hide():e=null,a?i.hide():i=null,u=$("<div style='position:relative'><\/div"),u.append(e),u.append(i),u.append(o),n.RS.floatingHeaders.push(new f(u,e,i)),u},_writeSubreport:function(n){var t=this;return n.Style+=t._getElementsStyle(n.RS,n.CurrObj.SubReportProperties),n.CurrObj=n.CurrObj.BodyElements,t._writeRectangle(n)},_writeLine:function(n){var u=this,t=u._getMeasurmentsObj(n.CurrObjParent,n.CurrObjIndex),e="position:relative;width:"+t.Width+"mm;height:"+t.Height+"mm;",r;if(t.Width===0||t.Height===0)e+=u._getFullBorderStyle(n.CurrObj);else{var o=$("<Div/>"),f=Math.sqrt(Math.pow(t.Height,2)+Math.pow(t.Width,2)),i=Math.atan(t.Height/t.Width),s=f/2*Math.sin(i),h=f/2-Math.sqrt(Math.pow(f/2,2)+Math.pow(s,2));n.CurrObj.Elements.SharedElements.Slant===undefined||n.CurrObj.Elements.SharedElements.Slant===0||(i=i-2*i),r="position:absolute;top:"+s+"mm;left:"+h+"mm;",r+=u._getFullBorderStyle(n.CurrObj),r+="width:"+f+"mm;height:0;",r+="-moz-transform: rotate("+i+"rad);",r+="-webkit-transform: rotate("+i+"rad);",r+="-ms-transform: rotate("+i+"rad);",r+="transform: rotate("+i+"rad);",o.attr("Style",r),n.$HTMLParent.append(o)}return u._writeBookMark(n),n.$HTMLParent.attr("Style",e+n.Style),n.$HTMLParent},_writeExportPanel:function(){var r=this,i=$("<div class='fr-render-export-panel'><\/div>"),t=r.options.reportViewer.locData.exportType,n=[];n.push({Name:t.xml,Type:"XML"}),n.push({Name:t.csv,Type:"CSV"}),n.push({Name:t.pdf,Type:"PDF"}),n.push({Name:t.mhtml,Type:"MHTML"}),n.push({Name:t.excel,Type:"EXCELOPENXML"}),n.push({Name:t.tiff,Type:"IMAGE"}),n.push({Name:t.word,Type:"WORDOPENXML"}),$.each(n,function(n,t){i.append(r._getExportItem(t))});$(document).on("click",function(n){$(n.target).hasClass("fr-render-export-panel")||$(n.target).hasClass("fr-button-export")||!i.is(":visible")||i.toggle()});$(".fr-button-export").filter(":visible").append(i)},_getExportItem:function(n){var r=this,t=$("<div class='fr-render-export-item'><\/div>"),i;t.hover(function(){t.addClass("fr-render-export-hover")},function(){t.removeClass("fr-render-export-hover")}),i=$("<a class='fr-render-export-link' value='"+n.Type+"' href='javascript:void(0)'>"+n.Name+"<\/a>");i.on("click",function(){r.options.reportViewer.exportReport(n.Type)});return t.append(i),t},_getHeight:function(n){var r=this,i,t=n.clone().css({visibility:"hidden"});return t.find("img").remove(),$("body").append(t),i=t.height()+"px",t.remove(),r._convertToMM(i)},_getElementsStyle:function(n,t){var i="",r=this;return i+=r._getStyle(n,t.SharedElements.Style,t.NonSharedElements),i+r._getStyle(n,t.NonSharedElements.Style,t.NonSharedElements)},_getElementsTextStyle:function(n){var t="",i=this;return t+=i._getTextStyle(n.SharedElements.Style,n.NonSharedElements),t+i._getTextStyle(n.NonSharedElements.Style,n.NonSharedElements)},_getElementsNonTextStyle:function(n,t){var i="",r=this;return i+=r._getNonTextStyle(n,t.SharedElements.Style,t.NonSharedElements),i+r._getNonTextStyle(n,t.NonSharedElements.Style,t.NonSharedElements)},_getBorderSize:function(n,t){var o=this,i,f,r,e,u;return(i=n.Elements.SharedElements.Style,i?(f=i.BorderStyle,r=i["BorderStyle"+t],e=i.BorderWidth,u=i["BorderWidth"+t]):(i=n.Elements.NonSharedElements.Style,i&&(f=i.BorderStyle,r=i["BorderStyle"+t],e=i.BorderWidth,u=i["BorderWidth"+t])),!r&&f===0)?0:r===0?0:u?o._convertToMM(u):o._convertToMM(e)},_getPaddingSize:function(n,t){var u=this,i,r;return i=n.Elements.SharedElements.Style,i?r=i["Padding"+t]:(i=n.Elements.NonSharedElements.Style,i&&(r=i["Padding"+t])),u._convertToMM(r)},_getFullBorderStyle:function(n){var i=this,r="",t;return n.Elements?(t=n.Elements.SharedElements.Style,t!==undefined&&(t.BorderStyle!==undefined&&(r+="border:"+t.BorderWidth+" "+i._getBorderStyle(t.BorderStyle)+" "+t.BorderColor+";"),(t.BorderStyleLeft!==undefined||t.BorderWidthLeft!==undefined||t.BorderColorLeft!==undefined)&&(r+="border-left:"+(t.BorderWidthLeft===undefined?t.BorderWidth:t.BorderWidthLeft)+" "+(t.BorderStyleLeft===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleLeft))+" "+(t.BorderColorLeft===undefined?t.BorderColor:t.BorderColorLeft)+";"),(t.BorderStyleRight!==undefined||t.BorderWidthRight!==undefined||t.BorderColorRight!==undefined)&&(r+="border-right:"+(t.BorderWidthRight===undefined?t.BorderWidth:t.BorderWidthRight)+" "+(t.BorderStyleRight===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleRight))+" "+(t.BorderColorRight===undefined?t.BorderColr:t.BorderColorRight)+";"),(t.BorderStyleTop!==undefined||t.BorderWidthTop!==undefined||t.BorderColorTop!==undefined)&&(r+="border-top:"+(t.BorderWidthTop===undefined?t.BorderWidth:t.BorderWidthTop)+" "+(t.BorderStyleTop===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleTop))+" "+(t.BorderColorTop===undefined?t.BorderColor:t.BorderColorTop)+";"),(t.BorderStyleBottom!==undefined||t.BorderWidthBottom!==undefined||t.BorderColorBottom!==undefined)&&(r+="border-bottom:"+(t.BorderWidthBottom===undefined?t.BorderWidth:t.BorderWidthBottom)+" "+(t.BorderStyleBottom===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleBottom))+" "+(t.BorderColorBottom===undefined?t.BorderColor:t.BorderColorBottom)+";")),t=n.Elements.NonSharedElements.Style,t!==undefined&&(t.BorderStyle!==undefined&&(r+="border:"+t.BorderWidth+" "+i._getBorderStyle(t.BorderStyle)+" "+t.BorderColor+";"),(t.BorderStyleLeft!==undefined||t.BorderWidthLeft!==undefined||t.BorderColorLeft!==undefined)&&(r+="border-left:"+(t.BorderWidthLeft===undefined?t.BorderWidth:t.BorderWidthLeft)+" "+(t.BorderStyleLeft===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleLeft))+" "+(t.BorderColorLeft===undefined?t.BorderColor:t.BorderColorLeft)+";"),(t.BorderStyleRight!==undefined||t.BorderWidthRight!==undefined||t.BorderColorRight!==undefined)&&(r+="border-right:"+(t.BorderWidthRight===undefined?t.BorderWidth:t.BorderWidthRight)+" "+(t.BorderStyleRight===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleRight))+" "+(t.BorderColorRight===undefined?t.BorderColr:t.BorderColorRight)+";"),(t.BorderStyleTop!==undefined||t.BorderWidthTop!==undefined||t.BorderColorTop!==undefined)&&(r+="border-top:"+(t.BorderWidthTop===undefined?t.BorderWidth:t.BorderWidthTop)+" "+(t.BorderStyleTop===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleTop))+" "+(t.BorderColorTop===undefined?t.BorderColor:t.BorderColorTop)+";"),(t.BorderStyleBottom!==undefined||t.BorderWidthBottom!==undefined||t.BorderColorBottom!==undefined)&&(r+="border-bottom:"+(t.BorderWidthBottom===undefined?t.BorderWidth:t.BorderWidthBottom)+" "+(t.BorderStyleBottom===undefined?i._getBorderStyle(t.BorderStyle):i._getBorderStyle(t.BorderStyleBottom))+" "+(t.BorderColorBottom===undefined?t.BorderColor:t.BorderColorBottom)+";")),r):""},_getMeasurements:function(n,t){var r=this,i="";return n?(n.Width!==undefined&&(i+="width:"+n.Width+"mm;",i+="min-width:"+n.Width+"mm;",i+="max-width:"+n.Width+"mm;"),t&&n.Height!==undefined&&(i+="height:"+n.Height+"mm;",i+="min-height:"+n.Height+"mm;",i+="max-height:"+n.Height+"mm;"),i):""},_getStyle:function(n,t,i){var u=this,r="";return t?(r+=u._getNonTextStyle(n,t,i),r+u._getTextStyle(t,i)):r},_backgroundRepeatTypesMap:function(){return{0:"repeat",1:"no-repeat",2:"repeat-x",3:"repeat-y"}},_getImageStyleURL:function(n,t){var i=this;return"url("+i._getImageURL(n,t)+")"},_getNonTextStyle:function(n,t){var r=this,i="";return t?(t.BackgroundColor&&(i+="background-color:"+t.BackgroundColor+";"),t.BackgroundImage&&(i+="background-image:"+r._getImageStyleURL(n,t.BackgroundImage.ImageName)+";"),t.BackgroundRepeat!==undefined&&r._backgroundRepeatTypesMap()[t.BackgroundRepeat]&&(i+="background-repeat:"+r._backgroundRepeatTypesMap()[t.BackgroundRepeat]+";"),i):i},_getTextStyle:function(n,t){var r=this,i="";return n?(n.PaddingBottom!==undefined&&(i+="padding-bottom:"+n.PaddingBottom+";"),n.PaddingLeft!==undefined&&(i+="padding-left:"+n.PaddingLeft+";"),n.PaddingRight!==undefined&&(i+="padding-right:"+n.PaddingRight+";"),n.PaddingTop!==undefined&&(i+="padding-top:"+n.PaddingTop+";"),n.UnicodeBiDi!==undefined&&(i+="unicode-bidi:"+r._getBiDi(n.UnicodeBiDi)+";"),n.VerticalAlign!==undefined&&(i+="vertical-align:"+r._getVAligh(n.VerticalAlign)+";"),n.WritingMode!==undefined&&(i+="layout-flow:"+r._getLayoutFlow(n.WritingMode)+";"),n.Direction!==undefined&&(i+="Direction:"+r._getDirection(n.Direction)+";"),n.TextAlign!==undefined&&(i+="text-align:"+r._getTextAlign(n.TextAlign,t)+";"),n.FontStyle!==undefined&&(i+="font-style:"+r._getFontStyle(n.FontStyle)+";"),n.FontWeight!==undefined&&(i+="font-weight:"+r._getFontWeight(n.FontWeight)+";"),n.FontFamily!==undefined&&(i+="font-family:"+n.FontFamily+";"),n.FontSize!==undefined&&(i+="font-size:"+n.FontSize+";"),n.TextDecoration!==undefined&&(i+="text-decoration:"+r._getTextDecoration(n.TextDecoration)+";"),n.Color!==undefined&&(i+="color:"+n.Color+";"),i):i},_getCalendar:function(n){switch(n){case 0:return"Gregorian";case 1:return"GregorianArabic";case 2:return"GregorianMiddleEastFrench";case 3:return"GregorianTransliteratedEnglish";case 4:return"GregorianTransliteratedFrench";case 5:return"GregorianUSEnglish";case 6:return"Hebrew";case 7:return"Hijri";case 9:return"Korean";case 10:return"Julian";case 11:return"Taiwan";case 12:return"ThaiBuddist"}return"Gregorian"},_getTextDecoration:function(n){switch(n){case 0:return"None";case 1:return"Underline";case 2:return"Overline";case 3:return"LineThrough"}return"None"},_getFontWeight:function(n){switch(n){case 0:return"Normal";case 1:return"Thin";case 2:return"ExtraLight";case 3:return"Light";case 4:return"Medium";case 5:return"SemiBold";case 6:return"Bold";case 7:return"ExtraBold";case 8:return"Heavy"}return"General"},_getFontStyle:function(n){switch(n){case 0:return"Normal";case 1:return"Italic"}return"Normal"},_getTextAlign:function(n,t){switch(n){case 0:if(t.TypeCode===undefined)return"Left";switch(t.TypeCode){case 3:case 6:case 7:case 9:case 11:case 12:case 13:case 14:case 15:case 16:return"Right";case 4:case 17:case 18:return"Left";default:return"Left"}break;case 1:return"Left";case 2:return"Center";case 3:return"Right"}},_getDirection:function(n){switch(n){case 0:return"LTR";case 1:return"RTL"}return"LTR"},_getLayoutFlow:function(n){switch(n){case 0:return"Horizontal";case 1:return"Vertical";case 2:return"Rotate270"}return"Horizontal"},_getVAligh:function(n){switch(n){case 0:return"Top";case 1:return"Middle";case 2:return"Bottom"}return"Top"},_getBiDi:function(n){switch(n){case 0:return"normal";case 1:return"embed";case 2:return"BiDiOverride"}return"normal"},_getDefaultHTMLTable:function(){var n=$("<Table/>");return n.attr("CELLSPACING",0),n.attr("CELLPADDING",0),n},_getBorderStyle:function(n){switch(n){case 0:return"None";case 1:return"Dotted";case 2:return"Dashed";case 3:return"Solid";case 4:return"Double"}return"None"},_getMeasurmentsObj:function(n,t){var i=null;return n.Measurement&&(i=n.Measurement.Measurements[t]),i},_convertToMM:function(n){if(!n)return 0;var i=n.match(/\D+$/),t=n.match(/\d+/);i.length===1&&(i=i[0]),t.length===1&&(t=t[0]);switch(i){case"px":return t/3.78;case"pt":return t*.352777777778;case"in":return t*25.4;case"mm":return t;case"cm":return t*10;case"em":return t*4.2175176}return t},_getListStyle:function(n,t){var i;if(n===1)switch(t%3){case 1:i="decimal";break;case 2:i="lower-roman";break;case 0:i="lower-latin"}else if(n===2)switch(t%3){case 0:i="square";break;case 1:i="disc";break;case 2:i="circle"}return i},_stopDefaultEvent:function(n){window.ActiveXObject?window.event.returnValue=!1:(n.preventDefault(),n.stopPropagation())},_getNatural:function(n){if(n.naturalWidth!==undefined&&n.naturalHeight!==undefined)return{width:n.naturalWidth,height:n.naturalHeight};var t=new Image;return t.src=n.src,{width:t.width,height:t.height}},isNull:function(n){return n===null||n===undefined?!0:!1}})});
//@ sourceMappingURL=ReportRender.min.js.map